<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<org.eventb.core.machineFile org.eventb.core.configuration="org.eventb.core.fwd" org.eventb.texttools.text_lastmodified="1443620143239" org.eventb.texttools.text_representation="machine M0 sees C0&#10;&#10;variables&#10;  CurrUnion&#10;  UserAccs&#10;  Sessions&#10;  Entities&#10;  Objects&#10;  Containers&#10;  Roles&#10;  OrdRoles&#10;  AdmRoles&#10;  EntityNames&#10;  Parent&#10;  SParent&#10;  RParents&#10;  SessionUser&#10;  RoleRights&#10;  RoleAdmRights&#10;  SessionAccesses&#10;  SessionAdmAccesses&#10;  Shared&#10;  RoleName&#10;  SessionOwner&#10;  Direct&#10;  EntityMP&#10;  UserRoles&#10;  UserOrdRole&#10;  UserAdmRole&#10;&#10;invariants&#10;  @CurrUnionType CurrUnion⊆Union&#10;  @CurrUnionPartition partition(CurrUnion, UserAccs, Sessions, Entities, Roles)&#10;  @EntitiesPartition partition(Entities, Objects, Containers)&#10;  @RolesPartition partition(Roles, AdmRoles, OrdRoles)&#10;  @SpecialAdmRolesAreCurrent SpecialAdmRoles⊆AdmRoles&#10;&#10;  @SessionUserType SessionUser∈Sessions→UserAccs&#10;  @SessionAccessesType SessionAccesses∈Sessions→(Entities↔Accesses)&#10;  @SessionAdmAccessesType SessionAdmAccesses∈Sessions→(Roles↔Accesses)&#10;  @SessionOwnerType SessionOwner∈Sessions⇸Roles&#10;&#10;  @EntityNamesType EntityNames∈Entities∖{Root}→(Containers↔Names)&#10;  @ParentType Parent∈Containers∖{Root}→Containers&#10;  @RootType Root∈Containers&#10;  @EntityNamesAreCorrect1 ∀e·e∈dom(EntityNames) ⇒ EntityNames(e)≠∅&#10;  @EntityNamesAreCorrect2 ∀c·c∈Containers ∧ c≠Root ⇒ (∃p,n·p∈Containers ∧ n∈Names ∧ EntityNames(c)={p↦n})&#10;  @EntityNamesAreCorrect3 ∀e1,e2·e1∈dom(EntityNames) ∧ e2∈dom(EntityNames) ∧ e1≠e2 ⇒ EntityNames(e1)∩EntityNames(e2)=∅&#10;  @EntityNamesAreCorrect4 ∀c1,c2·c1∈Containers ∧ c1≠Root ∧ c2∈dom(EntityNames(c1)) ⇒ c2=Parent(c1)&#10;  @EntityNamesAreCorrect5 ∀c1,c2·c1∈Containers ∧ c1≠Root ∧ c2=Parent(c1) ⇒ c2∈dom(EntityNames(c1))&#10;  @NoCycles ∀C·C⊆Containers ∧ C≠∅ ∧ Root∉C ⇒ C∖Parent[C]≠∅&#10;&#10;  @RParentsType RParents∈Roles→ℙ(Roles)&#10;  @RParentsAreCorrect1 ∀r,ar·r∈OrdRoles ∧ ar∈AdmRoles ⇒ ar∉RParents(r)&#10;  @RParentsAreCorrect2 ∀r,ar·r∈OrdRoles ∧ ar∈AdmRoles ⇒ r∉RParents(ar)&#10;  @NoCyclesForRoles ∀R·R⊆Roles ⇒ (∃r·r∈R ∧ (∀p·p∈R ⇒ p∉RParents(r)))&#10;  @RoleNameType RoleName∈Roles→Names&#10;  @RoleNameIsUnique ∀r1,r2·r1∈Roles ∧ r2∈Roles ∧ r1≠r2 ⇒ RoleName(r1)≠RoleName(r2)&#10;&#10;  @SParentType SParent∈Sessions⇸Sessions&#10;  @NoCyclesForSessions ∀S·S⊆dom(SParent) ∧ S≠∅ ⇒ S∖SParent[S]≠∅&#10;&#10;  @SharedType Shared∈Containers∪Roles→BOOL&#10;  @SharedIsCorrect ∀r·r∈Roles ⇒ Shared(r)=TRUE&#10;&#10;  @RoleRightsType RoleRights∈Roles→(Entities↔AccessRights)&#10;  @RoleAdmRightsType RoleAdmRights∈AdmRoles→(Roles↔AccessRights)&#10;  @ExecuteAdmRightIsCorrect ∀ar,r·ar∈AdmRoles ∧ r∈Roles ⇒ r↦Execute∈RoleAdmRights(ar)&#10;  @RoleOwnersAreCorrect1 ∀r·r∈OrdRoles ⇒ r↦Own∈RoleAdmRights(RolesAR)&#10;  @RoleOwnersAreCorrect2 ∀r·r∈AdmRoles ⇒ r↦Own∈RoleAdmRights(ARolesAR)&#10;  @RoleOwnersAreCorrect3 ∀r,ar·r∈OrdRoles ∧ ar∈AdmRoles ∧ r↦Own∈RoleAdmRights(ar) ⇒ ar=RolesAR&#10;  @RoleOwnersAreCorrect4 ∀r,ar·r∈AdmRoles ∧ ar∈AdmRoles ∧ r↦Own∈RoleAdmRights(ar) ⇒ ar=ARolesAR&#10;  @EntityOwnersAreCorrect ∀r1,r2,e·r1∈Roles ∧ r2∈Roles ∧ e↦Own∈RoleRights(r1) ∧ e↦Own∈RoleRights(r2) ⇒ r1=r2&#10;  @ReadAccessRightSpreadsThroughParent ∀ar,r,p·ar∈AdmRoles ∧ r∈Roles ∧ p∈Roles ∧ p∈RParents(r) ∧ p↦Read∈RoleAdmRights(ar) ⇒ r↦Read∈RoleAdmRights(ar)&#10;&#10;  @DirectType Direct∈Entities→BOOL&#10;  @EntityMPType EntityMP∈Entities→Containers&#10;  @DirectIsCorrect1 ∀e·e∈Entities ∧ Direct(e)=TRUE ⇒ EntityMP(e)=Root&#10;  @DirectIsCorrect2 ∀e·e∈Entities ∧ Direct(e)=FALSE ⇒ Direct(EntityMP(e))=TRUE&#10;  @DirectIsCorrect3 ∀c·c∈Containers ∧ Direct(c)=FALSE ⇒ c∉ran(EntityMP)&#10;  @DirectIsCorrect4 ∀e,p·e∈dom(EntityNames) ∧ p∈dom(EntityNames(e)) ∧ Direct(p)=FALSE ⇒ Direct(e)=FALSE&#10;  @DirectIsCorrect5 ∀e,mp·e∈dom(EntityNames) ∧ mp∈dom(EntityNames(e)) ∧ Direct(mp)=TRUE ∧ Direct(e)=FALSE&#10;            ⇒ (∀child·child∈dom(EntityNames) ∧ mp∈dom(EntityNames(child)) ⇒ Direct(child)=FALSE)&#10;  @DirectIsCorrect6 ∀e,p·e∈dom(EntityNames) ∧ p∈dom(EntityNames(e)) ∧ Direct(e)=FALSE&#10;            ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{p}=E∪{Root} ∧ EntityMP(e)∈E∪{Root})&#10;  @DirectIsCorrect7 Direct(Root)=TRUE&#10;  @DirectIsCorrect8 ∀e,a,r·e∈Entities ∧ Direct(e)=FALSE ∧ r∈Roles ∧ a∈AccessRights ∧ e↦a∈RoleRights(r)&#10;            ⇒ EntityMP(e)↦a∈RoleRights(r)&#10;  @DirectIsCorrect9 ∀e,a,r·e∈Entities ∧ Direct(e)=FALSE ∧ r∈Roles ∧ a∈AccessRights ∧ EntityMP(e)↦a∈RoleRights(r)&#10;              ⇒ e↦a∈RoleRights(r)&#10;  @DirectIsCorrect10 ∀e,p·e∈dom(EntityNames) ∧ p∈dom(EntityNames(e)) ∧ Direct(e)=FALSE ∧ Direct(p)=FALSE ⇒ EntityMP(e)=EntityMP(p)&#10;  @DirectIsCorrect11 ∀e,p·e∈dom(EntityNames) ∧ p∈dom(EntityNames(e)) ∧ Direct(e)=FALSE ∧ Direct(p)=TRUE ⇒ EntityMP(e)=p&#10;&#10;  @UserRolesType UserRoles∈UserAccs→ℙ(Roles)&#10;  @UserOrdRoleType UserOrdRole∈UserAccs→OrdRoles&#10;  @UserOrdRoleIsUserRole ∀u·u∈UserAccs ⇒ UserOrdRole(u)∈UserRoles(u)&#10;  @UserAdmRoleType UserAdmRole∈UserAccs→AdmRoles&#10;  @UserAdmRoleIsUserRole ∀u·u∈UserAccs ⇒ UserAdmRole(u)∈UserRoles(u)&#10;  @UserRolesAreUnique ∀u1,u2,r1,r2·u1∈UserAccs ∧ u2∈UserAccs ∧ u1≠u2 ∧ r1∈UserRoles(u1) ∧ r2∈UserRoles(u2) ⇒ r1≠r2&#10;  @UserRolesParentsAreCorrect1 ∀u,r,ur·u∈UserAccs ∧ r∈Roles ∧ r∉UserRoles(u) ∧ ur∈UserRoles(u) ⇒ r∉RParents(ur)&#10;  @UserRolesParentsAreCorrect2 ∀u,r,ur·u∈UserAccs ∧ r∈Roles ∧ r∉UserRoles(u) ∧ ur∈UserRoles(u) ⇒ ur∉RParents(r)&#10;  @SpecialAdmRolesAreNotUserRoles ∀u,r1,r2·u∈UserAccs ∧ r1∈UserRoles(u) ∧ r2∈SpecialAdmRoles ⇒ r1≠r2&#10;  @ReadAccessRightIsCorrectForUserOrdRole ∀u·u∈UserAccs ⇒ UserOrdRole(u)↦Read∈RoleAdmRights(UserAdmRole(u))&#10;  @WriteAccessRightIsCorrectForUserOrdRole ∀u·u∈UserAccs ⇒ UserOrdRole(u)↦Write∈RoleAdmRights(UserAdmRole(u))&#10;&#10;  @CommonRoles_type CommonRoles⊆OrdRoles&#10;  @CommonRolesParentsAreCorrect1 ∀r,cr·r∈Roles ∧ r∉CommonRoles ∧ cr∈CommonRoles ⇒ r∉RParents(cr)&#10;  @CommonRolesParentsAreCorrect2 ∀r,cr·r∈Roles ∧ r∉CommonRoles ∧ cr∈CommonRoles ⇒ cr∉RParents(r)&#10;  @CommonRolesAreNotUserRoles ∀u,r·u∈UserAccs ∧ r∈UserRoles(u) ⇒ r∉CommonRoles&#10;  @ReadAccessRightIsCorrectForCommonRole ∀u·u∈UserAccs ⇒ CommonRole↦Read∈RoleAdmRights(UserAdmRole(u))&#10;  @WriteAccessRightIsCorrectForCommonRole ∀u·u∈UserAccs ⇒ CommonRole↦Write∈RoleAdmRights(UserAdmRole(u))&#10;&#10;events&#10;  event INITIALISATION&#10;  &#9;then&#10;  &#9;&#9;@act1 CurrUnion≔∅&#10;  &#9;&#9;@act2 UserAccs≔∅&#10;  &#9;&#9;@act3 Sessions≔∅&#10;  &#9;&#9;@act4 Entities≔∅&#10;  &#9;&#9;@act5 Objects≔∅&#10;  &#9;&#9;@act6 Containers≔∅&#10;  &#9;&#9;@act7 Roles≔∅&#10;  &#9;&#9;@act8 OrdRoles≔∅&#10;  &#9;&#9;@act9 AdmRoles≔∅&#10;  &#9;&#9;@act10 EntityNames≔∅&#10;  &#9;&#9;@act11 Parent≔∅&#10;  &#9;&#9;@act12 SParent≔∅&#10;  &#9;&#9;@act13 SessionUser≔∅&#10;  &#9;&#9;@act14 RoleRights≔∅&#10;  &#9;&#9;@act15 RoleAdmRights≔∅&#10;  &#9;&#9;@act16 SessionAccesses≔∅&#10;  &#9;&#9;@act17 SessionAdmAccesses≔∅&#10;  &#9;&#9;@act18 Shared≔∅&#10;  &#9;&#9;@act19 RoleName≔∅&#10;  &#9;&#9;@act20 RParents≔∅&#10;  &#9;&#9;@act21 SessionOwner≔∅&#10;  &#9;&#9;@act22 Direct≔∅&#10;  &#9;&#9;@act23 EntityMP≔∅&#10;  &#9;&#9;@act24 UserRoles≔∅&#10;  &#9;&#9;@act25 UserOrdRole≔∅&#10;  &#9;&#9;@act26 UserAdmRole≔∅&#10;  end&#10;&#10;  event create_user&#10;    any user session roles admRoles ordRoles userOrdRole userAdmRole rParents roleName roleRights roleAdmRights&#10;  &#9;when&#10;  &#9;&#9;@grd1 user∈Union∖CurrUnion&#10;  &#9;&#9;@grd2 session∈Sessions&#10;  &#9;&#9;@grd3 UsersAR↦ReadA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd4 RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd5 RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd6 ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd7 ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd8 roles⊆Union∖CurrUnion&#10;  &#9;&#9;@grd9 user∉roles&#10;  &#9;&#9;@grd10 partition(roles, admRoles, ordRoles)&#10;  &#9;&#9;@grd11 rParents∈roles→ℙ(roles)&#10;  &#9;&#9;@grd12 ∀R·R⊆roles ⇒ (∃r·r∈R ∧ (∀p·p∈R ⇒ p∉rParents(r)))&#10;  &#9;&#9;@grd13 ∀r,ar·r∈ordRoles ∧ ar∈admRoles ⇒ ar∉rParents(r)&#10;  &#9;&#9;@grd14 ∀r,ar·r∈ordRoles ∧ ar∈admRoles ⇒ r∉rParents(ar)&#10;  &#9;&#9;@grd15 roleName∈roles→Names&#10;  &#9;&#9;@grd16 ∀r1,r2·r1∈roles ∧ r2∈roles ∧ r1≠r2 ⇒ roleName(r1)≠roleName(r2)&#10;  &#9;&#9;@grd17 ran(roleName)∩ran(RoleName)=∅&#10;  &#9;&#9;@grd18 roleRights∈roles→(Entities↔AccessRights)&#10;  &#9;&#9;@grd19 ∀r·r∈roles ⇒ roleRights(r)=∅&#10;  &#9;&#9;@grd20 roleAdmRights∈AdmRoles∪admRoles→(Roles∪roles↔AccessRights)&#10;  &#9;&#9;@grd21 ∀r1,ar,r2·r1∈Roles ∧ r2∈AdmRoles ∧ ar∈AccessRights ∧ r1↦ar∈RoleAdmRights(r2) ⇒ r1↦ar∈roleAdmRights(r2)&#10;  &#9;&#9;@grd22 ∀r1,ar,r2·r1∈Roles ∧ r2∈AdmRoles ∧ ar∈AccessRights ∧ r1↦ar∈roleAdmRights(r2) ⇒ r1↦ar∈RoleAdmRights(r2)&#10;  &#9;&#9;@grd23 ∀r·r∈admRoles ⇒ r↦Own∈roleAdmRights(ARolesAR)&#10;  &#9;&#9;@grd24 ∀r·r∈admRoles ⇒ r↦Own∉roleAdmRights(RolesAR)&#10;  &#9;&#9;@grd25 ∀r·r∈ordRoles ⇒ r↦Own∉roleAdmRights(ARolesAR)&#10;  &#9;&#9;@grd26 ∀r·r∈ordRoles ⇒ r↦Own∈roleAdmRights(RolesAR)&#10;  &#9;&#9;@grd27 ∀ar,r·ar∈AdmRoles∪admRoles ∧ ar≠RolesAR ∧ ar≠ARolesAR ∧ r∈roles ⇒ r↦Own∉roleAdmRights(ar)&#10;  &#9;&#9;@grd28 ∀ar,r·ar∈admRoles ∧ r∈Roles ⇒ r↦Own∉roleAdmRights(ar)&#10;  &#9;&#9;@grd29 ∀r,ar·r∈roles ∧ ar∈AdmRoles∪admRoles⇒ r↦Execute∈roleAdmRights(ar)&#10;  &#9;&#9;@grd30 ∀r,ar·r∈Roles∪roles ∧ ar∈admRoles⇒ r↦Execute∈roleAdmRights(ar)&#10;  &#9;&#9;@grd31 userOrdRole∈ordRoles&#10;  &#9;&#9;@grd32 userAdmRole∈admRoles&#10;  &#9;&#9;@grd33 userOrdRole↦Read∈roleAdmRights(userAdmRole)&#10;  &#9;&#9;@grd34 userOrdRole↦Write∈roleAdmRights(userAdmRole)&#10;  &#9;&#9;@grd35 userAdmRole↦Read∈roleAdmRights(userAdmRole)&#10;  &#9;&#9;@grd36 userAdmRole↦Write∈roleAdmRights(userAdmRole)&#10;  &#9;&#9;@grd37 CommonRole↦Read∈roleAdmRights(userAdmRole)&#10;  &#9;&#9;@grd38 CommonRole↦Write∈roleAdmRights(userAdmRole)&#10;  &#9;&#9;@grd39 ∀r,ar·r∈Roles ∧ r∉CommonRoles ∧ ar∈admRoles ⇒ r↦Read∉roleAdmRights(ar)&#10;  &#9;&#9;@grd40 ∀r,ar·r∈Roles ∧ r∉CommonRoles ∧ ar∈admRoles ⇒ r↦Write∉roleAdmRights(ar)&#10;        @grd41 ∀r,ar·r∈roles ∧ ar∈AdmRoles ⇒ r↦Read∉roleAdmRights(ar)&#10;        @grd42 ∀r,ar·r∈roles ∧ ar∈AdmRoles ⇒ r↦Write∉roleAdmRights(ar)&#10;  &#9;&#9;@grd43 ∀ar,r,p·ar∈admRoles ∧ r∈roles ∧ p∈roles ∧ p∈rParents(r) ∧ p↦Read∈roleAdmRights(ar) ⇒ r↦Read∈roleAdmRights(ar)&#10;        @grd44 ∀ar,r,p·ar∈admRoles ∧ p∈CommonRoles ∧ r∈CommonRoles ∧ p∈RParents(r) ∧ p↦Read∈roleAdmRights(ar) ⇒ r↦Read∈roleAdmRights(ar)&#10;  &#9;then&#10;  &#9;&#9;@act1 CurrUnion ≔ CurrUnion ∪ {user} ∪ roles&#10;  &#9;&#9;@act2 UserAccs ≔ UserAccs ∪ {user}&#10;  &#9;&#9;@act3 UserOrdRole(user) ≔ userOrdRole&#10;  &#9;&#9;@act4 UserAdmRole(user) ≔ userAdmRole&#10;  &#9;&#9;@act5 UserRoles(user) ≔ roles&#10;  &#9;&#9;@act6 Roles ≔ Roles ∪ roles&#10;  &#9;&#9;@act7 OrdRoles ≔ OrdRoles ∪ ordRoles&#10;  &#9;&#9;@act8 AdmRoles ≔ AdmRoles ∪ admRoles&#10;  &#9;&#9;@act9 RParents ≔ RParents ∪ rParents&#10;  &#9;&#9;@act10 RoleAdmRights ≔ roleAdmRights&#10;  &#9;&#9;@act11 RoleRights ≔ RoleRights ∪ roleRights&#10;  &#9;&#9;@act12 RoleName ≔ RoleName ∪ roleName&#10;  &#9;&#9;@act13 Shared ≔ {x↦y∣ x↦y∈Shared ∨ (x∈roles ∧ y=TRUE)}&#10;  end&#10;&#10;  event set_user_labels&#10;    any user session roles admRoles ordRoles delRoles rParents roleAdmRights roleName roleRights sessionAdmAccesses&#10;    where&#10;        @grd1 user∈UserAccs&#10;        @grd2 session∈Sessions&#10;        @grd3 ∀s·s∈Sessions ⇒ SessionUser(s)≠user&#10;        @grd4 UsersAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd5 RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd6 RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd7 ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd8 ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd9 roles⊆Union∖CurrUnion&#10;        @grd10 partition(roles, admRoles, ordRoles)&#10;        @grd11 delRoles⊆UserRoles(user)&#10;        @grd12 rParents∈(Roles∖delRoles)∪roles→ℙ((Roles∖delRoles)∪roles)&#10;        @grd13 ∀r1,r2·r1∈Roles ∧ r2∈Roles ∧ r1∉delRoles ∧ r2∉delRoles ⇒ (r1∈RParents(r2) ⇔ r1∈rParents(r2))&#10;        @grd14 ∀p,r·p∈Roles ∧ p∉delRoles ∧ r∈roles ⇒ p∉rParents(r)&#10;        @grd15 ∀p,r·p∈Roles ∧ p∉UserRoles(user) ∧ r∈roles ⇒ r∉rParents(p)&#10;        @grd16 ∀r,ar·r∈(UserRoles(user)∩OrdRoles)∪ordRoles ∧ r∉delRoles&#10;        &#9;&#9;&#9;∧ ar∈(UserRoles(user)∩AdmRoles)∪admRoles ∧ ar∉delRoles&#10;        &#9;&#9;&#9;∧ (r∈ordRoles ∨ ar∈admRoles)&#10;        &#9;&#9;&#9;&#9;⇒ ar∉rParents(r)&#10;  &#9;&#9;@grd17 ∀r,ar·r∈(UserRoles(user)∩OrdRoles)∪ordRoles ∧ r∉delRoles&#10;        &#9;&#9;&#9;∧ ar∈(UserRoles(user)∩AdmRoles)∪admRoles ∧ ar∉delRoles&#10;        &#9;&#9;&#9;∧ (r∈ordRoles ∨ ar∈admRoles)&#10;        &#9;&#9;&#9;&#9;⇒ r∉rParents(ar)&#10;        @grd18 ∀R·R⊆roles ⇒ (∃r·r∈R ∧ (∀p·p∈R ⇒ p∉rParents(r)))&#10;        @grd19 roleAdmRights∈(AdmRoles∖delRoles)∪admRoles→((Roles∖delRoles)∪roles↔AccessRights)&#10;        @grd20 ∀r1,ar,r2·r1∈Roles ∧ r2∈AdmRoles ∧ r1∉delRoles ∧ r2∉delRoles ∧ ar∈AccessRights&#10;                   ∧ (r1∉CommonRoles ∨ r2∉UserRoles(user))&#10;                       ⇒ (r1↦ar∈RoleAdmRights(r2) ⇔ r1↦ar∈roleAdmRights(r2))&#10;        @grd21 ∀r1,r2,ar·r1∈CommonRoles ∧ r2∈AdmRoles ∧ r2∈UserRoles(user) ∧ r2∉delRoles&#10;                   ∧ ar∈AccessRights ∧ r1↦ar∈RoleAdmRights(r2)&#10;                       ⇒ r1↦ar∈roleAdmRights(r2)&#10;        @grd22 ∀ar·ar∈admRoles ⇒ ar↦Own∈roleAdmRights(ARolesAR)&#10;        @grd23 ∀ar·ar∈admRoles ⇒ ar↦Own∉roleAdmRights(RolesAR)&#10;        @grd24 ∀r·r∈ordRoles ⇒ r↦Own∉roleAdmRights(ARolesAR)&#10;        @grd25 ∀r·r∈ordRoles ⇒ r↦Own∈roleAdmRights(RolesAR)&#10;        @grd26 ∀r,ar·r∈roles ∧ ar∈AdmRoles ∧ ar∉delRoles ∧ ar≠RolesAR ∧ ar≠ARolesAR ⇒ r↦Own∉roleAdmRights(ar)&#10;        @grd27 ∀r,ar·r∈Roles∪roles ∧ ar∈admRoles ⇒ r↦Own∉roleAdmRights(ar)&#10;        @grd28 ∀r,ar·r∈CommonRoles ∧ ar∈AdmRoles ∧ ar∉delRoles ∧ r↦Own∈roleAdmRights(ar) ⇒ r↦Own∈RoleAdmRights(ar)&#10;        @grd29 ∀r,ar·r∈roles ∧ ar∈AdmRoles ∧ ar∉delRoles ⇒ r↦Execute∈roleAdmRights(ar)&#10;        @grd30 ∀r,ar·r∈Roles∪roles ∧ r∉delRoles ∧ ar∈admRoles  ⇒ r↦Execute∈roleAdmRights(ar)&#10;        @grd31 ∀ar,r,p·ar∈admRoles&#10;                    ∧ p∈CommonRoles ∧ r∈CommonRoles&#10;                    ∧ p∈rParents(r) ∧ p↦Read∈roleAdmRights(ar)&#10;                        ⇒ r↦Read∈roleAdmRights(ar)&#10;        @grd32 ∀ar,r,p·ar∈admRoles&#10;                    ∧ p∈UserRoles(user)∪roles ∧ p∉delRoles&#10;                    ∧ r∈UserRoles(user)∪roles ∧ r∉delRoles&#10;                    ∧ p∈rParents(r) ∧ p↦Read∈roleAdmRights(ar)&#10;                        ⇒ r↦Read∈roleAdmRights(ar)&#10;        @grd33 ∀ar,r,p·ar∈AdmRoles ∧ ar∈UserRoles(user) ∧ ar∉delRoles&#10;                    ∧ p∈CommonRoles ∧ r∈CommonRoles&#10;                    ∧ p∈rParents(r) ∧ p↦Read∈roleAdmRights(ar)&#10;                    ∧ p↦Read∉RoleAdmRights(ar)&#10;                        ⇒ r↦Read∈roleAdmRights(ar)&#10;        @grd34 ∀ar,r,p·ar∈AdmRoles ∧ ar∈UserRoles(user) ∧ ar∉delRoles&#10;                    ∧ p∈roles&#10;                    ∧ r∈UserRoles(user)∪roles ∧ r∉delRoles&#10;                    ∧ p∈rParents(r) ∧ p↦Read∈roleAdmRights(ar)&#10;                        ⇒ r↦Read∈roleAdmRights(ar)&#10;        @grd35 ∀r,ar·r∈roles ∧ ar∈AdmRoles ∧ ar∉UserRoles(user) ⇒ r↦Read∉roleAdmRights(ar)&#10;        @grd36 ∀r,ar·r∈roles ∧ ar∈AdmRoles ∧ ar∉UserRoles(user) ⇒ r↦Write∉roleAdmRights(ar)&#10;        @grd37 ∀r,ar·r∈Roles ∧ r∉UserRoles(user) ∧ r∉CommonRoles ∧ ar∈admRoles ⇒ r↦Read∉roleAdmRights(ar)&#10;        @grd38 ∀r,ar·r∈Roles ∧ r∉UserRoles(user) ∧ r∉CommonRoles ∧ ar∈admRoles ⇒ r↦Write∉roleAdmRights(ar)&#10;        @grd39 roleName∈roles→Names&#10;        @grd40 ∀r1,r2·r1∈roles ∧ r2∈roles ∧ r1≠r2 ⇒ roleName(r1)≠roleName(r2)&#10;        @grd41 ∀r1,r2·r1∈roles ∧ r2∈Roles ∧ r1≠r2 ⇒ roleName(r1)≠RoleName(r2)&#10;        @grd42 roleRights∈(Roles∖delRoles)∪roles→(Entities↔AccessRights)&#10;        @grd43 ∀r,e,ar·r∈Roles ∧ r∉delRoles ∧ e↦ar∈RoleRights(r) ⇒ e↦ar∈roleRights(r)&#10;        @grd44 ∀r,e,ar·r∈Roles ∧ r∉delRoles ∧ e↦ar∈roleRights(r) ⇒ e↦ar∈RoleRights(r)&#10;        @grd45 ∀r·r∈roles ⇒ roleRights(r)=∅&#10;        @grd46 sessionAdmAccesses∈Sessions→(Roles∖delRoles↔Accesses)&#10;        @grd47 ∀s·s∈Sessions ⇒ delRoles ⩤ SessionAdmAccesses(s)=sessionAdmAccesses(s)&#10;        @grd48 UserOrdRole(user)∉delRoles&#10;        @grd49 UserAdmRole(user)∉delRoles&#10;    then&#10;    &#9;@act1 CurrUnion ≔ (CurrUnion ∖ delRoles) ∪ roles&#10;        @act2 UserRoles(user) ≔ (UserRoles(user) ∖ delRoles) ∪ roles&#10;        @act3 Roles ≔ (Roles ∖ delRoles) ∪ roles&#10;        @act4 OrdRoles ≔ (OrdRoles ∖ delRoles) ∪ ordRoles&#10;        @act5 AdmRoles ≔ (AdmRoles ∖ delRoles) ∪ admRoles&#10;        @act6 RParents ≔ rParents&#10;        @act7 RoleAdmRights ≔ roleAdmRights&#10;        @act8 RoleRights ≔ roleRights&#10;        @act9 RoleName ≔ (delRoles ⩤ RoleName) ∪ roleName&#10;        @act10 SessionOwner ≔ SessionOwner ⩥ delRoles&#10;        @act11 SessionAdmAccesses ≔ sessionAdmAccesses&#10;        @act12 Shared ≔ {x↦y∣ (x↦y∈Shared ∧ x∉delRoles) ∨ (x∈roles ∧ y=TRUE)}&#10;    end&#10;&#10;  event delete_user&#10;  &#9;any user session rParents roleAdmRights sessionAdmAccesses&#10;  &#9;when&#10;  &#9;&#9;@grd1 user∈UserAccs&#10;  &#9;&#9;@grd2 session∈Sessions&#10;  &#9;&#9;@grd3 ∀s·s∈Sessions ⇒ SessionUser(s)≠user&#10;  &#9;&#9;@grd4 UsersAR↦ReadA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd5 RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd6 RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd7 ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd8 ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;  &#9;&#9;@grd9 rParents∈Roles∖UserRoles(user)→ℙ(Roles∖UserRoles(user))&#10;  &#9;&#9;@grd10 ∀r·r∈Roles ∧ r∉UserRoles(user) ⇒ RParents(r)∖UserRoles(user)=rParents(r)&#10;  &#9;&#9;@grd11 roleAdmRights∈AdmRoles∖UserRoles(user)→(Roles∖UserRoles(user)↔AccessRights)&#10;  &#9;&#9;@grd12 ∀ar·ar∈AdmRoles ∧ ar∉UserRoles(user) ⇒ UserRoles(user) ⩤ RoleAdmRights(ar)=roleAdmRights(ar)&#10;  &#9;&#9;@grd13 sessionAdmAccesses∈Sessions→(Roles∖UserRoles(user)↔Accesses)&#10;  &#9;&#9;@grd14 ∀s·s∈Sessions ⇒ UserRoles(user) ⩤ SessionAdmAccesses(s)=sessionAdmAccesses(s)&#10;  &#9;then&#10;  &#9;&#9;@act1 CurrUnion ≔ (CurrUnion ∖ UserRoles(user)) ∖ {user}&#10;  &#9;&#9;@act2 UserAccs ≔ UserAccs ∖ {user}&#10;  &#9;&#9;@act3 UserRoles ≔ {user} ⩤ UserRoles&#10;  &#9;&#9;@act4 UserAdmRole ≔ {user} ⩤ UserAdmRole&#10;  &#9;&#9;@act5 UserOrdRole ≔ {user} ⩤ UserOrdRole&#10;  &#9;&#9;@act6 Roles ≔ Roles ∖ UserRoles(user)&#10;  &#9;&#9;@act7 OrdRoles ≔ OrdRoles ∖ UserRoles(user)&#10;  &#9;&#9;@act8 AdmRoles ≔ AdmRoles ∖ UserRoles(user)&#10;  &#9;&#9;@act9 RParents ≔ rParents&#10;  &#9;&#9;@act10 RoleAdmRights ≔ roleAdmRights&#10;  &#9;&#9;@act12 RoleRights ≔ UserRoles(user) ⩤ RoleRights&#10;  &#9;&#9;@act13 RoleName ≔ UserRoles(user) ⩤ RoleName&#10;  &#9;&#9;@act14 SessionOwner ≔ SessionOwner ⩥ UserRoles(user)&#10;  &#9;&#9;@act15 SessionAdmAccesses ≔ sessionAdmAccesses&#10;  &#9;&#9;@act16 Shared ≔ UserRoles(user) ⩤ Shared&#10;  end&#10;&#10;  event create_object&#10;    any session object parent name role dLabel mountPoint roleRights depth&#10;    where&#10;        @grd1 object∈Union∖CurrUnion&#10;        @grd2 session∈Sessions&#10;        @grd3 parent∈Containers&#10;        @grd4 parent↦WriteA∈SessionAccesses(session)&#10;        @grd5 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ parent↦Execute∈RoleRights(r)&#10;        @grd6 name∈Names&#10;        @grd7 ∀e·e∈dom(EntityNames) ⇒ parent↦name∉EntityNames(e)&#10;        @grd8 role∈OrdRoles&#10;        @grd9 role∈UserRoles(SessionUser(session))&#10;        @grd10 role↦WriteA∈SessionAdmAccesses(session)&#10;        @grd11 mountPoint∈Containers&#10;        @grd12 dLabel∈BOOL&#10;        @grd13 ∀e·e∈dom(EntityNames) ∧ parent∈dom(EntityNames(e)) ⇒ Direct(e)=dLabel&#10;        @grd14 dLabel=TRUE ⇒ Direct(parent)=TRUE&#10;        @grd15 dLabel=TRUE ⇒ mountPoint=Root&#10;        @grd16 dLabel=FALSE ∧ Direct(parent)=FALSE ⇒ mountPoint=EntityMP(parent)&#10;        @grd17 dLabel=FALSE ∧ Direct(parent)=TRUE ⇒ mountPoint=parent&#10;        @grd18 roleRights∈Roles→(Entities∪{object}↔AccessRights)&#10;        @grd19 ∀e,a,r·e∈Entities ∧ a∈AccessRights ∧ r∈Roles ⇒ (e↦a∈roleRights(r) ⇔ e↦a∈RoleRights(r))&#10;        @grd20 dLabel=TRUE ⇒ object↦Own∈roleRights(role)&#10;        @grd21 dLabel=TRUE ⇒ (∀a,r·a∈AccessRights ∧ r∈Roles ∧ object↦a∈roleRights(r) ⇒ a=Own ∧ r=role)&#10;        @grd22 dLabel=FALSE ⇒ (∀a,r·a∈AccessRights ∧ r∈Roles ⇒ (mountPoint↦a∈RoleRights(r) ⇔ object↦a∈roleRights(r)))&#10;        @grd23 depth∈ℕ→ℙ(Containers)&#10;        @grd24 ∀c·c∈Containers ⇒ (∃i·i∈ℕ ∧ c∈depth(i))&#10;        @grd25 depth(0)={Root}&#10;        @grd26 ∀i·i∈ℕ ∧ i≠0 ⇒ (∀c·c∈depth(i) ⇒ c≠Root)&#10;        @grd27 ∀i·i∈ℕ ⇒ (∀c·c∈depth(i+1) ⇒ (∃p·p∈depth(i) ∧ p=Parent(c)))&#10;        theorem @grd28 ∀i·i∈ℕ ∧ (∀c·c∈depth(i) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;⇒ (∀c·c∈depth(i+1) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;        theorem @grd29 ∀i·i∈ℕ ⇒ (∀c·c∈depth(i) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∪ {object}&#10;        @act2 Entities ≔ Entities ∪ {object}&#10;        @act3 Objects ≔ Objects ∪ {object}&#10;        @act4 EntityNames(object) ≔ {parent↦name}&#10;        @act5 RoleRights ≔ roleRights&#10;        @act6 Direct(object) ≔ dLabel&#10;        @act7 EntityMP(object) ≔ mountPoint&#10;  end&#10;&#10;  event create_container&#10;    any session container parent name role dLabel mountPoint roleRights depth&#10;    where&#10;        @grd1 container∈Union∖CurrUnion&#10;        @grd2 session∈Sessions&#10;        @grd3 parent∈Containers&#10;        @grd4 parent↦WriteA∈SessionAccesses(session)&#10;        @grd5 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ parent↦Execute∈RoleRights(r)&#10;        @grd6 name∈Names&#10;        @grd7 ∀e·e∈dom(EntityNames) ⇒ parent↦name∉EntityNames(e)&#10;        @grd8 role∈OrdRoles&#10;        @grd9 role∈UserRoles(SessionUser(session))&#10;        @grd10 role↦WriteA∈SessionAdmAccesses(session)&#10;        @grd11 mountPoint∈Containers&#10;        @grd12 dLabel∈BOOL&#10;        @grd13 ∀e·e∈dom(EntityNames) ∧ parent∈dom(EntityNames(e)) ⇒ Direct(e)=dLabel&#10;        @grd14 dLabel=TRUE ⇒ Direct(parent)=TRUE&#10;        @grd15 dLabel=TRUE ⇒ mountPoint=Root&#10;        @grd16 dLabel=FALSE ∧ Direct(parent)=FALSE ⇒ mountPoint=EntityMP(parent)&#10;        @grd17 dLabel=FALSE ∧ Direct(parent)=TRUE ⇒ mountPoint=parent&#10;        @grd18 roleRights∈Roles→(Entities∪{container}↔AccessRights)&#10;        @grd19 ∀e,a,r·e∈Entities ∧ a∈AccessRights ∧ r∈Roles ⇒ (e↦a∈roleRights(r) ⇔ e↦a∈RoleRights(r))&#10;        @grd20 dLabel=TRUE ⇒ container↦Own∈roleRights(role)&#10;        @grd21 dLabel=TRUE ⇒ (∀a,r·a∈AccessRights ∧ r∈Roles ∧ container↦a∈roleRights(r) ⇒ a=Own ∧ r=role)&#10;        @grd22 dLabel=FALSE ⇒ (∀a,r·a∈AccessRights ∧ r∈Roles ⇒ (mountPoint↦a∈RoleRights(r) ⇔ container↦a∈roleRights(r)))&#10;        @grd23 depth∈ℕ→ℙ(Containers)&#10;        @grd24 ∀c·c∈Containers ⇒ (∃i·i∈ℕ ∧ c∈depth(i))&#10;        @grd25 depth(0)={Root}&#10;        @grd26 ∀i·i∈ℕ ∧ i≠0 ⇒ (∀c·c∈depth(i) ⇒ c≠Root)&#10;        @grd27 ∀i·i∈ℕ ⇒ (∀c·c∈depth(i+1) ⇒ (∃p·p∈depth(i) ∧ p=Parent(c)))&#10;        theorem @grd28 ∀i·i∈ℕ ∧ (∀c·c∈depth(i) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;⇒ (∀c·c∈depth(i+1) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;        theorem @grd29 ∀i·i∈ℕ ⇒ (∀c·c∈depth(i) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∪ {container}&#10;        @act2 Entities ≔ Entities ∪ {container}&#10;        @act3 Containers ≔ Containers ∪ {container}&#10;        @act4 Shared(container) ≔ FALSE&#10;        @act5 Parent(container) ≔ parent&#10;        @act6 EntityNames(container) ≔ {parent↦name}&#10;        @act7 RoleRights ≔ roleRights&#10;        @act8 Direct(container) ≔ dLabel&#10;        @act9 EntityMP(container) ≔ mountPoint&#10;  end&#10;&#10;  event set_entity_owner&#10;    any session owner oldOwner entity roleRights&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 entity∈Entities&#10;        @grd3 owner∈Roles&#10;        @grd4 oldOwner∈Roles&#10;        @grd5 owner↦WriteA∈SessionAdmAccesses(session)&#10;        @grd6 EntitiesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd7 (oldOwner↦ReadA∈SessionAdmAccesses(session) ∧ oldOwner↦WriteA∈SessionAdmAccesses(session)&#10;                  ∧ entity↦Own∈RoleRights(oldOwner))&#10;              ∨ (∀r·r∈Roles ⇒ entity↦Own∉RoleRights(r))&#10;        @grd8 ∃E,c·E⊆Containers ∧ Root∉E ∧ ((entity∈dom(EntityNames) ∧ c∈dom(EntityNames(entity)) ∧ Parent[E]∪{c}=E∪{Root}) ∨ (E=∅ ∧ entity=Root))&#10;                   ∧ (∀o·o∈E∪{entity} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd9 roleRights∈Roles→(Entities↔AccessRights)&#10;        @grd10 ∀r·r∈Roles ∧ r≠oldOwner ∧ r≠owner ⇒ RoleRights(r)=roleRights(r)&#10;        @grd11 RoleRights(owner)⊆roleRights(owner)&#10;        @grd12 roleRights(oldOwner)⊆RoleRights(oldOwner)&#10;        @grd13 ∀r,e,ar·r∈Roles ∧ e∈Entities ⇒ (e↦ar∈roleRights(r) ∧ e↦ar∉RoleRights(r) ⇔ r=owner ∧ ar=Own)&#10;        @grd14 ∀r,e,ar·r∈Roles ∧ e∈Entities ⇒ (e↦ar∉roleRights(r) ∧ e↦ar∈RoleRights(r) ⇔ r=owner ∧ ar=Own)&#10;        @grd15 Direct(entity)=TRUE&#10;        @grd16 ∀e·e∈Entities ∧ e↦Own∈roleRights(owner) ∧ e↦Own∉RoleRights(owner) ⇒ (e=entity ∨ (Direct(e)=FALSE ∧ EntityMP(e)=entity))&#10;        @grd17 ∀e·e∈Entities ∧ (e=entity ∨ (Direct(e)=FALSE ∧ EntityMP(e)=entity)) ⇒ e↦Own∈roleRights(owner) ∧ e↦Own∉RoleRights(owner)&#10;        @grd18 ∀e·e∈Entities ∧ e↦Own∉roleRights(oldOwner) ∧ e↦Own∈RoleRights(oldOwner) ⇒ (e=entity ∨ (Direct(e)=FALSE ∧ EntityMP(e)=entity))&#10;        @grd19 ∀e·e∈Entities ∧ (e=entity ∨ (Direct(e)=FALSE ∧ EntityMP(e)=entity)) ⇒ e↦Own∉roleRights(oldOwner) ∧ e↦Own∈RoleRights(oldOwner)&#10;    then&#10;        @act1 RoleRights ≔ roleRights&#10;  end&#10;&#10;  event create_hard_link&#10;    any session object parent name depth&#10;    where&#10;        @grd1 object∈Objects&#10;        @grd2 session∈Sessions&#10;        @grd3 parent∈Containers&#10;        @grd4 ∃E,c·E⊆Containers ∧ Root∉E ∧ c∈dom(EntityNames(object)) ∧ Parent[E]∪{c}=E∪{Root}&#10;                   ∧ (∀o·o∈E∪{object} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd5 parent↦WriteA∈SessionAccesses(session)&#10;        @grd6 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ parent↦Execute∈RoleRights(r)&#10;        @grd7 name∈Names&#10;        @grd8 ∀e·e∈dom(EntityNames) ⇒ parent↦name∉EntityNames(e)&#10;        @grd9 ∀e·e∈dom(EntityNames) ∧ parent∈dom(EntityNames(e)) ⇒ Direct(e)=Direct(object)&#10;        @grd10 Direct(object)=TRUE ⇒ Direct(parent)=TRUE&#10;        @grd11 Direct(object)=FALSE ∧ Direct(parent)=TRUE ⇒ EntityMP(object)=parent&#10;        @grd12 Direct(object)=FALSE ∧ Direct(parent)=TRUE ⇒ (∀e·e∈dom(EntityNames) ∧ parent∈dom(EntityNames(e)) ⇒ Direct(e)=FALSE)&#10;        @grd13 Direct(object)=FALSE ∧ Direct(parent)=FALSE ⇒ EntityMP(object)=EntityMP(parent)&#10;        @grd14 depth∈ℕ→ℙ(Containers)&#10;        @grd15 ∀c·c∈Containers ⇒ (∃i·i∈ℕ ∧ c∈depth(i))&#10;        @grd16 depth(0)={Root}&#10;        @grd17 ∀i·i∈ℕ ∧ i≠0 ⇒ (∀c·c∈depth(i) ⇒ c≠Root)&#10;        @grd18 ∀i·i∈ℕ ⇒ (∀c·c∈depth(i+1) ⇒ (∃p·p∈depth(i) ∧ p=Parent(c)))&#10;        theorem @grd19 ∀i·i∈ℕ ∧ (∀c·c∈depth(i) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;⇒ (∀c·c∈depth(i+1) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;        theorem @grd20 ∀i·i∈ℕ ⇒ (∀c·c∈depth(i) ⇒ (∃E·E⊆Containers ∧ Root∉E ∧ Parent[E]∪{c}=E∪{Root}))&#10;    then&#10;        @act1 EntityNames(object) ≔ EntityNames(object) ∪ {parent↦name}&#10;  end&#10;&#10;  event delete_hard_link&#10;    any session parent name object&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 parent∈Containers&#10;        @grd3 object∈Objects&#10;        @grd4 name∈Names&#10;        @grd5 parent↦name∈EntityNames(object)&#10;        @grd6 ∃p,n·p∈Containers ∧ p↦n∈EntityNames(object) ∧ (n≠name ∨ p≠parent)&#10;        @grd7 parent↦WriteA∈SessionAccesses(session)&#10;        @grd8 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ parent↦Execute∈RoleRights(r)&#10;        @grd9 Shared(parent)=TRUE ⇒ (∃r·r∈Roles ∧ object↦Own∈RoleRights(r) ∧ r↦ReadA∈SessionAdmAccesses(session))&#10;    then&#10;        @act1 EntityNames(object) ≔ EntityNames(object) ∖ {parent↦name}&#10;  end&#10;&#10;  event rename_entity&#10;    any session oldName name parent entity&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 parent∈Containers&#10;        @grd3 entity∈dom(EntityNames)&#10;        @grd4 oldName∈Names&#10;        @grd5 parent↦oldName∈EntityNames(entity)&#10;        @grd6 name∈Names&#10;        @grd7 ∀e·e∈dom(EntityNames) ⇒ parent↦name∉EntityNames(e)&#10;        @grd8 parent↦WriteA∈SessionAccesses(session)&#10;        @grd9 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ parent↦Execute∈RoleRights(r)&#10;        @grd10 Shared(parent)=TRUE ⇒ (∃r·r∈Roles ∧ entity↦Own∈RoleRights(r) ∧ r↦ReadA∈SessionAdmAccesses(session))&#10;    then&#10;        @act1 EntityNames(entity) ≔ (EntityNames(entity) ∖ {parent↦oldName}) ∪ {parent↦name}&#10;  end&#10;&#10;  event set_container_attr&#10;    any session container shared&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 container∈Containers&#10;        @grd3 shared∈BOOL&#10;        @grd4 (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ container↦Own∈RoleRights(r))&#10;                  ∨ EntitiesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd5 ∃E,c·E⊆Containers ∧ Root∉E ∧ ((container∈dom(EntityNames) ∧ c∈dom(EntityNames(container)) ∧ Parent[E]∪{c}=E∪{Root}) ∨ (E=∅ ∧ container=Root))&#10;                   ∧ (∀o·o∈E∪{container} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd6 EntitiesAR↦ReadA∈SessionAdmAccesses(session)&#10;    then&#10;        @act1 Shared(container) ≔ shared&#10;  end&#10;&#10;  event delete_entity&#10;    any session entity parent name roleRights sessionAccesses&#10;    where&#10;        @grd1 entity∈Entities&#10;        @grd2 entity≠Root&#10;        @grd3 session∈Sessions&#10;        @grd4 parent∈Containers&#10;        @grd5 parent↦name∈EntityNames(entity)&#10;        @grd6 ∀n·n≠name ⇒ parent↦n∉EntityNames(entity)&#10;        @grd7 ∀e·e∈dom(EntityNames) ⇒ entity∉dom(EntityNames(e))&#10;        @grd8 ∀c·c∈Containers ∧ c≠parent ⇒ c∉dom(EntityNames(entity))&#10;        @grd9 parent↦WriteA∈SessionAccesses(session)&#10;        @grd10 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ parent↦Execute∈RoleRights(r)&#10;        @grd11 Shared(parent)=TRUE ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ entity↦Own∈RoleRights(r))&#10;        @grd12 roleRights∈Roles→(Entities↔AccessRights)&#10;        @grd13 ∀r·r∈Roles ⇒ roleRights(r)={entity} ⩤ RoleRights(r)&#10;        @grd14 sessionAccesses∈Sessions→(Entities↔Accesses)&#10;        @grd15 ∀s·s∈Sessions ⇒ sessionAccesses(s)={entity} ⩤ SessionAccesses(s)&#10;        theorem @grd16 ∀e·e∈Entities ∧ entity∈Containers ⇒ EntityMP(e)≠entity&#10;    then&#10;        @act1 Entities ≔ Entities ∖ {entity}&#10;        @act2 Objects ≔ Objects ∖ {entity}&#10;        @act3 Containers ≔ Containers ∖ {entity}&#10;        @act4 Shared ≔ {entity} ⩤ Shared&#10;        @act5 Parent ≔ {entity} ⩤ Parent&#10;        @act6 EntityNames ≔ {entity} ⩤ EntityNames&#10;        @act7 RoleRights ≔ roleRights&#10;        @act8 SessionAccesses ≔ sessionAccesses&#10;        @act9 Direct ≔ {entity} ⩤ Direct&#10;        @act10 CurrUnion ≔ CurrUnion ∖ {entity}&#10;        @act11 EntityMP ≔ {entity} ⩤ EntityMP&#10;  end&#10;&#10;  event create_first_session&#10;    any session newSession user object owner userAdmRole userOrdRole commonRole sessionAdmAccesses&#10;    where&#10;        @grd1 newSession∈Union∖CurrUnion&#10;        @grd2 session∈Sessions&#10;        @grd3 user∈UserAccs&#10;        @grd4 object∈Objects&#10;        @grd5 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ object↦Execute∈RoleRights(r)&#10;        @grd6 ∃E,c·E⊆Containers ∧ Root∉E ∧ c∈dom(EntityNames(object)) ∧ Parent[E]∪{c}=E∪{Root}&#10;                   ∧ (∀o·o∈E∪{object} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd7 sessionAdmAccesses∈Roles↔Accesses&#10;        @grd8 userAdmRole∈AdmRoles&#10;        @grd9 userOrdRole∈OrdRoles&#10;        @grd10 userAdmRole∈UserRoles(user)&#10;        @grd11 userOrdRole∈UserRoles(user)&#10;        @grd12 commonRole∈CommonRoles&#10;        @grd13 userAdmRole↦ReadA∈sessionAdmAccesses&#10;        @grd14 userOrdRole↦ReadA∈sessionAdmAccesses&#10;        @grd15 userOrdRole↦WriteA∈sessionAdmAccesses&#10;        @grd16 commonRole↦ReadA∈sessionAdmAccesses&#10;        @grd17 commonRole↦WriteA∈sessionAdmAccesses&#10;        @grd18 ∀r·r∈Roles ∧ r≠userAdmRole ∧ r≠userOrdRole ∧ r≠commonRole ⇒ r∉dom(sessionAdmAccesses)&#10;        @grd19 owner∈OrdRoles&#10;        @grd20 owner∈UserRoles(user)&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∪ {newSession}&#10;        @act2 Sessions ≔ Sessions ∪ {newSession}&#10;        @act3 SessionUser(newSession) ≔ user&#10;        @act4 SessionAccesses(newSession) ≔ ∅&#10;        @act5 SessionAdmAccesses(newSession) ≔ sessionAdmAccesses&#10;        @act6 SessionOwner(newSession) ≔ owner&#10;  end&#10;&#10;  event create_session&#10;    any session newSession user object owner userAdmRole userOrdRole commonRole sessionAdmAccesses&#10;    where&#10;        @grd1 newSession∈Union∖CurrUnion&#10;        @grd2 session∈Sessions&#10;        @grd3 user∈UserAccs&#10;        @grd4 user=SessionUser(session)&#10;        @grd5 object∈Objects&#10;        @grd6 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ object↦Execute∈RoleRights(r)&#10;        @grd7 ∃E,c·E⊆Containers ∧ Root∉E ∧ c∈dom(EntityNames(object)) ∧ Parent[E]∪{c}=E∪{Root}&#10;                   ∧ (∀o·o∈E∪{object} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd8 sessionAdmAccesses∈Roles↔Accesses&#10;        @grd9 userAdmRole∈AdmRoles&#10;        @grd10 userOrdRole∈OrdRoles&#10;        @grd11 userAdmRole∈UserRoles(user)&#10;        @grd12 userOrdRole∈UserRoles(user)&#10;        @grd13 commonRole∈CommonRoles&#10;        @grd14 userAdmRole↦ReadA∈sessionAdmAccesses&#10;        @grd15 userOrdRole↦ReadA∈sessionAdmAccesses&#10;        @grd16 userOrdRole↦WriteA∈sessionAdmAccesses&#10;        @grd17 commonRole↦ReadA∈sessionAdmAccesses&#10;        @grd18 commonRole↦WriteA∈sessionAdmAccesses&#10;        @grd19 ∀r·r∈Roles ∧ r≠userAdmRole ∧ r≠userOrdRole ∧ r≠commonRole ⇒ r∉dom(sessionAdmAccesses)&#10;        @grd20 owner∈Roles&#10;        @grd21 owner∈UserRoles(user)&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∪ {newSession}&#10;        @act2 Sessions ≔Sessions ∪ {newSession}&#10;        @act3 SessionUser(newSession) ≔ user&#10;        @act4 SessionAccesses(newSession) ≔ ∅&#10;        @act5 SessionAdmAccesses(newSession) ≔ sessionAdmAccesses&#10;        @act6 SessionOwner(newSession) ≔ owner&#10;        @act7 SParent(newSession) ≔ session&#10;  end&#10;&#10;  event set_subject_owner&#10;    any session oldOwner owner subject&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 subject∈Sessions&#10;        @grd3 oldOwner∈Roles&#10;        @grd4 owner∈Roles&#10;        @grd5 owner↦WriteA∈SessionAdmAccesses(session)&#10;        @grd6 SubjectsAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd7 subject∈dom(SessionOwner) ⇒ SessionOwner(subject)=oldOwner&#10;        @grd8 subject∈dom(SessionOwner) ⇒ oldOwner↦ReadA∈SessionAdmAccesses(session)&#10;        @grd9 subject∈dom(SessionOwner) ⇒ oldOwner↦WriteA∈SessionAdmAccesses(session)&#10;    then&#10;        @act1 SessionOwner(subject) ≔ owner&#10;  end&#10;&#10;  event delete_session&#10;    any session delSession&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 delSession∈Sessions&#10;        @grd3 ∀s·s∈dom(SParent) ⇒ SParent(s)≠delSession&#10;        @grd4 delSession∈dom(SessionOwner) ⇒ SessionOwner(delSession)↦ReadA∈SessionAdmAccesses(session)&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∖ {delSession}&#10;        @act2 Sessions ≔ Sessions ∖ {delSession}&#10;        @act3 SessionUser ≔ {delSession} ⩤ SessionUser&#10;        @act4 SessionAccesses ≔ {delSession} ⩤ SessionAccesses&#10;        @act5 SessionOwner ≔ {delSession} ⩤ SessionOwner&#10;        @act6 SessionAdmAccesses ≔ {delSession} ⩤ SessionAdmAccesses&#10;        @act7 SParent ≔ {delSession} ⩤ SParent&#10;  end&#10;&#10;  event create_role&#10;    any session role parent name admRoles ordRoles roleAdmRights&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Union∖CurrUnion&#10;        @grd3 parent∈Roles&#10;        @grd4 ∀u·u∈UserAccs ⇒ parent∉UserRoles(u)&#10;        @grd5 parent∉CommonRoles&#10;        @grd6 parent∉SpecialAdmRoles&#10;        @grd7 parent∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd8 parent∈OrdRoles ⇒ RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd9 parent∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd10 parent∈AdmRoles ⇒ ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd11 parent↦WriteA∈SessionAdmAccesses(session)&#10;        @grd12 name∈Names&#10;        @grd13 ∀r·r∈Roles ⇒ name≠RoleName(r)&#10;        @grd14 admRoles∈ℙ(Union∖CurrUnion)&#10;        @grd15 ordRoles∈ℙ(Union∖CurrUnion)&#10;        @grd16 parent∈AdmRoles ⇒ ordRoles=∅&#10;        @grd17 parent∈AdmRoles ⇒ admRoles={role}&#10;        @grd18 parent∈OrdRoles ⇒ ordRoles={role}&#10;        @grd19 parent∈OrdRoles ⇒ admRoles=∅&#10;        @grd20 roleAdmRights∈AdmRoles∪admRoles→(Roles∪{role}↔AccessRights)&#10;        @grd21 ∀r1,ar,r2·r1∈Roles ∧ r2∈AdmRoles ∧ ar∈AccessRights&#10;                   ⇒ (r1↦ar∈RoleAdmRights(r2) ⇔ r1↦ar∈roleAdmRights(r2))&#10;        theorem @grd22 parent∈AdmRoles ⇒ role∈dom(roleAdmRights)&#10;        theorem @grd23 role∈dom(roleAdmRights) ⇒ parent∈AdmRoles&#10;        @grd24 parent∈OrdRoles ⇒ role↦Own∈roleAdmRights(RolesAR)&#10;        @grd25 parent∈OrdRoles ⇒ role↦Own∉roleAdmRights(ARolesAR)&#10;        @grd26 parent∈AdmRoles ⇒ role↦Own∈roleAdmRights(ARolesAR)&#10;        @grd27 parent∈AdmRoles ⇒ role↦Own∉roleAdmRights(RolesAR)&#10;        @grd28 parent∈AdmRoles ⇒ (∀r·r∈Roles∪{role} ⇒ r↦Execute∈roleAdmRights(role))&#10;        @grd29 parent∈AdmRoles ⇒ (∀ar·ar∈AccessRights ∧ ar≠Execute ⇒ ar∉ran(roleAdmRights(role)))&#10;        @grd30 ∀r·r∈AdmRoles ⇒ role↦Execute∈roleAdmRights(r)&#10;        @grd31 ∀r·r∈AdmRoles ∧ r≠RolesAR ∧ r≠ARolesAR ⇒ role↦Own∉roleAdmRights(r)&#10;        @grd32 ∀r·r∈AdmRoles ⇒ role↦Write∉roleAdmRights(r)&#10;        @grd33 ∀r·r∈AdmRoles ⇒ (parent↦Read∈RoleAdmRights(r) ⇔ role↦Read∈roleAdmRights(r))&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∪ {role}&#10;        @act2 Roles ≔ Roles ∪ {role}&#10;        @act3 AdmRoles ≔ AdmRoles ∪ admRoles&#10;        @act4 OrdRoles ≔ OrdRoles ∪ ordRoles&#10;        @act5 RoleAdmRights ≔ roleAdmRights&#10;        @act6 RParents(role) ≔ {parent}&#10;        @act7 RoleRights(role) ≔ ∅&#10;        @act8 RoleName(role) ≔ name&#10;        @act9 Shared(role) ≔ TRUE&#10;  end&#10;&#10;  event create_hard_link_role&#10;    any session role parent roleAdmRights depth&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 ∀u·u∈UserAccs ⇒ role∉UserRoles(u)&#10;        @grd4 role∉CommonRoles&#10;        @grd5 role∉SpecialAdmRoles&#10;        @grd6 parent∈Roles&#10;        @grd7 ∀u·u∈UserAccs ⇒ parent∉UserRoles(u)&#10;        @grd8 parent∉CommonRoles&#10;        @grd9 parent≠role&#10;        @grd10 ∀R·R⊆Roles ∧ role∈R ∧ (∀r·r∈R ∧ role≠r ⇒ (∃p·p∈R ∧ p∈RParents(r))) ⇒ parent∉R&#10;        @grd11 parent∈AdmRoles ⇔ role∈AdmRoles&#10;        @grd12 parent∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd13 parent∈OrdRoles ⇒ RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd14 parent∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd15 parent∈AdmRoles ⇒ ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd16 parent↦WriteA∈SessionAdmAccesses(session)&#10;        @grd17 roleAdmRights∈AdmRoles→(Roles↔AccessRights)&#10;        @grd18 ∀r·r∈AdmRoles ⇒ RoleAdmRights(r)⊆roleAdmRights(r)&#10;        @grd19 ∀r·r∈AdmRoles ∧ parent↦Read∈RoleAdmRights(r) ⇒ role↦Read∈roleAdmRights(r)&#10;        @grd20 ∀ar,r,p·r∈Roles ∧ ar∈AdmRoles ∧ p↦Read∈roleAdmRights(ar)&#10;                   ∧ p∈RParents(r) ∧ p↦Read∉RoleAdmRights(ar)&#10;                       ⇒ r↦Read∈roleAdmRights(ar)&#10;        @grd25 ∀ar·ar∈AdmRoles ∧ parent↦Read∉RoleAdmRights(ar)&#10;                   ⇒ roleAdmRights(ar)=RoleAdmRights(ar)&#10;        @grd26 ∀r,accessRight,ar·ar∈AdmRoles ∧ accessRight∈AccessRights&#10;                   ∧ r↦accessRight∈roleAdmRights(ar) ∧ r↦accessRight∉RoleAdmRights(ar)&#10;                       ⇒ accessRight=Read&#10;        @grd27 depth∈ℕ→ℙ(Roles)&#10;        @grd28 ∀ar,r·ar∈AdmRoles ⇒ (r↦Read∈roleAdmRights(ar) ∧ r↦Read∉RoleAdmRights(ar) ⇔ (∃i·i∈ℕ ∧ r∈depth(i)))&#10;        @grd29 depth(0)={role}&#10;        @grd30 ∀i·i∈ℕ ⇒ (∀r·r∈depth(i+1) ⇒ (∃p·p∈depth(i) ∧ p∈RParents(r)))&#10;        theorem @grd31 ∀r·r∈depth(0) ⇒ (∀u·u∈UserAccs ⇒ r∉UserRoles(u))&#10;        theorem @grd32 ∀i·i∈ℕ ∧ (∀r·r∈depth(i) ⇒ (∀u·u∈UserAccs ⇒ r∉UserRoles(u)))&#10;               &#9;&#9;&#9;&#9;⇒ (∀r·r∈depth(i+1) ⇒ (∀u·u∈UserAccs ⇒ r∉UserRoles(u)))&#10;        theorem @grd33 ∀i·i∈ℕ ⇒ (∀r·r∈depth(i) ⇒ (∀u·u∈UserAccs ⇒ r∉UserRoles(u)))&#10;    then&#10;        @act1 RParents(role) ≔ RParents(role) ∪ {parent}&#10;        @act2 RoleAdmRights ≔ roleAdmRights&#10;  end&#10;&#10;  event delete_hard_link_role&#10;    any session role parent&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 ∀u·u∈UserAccs ⇒ role∉UserRoles(u)&#10;        @grd4 role∉CommonRoles&#10;        @grd5 role∉SpecialAdmRoles&#10;        @grd6 parent∈Roles&#10;        @grd7 parent∈RParents(role)&#10;        @grd8 ∃p·p∈Roles ∧ p≠parent ∧ p∈RParents(role)&#10;        @grd9 parent∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd10 parent∈OrdRoles ⇒ RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd11 parent∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd12 parent∈AdmRoles ⇒ ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd13 parent↦WriteA∈SessionAdmAccesses(session)&#10;    then&#10;        @act1 RParents(role) ≔ RParents(role) ∖ {parent}&#10;  end&#10;&#10;  event rename_role&#10;    any session role name&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 ∀u·u∈UserAccs ⇒ role∉UserRoles(u)&#10;        @grd4 role∉CommonRoles&#10;        @grd5 role∉SpecialAdmRoles&#10;        @grd6 name∈Names&#10;        @grd7 ∀r·r∈Roles ⇒ name≠RoleName(r)&#10;        @grd8 role∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd9 role∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd10 ∀p·p∈Roles ∧ p∈RParents(role) ⇒ p↦WriteA∈SessionAdmAccesses(session)&#10;    then&#10;        @act1 RoleName(role) ≔ name&#10;  end&#10;&#10;  event delete_role&#10;    any session role parent sessionAdmAccesses roleAdmRights&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 ∀u·u∈UserAccs ⇒ role∉UserRoles(u)&#10;        @grd4 role∉CommonRoles&#10;        @grd5 role∉SpecialAdmRoles&#10;        @grd6 parent∈Roles&#10;        @grd7 parent∈RParents(role)&#10;        @grd8 ∀r·r∈Roles ⇒ role∉RParents(r)&#10;        @grd9 parent∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd10 parent∈OrdRoles ⇒ RolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd11 parent∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd12 parent∈AdmRoles ⇒ ARolesAR↦WriteA∈SessionAdmAccesses(session)&#10;        @grd13 parent↦WriteA∈SessionAdmAccesses(session)&#10;        @grd14 sessionAdmAccesses∈Sessions→(Roles∖{role}↔Accesses)&#10;        @grd15 ∀s·s∈Sessions ⇒ sessionAdmAccesses(s)={role} ⩤ SessionAdmAccesses(s)&#10;        @grd16 roleAdmRights∈AdmRoles∖{role}→(Roles∖{role}↔AccessRights)&#10;        @grd17 ∀r·r∈AdmRoles ∧ r≠role ⇒ roleAdmRights(r)={role} ⩤ RoleAdmRights(r)&#10;    then&#10;        @act1 CurrUnion ≔ CurrUnion ∖ {role}&#10;        @act2 Roles ≔ Roles ∖ {role}&#10;        @act3 OrdRoles ≔ OrdRoles ∖ {role}&#10;        @act4 AdmRoles ≔ AdmRoles ∖ {role}&#10;        @act5 RoleAdmRights ≔ roleAdmRights&#10;        @act6 RParents ≔ {role} ⩤ RParents&#10;        @act7 RoleRights ≔ {role} ⩤ RoleRights&#10;        @act8 RoleName ≔ {role} ⩤ RoleName&#10;        @act9 SessionAdmAccesses ≔ sessionAdmAccesses&#10;        @act10 SessionOwner ≔ SessionOwner ⩥ {role}&#10;        @act11 Shared ≔ {role} ⩤ Shared&#10;  end&#10;&#10;  event access_read&#10;    any session entity&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 entity∈Entities&#10;        @grd3 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ entity↦Read∈RoleRights(r)&#10;        @grd4 ∃E,c·E⊆Containers ∧ Root∉E ∧ ((entity∈dom(EntityNames) ∧ c∈dom(EntityNames(entity)) ∧ Parent[E]∪{c}=E∪{Root}) ∨ (E=∅ ∧ entity=Root))&#10;                   ∧ (∀o·o∈E∪{entity} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;    then&#10;        @act1 SessionAccesses(session) ≔ SessionAccesses(session) ∪ {entity↦ReadA}&#10;  end&#10;&#10;  event access_read_role&#10;    any session role&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 ∃r·r∈AdmRoles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ role↦Read∈RoleAdmRights(r)&#10;    then&#10;        @act1 SessionAdmAccesses(session) ≔ SessionAdmAccesses(session) ∪ {role↦ReadA}&#10;  end&#10;&#10;  event access_write&#10;    any session entity&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 entity∈Entities&#10;        @grd3 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ entity↦Write∈RoleRights(r)&#10;        @grd4 ∃E,c·E⊆Containers ∧ Root∉E ∧ ((entity∈dom(EntityNames) ∧ c∈dom(EntityNames(entity)) ∧ Parent[E]∪{c}=E∪{Root}) ∨ (E=∅ ∧ entity=Root))&#10;                   ∧ (∀o·o∈E∪{entity} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;    then&#10;        @act1 SessionAccesses(session) ≔ SessionAccesses(session) ∪ {entity↦WriteA}&#10;  end&#10;&#10;  event access_write_role&#10;    any session role&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 ∃r·r∈AdmRoles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ role↦Write∈RoleAdmRights(r)&#10;    then&#10;        @act1 SessionAdmAccesses(session) ≔ SessionAdmAccesses(session) ∪ {role↦WriteA}&#10;  end&#10;&#10;  event delete_access&#10;    any session entity access&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 entity∈Entities&#10;        @grd3 entity↦access∈SessionAccesses(session)&#10;    then&#10;        @act1 SessionAccesses(session) ≔ SessionAccesses(session) ∖ {entity↦access}&#10;  end&#10;&#10;  event delete_access_role&#10;    any session role access&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 role↦access∈SessionAdmAccesses(session)&#10;    then&#10;        @act1 SessionAdmAccesses(session) ≔ SessionAdmAccesses(session) ∖ {role↦access}&#10;  end&#10;&#10;  event grant_rights&#10;    any session role entity accessRights roleRights changedEntities&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 entity∈Entities&#10;        @grd3 role∈Roles&#10;        @grd4 accessRights⊆AccessRights&#10;        @grd5 Own∉accessRights&#10;        @grd6 role↦WriteA∈SessionAdmAccesses(session)&#10;        @grd7 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ entity↦Own∈RoleRights(r)&#10;        @grd8 ∃E,c·E⊆Containers ∧ Root∉E ∧ ((entity∈dom(EntityNames) ∧ c∈dom(EntityNames(entity)) ∧ Parent[E]∪{c}=E∪{Root}) ∨ (E=∅ ∧ entity=Root))&#10;                   ∧ (∀o·o∈E∪{entity} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd9 Direct(entity)=TRUE&#10;        @grd10 changedEntities⊆Entities&#10;        @grd11 entity∈changedEntities&#10;        @grd12 ∀e·e∈changedEntities ∧ e≠entity ⇒ EntityMP(e)=entity ∧ Direct(e)=FALSE&#10;        @grd13 ∀e·e∈Entities ∧ e≠entity ∧ EntityMP(e)=entity ∧ Direct(e)=FALSE ⇒ e∈changedEntities&#10;        @grd14 roleRights∈changedEntities↔accessRights&#10;        @grd15 ∀e,ar·e∈changedEntities ∧ ar∈accessRights ⇒ e↦ar∈roleRights&#10;    then&#10;        @act1 RoleRights(role) ≔ RoleRights(role) ∪ roleRights&#10;  end&#10;&#10;  event remove_rights&#10;    any session role entity accessRights roleRights&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 entity∈Entities&#10;        @grd3 role∈Roles&#10;        @grd4 accessRights⊆AccessRights&#10;        @grd5 Own∉accessRights&#10;        @grd6 role↦WriteA∈SessionAdmAccesses(session)&#10;        @grd7 ∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ entity↦Own∈RoleRights(r)&#10;        @grd8 ∃E,c·E⊆Containers ∧ Root∉E ∧ ((entity∈dom(EntityNames) ∧ c∈dom(EntityNames(entity)) ∧ Parent[E]∪{c}=E∪{Root}) ∨ (E=∅ ∧ entity=Root))&#10;                   ∧ (∀o·o∈E∪{entity} ⇒ (∃r·r∈Roles ∧ r↦ReadA∈SessionAdmAccesses(session) ∧ o↦Execute∈RoleRights(r)))&#10;        @grd9 Direct(entity)=TRUE&#10;        @grd10 roleRights⊆RoleRights(role)&#10;        @grd11 ∀e,ar·e∈Entities ∧ ar∈accessRights ∧ (e=entity ∨ (Direct(e)=FALSE ∧ EntityMP(e)=entity))&#10;                   ⇒ e↦ar∈roleRights&#10;        @grd12 ∀e,ar·e↦ar∈roleRights ⇒ ar∈accessRights ∧ (e=entity ∨ (Direct(e)=FALSE ∧ EntityMP(e)=entity))&#10;    then&#10;        @act1 RoleRights(role) ≔ RoleRights(role) ∖ roleRights&#10;  end&#10;&#10;  event grant_admin_rights&#10;    any session admRole role accessRights roleAdmRights&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 admRole∈AdmRoles&#10;        @grd4 accessRights⊆{Read, Write}&#10;        @grd5 admRole↦WriteA∈SessionAdmAccesses(session)&#10;        @grd6 role∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd7 role∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd8 roleAdmRights∈Roles↔accessRights&#10;        @grd9 ∀ar·ar∈accessRights ⇒ role↦ar∈roleAdmRights&#10;        @grd10 Read∉accessRights ⇒ dom(roleAdmRights)={role}&#10;        @grd11 ∀r,ar·r∈Roles ∧ r≠role ∧ ar∈AccessRights ∧ ar≠Read ⇒ r↦ar∉roleAdmRights&#10;        @grd12 ∀r,p·r∈Roles ∧ p∈RParents(r) ∧ p↦Read∈roleAdmRights ⇒ r↦Read∈roleAdmRights&#10;    then&#10;        @act1 RoleAdmRights(admRole) ≔ RoleAdmRights(admRole) ∪ roleAdmRights&#10;  end&#10;&#10;  event remove_admin_rights&#10;    any session admRole role accessRights roleAdmRights depth&#10;    where&#10;        @grd1 session∈Sessions&#10;        @grd2 role∈Roles&#10;        @grd3 admRole∈AdmRoles&#10;        @grd4 accessRights⊆{Read, Write}&#10;        @grd5 admRole↦WriteA∈SessionAdmAccesses(session)&#10;        @grd6 role∈OrdRoles ⇒ RolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd7 role∈AdmRoles ⇒ ARolesAR↦ReadA∈SessionAdmAccesses(session)&#10;        @grd8 ∀u·u∈UserAccs ∧ admRole∈UserRoles(u) ⇒ role∉UserRoles(u)&#10;  &#9;&#9;@grd9 ∀u·u∈UserAccs ∧ admRole∈UserRoles(u) ⇒ role∉CommonRoles&#10;        @grd10 roleAdmRights⊆RoleAdmRights(admRole)&#10;        @grd12 ∀ar·ar∈accessRights ⇒ role↦ar∈roleAdmRights&#10;        @grd13 ∀ar·ar∉accessRights ⇒ role↦ar∉roleAdmRights&#10;        @grd14 Read∉accessRights ⇒ (∀r·r∈Roles∖{role} ⇒ r∉dom(roleAdmRights))&#10;        @grd15 ∀r,ar·r∈Roles ∧ r≠role ∧ ar∈AccessRights ∧ ar≠Read ⇒ r↦ar∉roleAdmRights&#10;        @grd16 ∀r,p·r∈Roles ∧ p∈RParents(r) ∧ r↦Read∈roleAdmRights ⇒ p↦Read∈roleAdmRights&#10;        @grd17 depth∈ℕ→ℙ(dom(roleAdmRights))&#10;        @grd18 ∀r·r∈dom(roleAdmRights) ⇒ (∃i·i∈ℕ ∧ r∈depth(i))&#10;        @grd19 depth(0)={role}&#10;        @grd20 ∀i·i∈ℕ ⇒ (∀r·r∈depth(i+1) ⇒ (∃p·p∈depth(i) ∧ p∈RParents(r)))&#10;        theorem @grd21 ∀i·i∈ℕ ∧ (∀r·r∈depth(i) ⇒ (∀u·u∈UserAccs ∧ admRole∈UserRoles(u) ⇒ r∉UserRoles(u) ∧ r∉CommonRoles))&#10;                   &#9;&#9;&#9;⇒ (∀r·r∈depth(i+1) ⇒ (∀u·u∈UserAccs ∧ admRole∈UserRoles(u) ⇒ r∉UserRoles(u) ∧ r∉CommonRoles))&#10;        theorem @grd22 ∀i·i∈ℕ ⇒ (∀r·r∈depth(i) ⇒ (∀u·u∈UserAccs ∧ admRole∈UserRoles(u) ⇒ r∉UserRoles(u) ∧ r∉CommonRoles))&#10;    then&#10;        @act1 RoleAdmRights(admRole) ≔ RoleAdmRights(admRole) ∖ roleAdmRights&#10;  end&#10;&#10;end&#10;" version="5">
<org.eventb.core.seesContext name="_FMGgEE_KEeW7pIdunj-aTw" org.eventb.core.target="C1"/>
<org.eventb.core.event name="'" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="INITIALISATION">
<org.eventb.core.action name="_xHqZAE_XEeW7pIdunj-aTw" org.eventb.core.assignment="CurrUnion ≔ ∅" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_04oJME_XEeW7pIdunj-aTw" org.eventb.core.assignment="UserAccs ≔ ∅" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_04oJMU_XEeW7pIdunj-aTw" org.eventb.core.assignment="Subjects ≔ ∅" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_04oJMk_XEeW7pIdunj-aTw" org.eventb.core.assignment="Entities ≔ ∅" org.eventb.core.label="act4"/>
<org.eventb.core.action name="__FMq4E_XEeW7pIdunj-aTw" org.eventb.core.assignment="Objects ≔ ∅" org.eventb.core.label="act5"/>
<org.eventb.core.action name="__FMq4U_XEeW7pIdunj-aTw" org.eventb.core.assignment="Containers ≔ ∅" org.eventb.core.label="act6"/>
<org.eventb.core.action name="__FMq4k_XEeW7pIdunj-aTw" org.eventb.core.assignment="Roles ≔ ∅" org.eventb.core.label="act7"/>
<org.eventb.core.action name="__FMq40_XEeW7pIdunj-aTw" org.eventb.core.assignment="OrdRoles ≔ ∅" org.eventb.core.label="act8"/>
<org.eventb.core.action name="__FMq5E_XEeW7pIdunj-aTw" org.eventb.core.assignment="AdmRoles ≔ ∅" org.eventb.core.label="act9"/>
<org.eventb.core.action name="_GUJk4E_YEeW7pIdunj-aTw" org.eventb.core.assignment="Direct ≔ ∅" org.eventb.core.label="act10"/>
<org.eventb.core.action name="_GUJk4U_YEeW7pIdunj-aTw" org.eventb.core.assignment="EntityMP ≔ ∅" org.eventb.core.label="act11"/>
<org.eventb.core.action name="_GUJk4k_YEeW7pIdunj-aTw" org.eventb.core.assignment="EntityNames ≔ ∅" org.eventb.core.label="act12"/>
<org.eventb.core.action name="_xKfOEE_YEeW7pIdunj-aTw" org.eventb.core.assignment="Parent ≔ ∅" org.eventb.core.label="act13"/>
<org.eventb.core.action name="_xKfOEU_YEeW7pIdunj-aTw" org.eventb.core.assignment="RoleAdmRights ≔ ∅" org.eventb.core.label="act14"/>
<org.eventb.core.action name="_xKfOEk_YEeW7pIdunj-aTw" org.eventb.core.assignment="RoleName ≔ ∅" org.eventb.core.label="act15"/>
<org.eventb.core.action name="_xKfOE0_YEeW7pIdunj-aTw" org.eventb.core.assignment="RoleRights ≔ ∅" org.eventb.core.label="act16"/>
<org.eventb.core.action name="_xKfOFE_YEeW7pIdunj-aTw" org.eventb.core.assignment="RParents ≔ ∅" org.eventb.core.label="act17"/>
<org.eventb.core.action name="_xKfOFU_YEeW7pIdunj-aTw" org.eventb.core.assignment="Shared ≔ ∅" org.eventb.core.label="act18"/>
<org.eventb.core.action name="_qFxjQE_aEeW7pIdunj-aTw" org.eventb.core.assignment="SParent ≔ ∅" org.eventb.core.label="act19"/>
<org.eventb.core.action name="_qFxjQU_aEeW7pIdunj-aTw" org.eventb.core.assignment="SubjectAccesses ≔ ∅" org.eventb.core.label="act20"/>
<org.eventb.core.action name="_VtQ4YE_iEeW7pIdunj-aTw" org.eventb.core.assignment="SubjectAdmAccesses ≔ ∅" org.eventb.core.label="act21"/>
<org.eventb.core.action name="_TA4bUFCKEeW7pIdunj-aTw" org.eventb.core.assignment="SubjectOwner ≔ ∅" org.eventb.core.label="act22"/>
<org.eventb.core.action name="_y_g8UFCkEeW7pIdunj-aTx" org.eventb.core.assignment="SubjectUser ≔ ∅" org.eventb.core.label="act23"/>
<org.eventb.core.action name="_TA4bUVCKEeW7pIdunj-aTw" org.eventb.core.assignment="UserAdmRole ≔ ∅" org.eventb.core.label="act24"/>
<org.eventb.core.action name="_y_g8UFCkEeW7pIdunj-aTw" org.eventb.core.assignment="UserOrdRole ≔ ∅" org.eventb.core.label="act25"/>
</org.eventb.core.event>
<org.eventb.core.variable name="_FMHHIE_KEeW7pIdunj-aTw" org.eventb.core.identifier="CurrUnion"/>
<org.eventb.core.variable name="_G40gkE_KEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current user accounts" org.eventb.core.identifier="UserAccs"/>
<org.eventb.core.invariant name="_JsI8wE_KEeW7pIdunj-aTw" org.eventb.core.label="CurrUnionType" org.eventb.core.predicate="CurrUnion ⊆ Union"/>
<org.eventb.core.variable name="_NZFvoE_KEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current subjects (processes)" org.eventb.core.identifier="Subjects"/>
<org.eventb.core.invariant name="_TyWXwE_KEeW7pIdunj-aTw" org.eventb.core.label="CurrUnionPartition" org.eventb.core.predicate="partition(CurrUnion, UserAccs, Subjects, Entities, Roles)"/>
<org.eventb.core.variable name="_V8Z0gE_KEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current entities (files and file-like objects, directories)" org.eventb.core.identifier="Entities"/>
<org.eventb.core.variable name="_XjJv4E_KEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current objects (files), subset of Entities" org.eventb.core.identifier="Objects"/>
<org.eventb.core.invariant name="_ZkZO4E_KEeW7pIdunj-aTw" org.eventb.core.label="EntitiesPartition" org.eventb.core.predicate="partition(Entities, Objects, Containers)"/>
<org.eventb.core.variable name="_b3_pME_KEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current containers (directories), subset of Entities" org.eventb.core.identifier="Containers"/>
<org.eventb.core.variable name="_b3_pMU_KEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current roles" org.eventb.core.identifier="Roles"/>
<org.eventb.core.invariant name="_ecC6UE_KEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="RolesPartition" org.eventb.core.predicate="partition(Roles, AdmRoles, OrdRoles)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU_" org.eventb.core.label="CommonRoleType" org.eventb.core.predicate="CommonRole ∈ OrdRoles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU[" org.eventb.core.label="DirectType" org.eventb.core.predicate="Direct ∈ Entities ∪ Roles → BOOL"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU\" org.eventb.core.label="EntityMPType" org.eventb.core.predicate="EntityMP ∈ Entities → Containers"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUK" org.eventb.core.label="EntityNamesType" org.eventb.core.predicate="EntityNames ∈ Entities ∖ {Root} → (Containers ↔ Names)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUL" org.eventb.core.label="ParentType" org.eventb.core.predicate="Parent ∈ Containers ∖ {Root} → Containers"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUY" org.eventb.core.label="RoleAdmRightsType" org.eventb.core.predicate="RoleAdmRights ∈ AdmRoles → (Roles ↔ AccessRights)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUQ" org.eventb.core.label="RoleNameType" org.eventb.core.predicate="RoleName ∈ Roles ↣ Names"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUX" org.eventb.core.label="RoleRightsType" org.eventb.core.predicate="RoleRights ∈ Roles → (Entities ↔ AccessRights)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUM" org.eventb.core.label="RootType" org.eventb.core.predicate="Root ∈ Containers"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUN" org.eventb.core.label="RParentsType" org.eventb.core.predicate="RParents ∈ Roles → ℙ(Roles)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUT" org.eventb.core.label="SharedType" org.eventb.core.predicate="Shared ∈ Containers ∪ Roles → BOOL"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUR" org.eventb.core.label="SParentType" org.eventb.core.predicate="SParent ∈ Subjects ∖ {SRoot} → Subjects"/>
<org.eventb.core.invariant name="_kLskwE_KEeW7pIdunj-aTw" org.eventb.core.label="SpecialAdmRolesTypes" org.eventb.core.predicate="SpecialAdmRoles ⊆ AdmRoles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUS" org.eventb.core.label="SRootType" org.eventb.core.predicate="SRoot ∈ Subjects"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUH" org.eventb.core.label="SubjectAccessesType" org.eventb.core.predicate="SubjectAccesses ∈ Subjects → (Entities ↔ Accesses)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUI" org.eventb.core.label="SubjectAdmAccessesType" org.eventb.core.predicate="SubjectAdmAccesses ∈ Subjects → (Roles ↔ Accesses)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUJ" org.eventb.core.label="SubjectOwnerType" org.eventb.core.predicate="SubjectOwner ∈ Subjects ⇸ Roles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUG" org.eventb.core.label="SubjectUserType" org.eventb.core.predicate="SubjectUser ∈ Subjects → UserAccs"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU]" org.eventb.core.label="UserAdmRoleType" org.eventb.core.predicate="UserAdmRole ∈ UserAccs → AdmRoles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU^" org.eventb.core.comment="&#10;" org.eventb.core.label="UserOrdRoleType" org.eventb.core.predicate="UserOrdRole ∈ UserAccs → OrdRoles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU," org.eventb.core.label="UserAccsAreNotEmpty" org.eventb.core.predicate="UserAccs ≠ ∅"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU-" org.eventb.core.comment="&#10;" org.eventb.core.label="SubjectsAreNotEmpty" org.eventb.core.predicate="Subjects ≠ ∅"/>
<org.eventb.core.variable name="_bIbikE_MEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current ordinary roles, subset of Roles" org.eventb.core.identifier="OrdRoles"/>
<org.eventb.core.variable name="_bIbikU_MEeW7pIdunj-aTw" org.eventb.core.comment="Set of all current administrative roles, subset of Roles" org.eventb.core.identifier="AdmRoles"/>
<org.eventb.core.invariant name="_wtCTgE_MEeW7pIdunj-aTw" org.eventb.core.label="EntityNames1" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ⇒ EntityNames(e) ≠ ∅"/>
<org.eventb.core.invariant name="_wtCTgU_MEeW7pIdunj-aTw" org.eventb.core.label="EntityNames2" org.eventb.core.predicate="∀c · c ∈ Containers ∧ c ≠ Root ⇒ (∃p, n · p ∈ Containers ∧ n ∈ Names ∧ EntityNames(c) = {p ↦ n})"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUf" org.eventb.core.comment="Function. For a given entity returns False if it has a mount point (For example, it has a mount point if it is located on the flash drive)" org.eventb.core.identifier="Direct"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUg" org.eventb.core.comment="Function. For a given entity returns its mount point in the file system" org.eventb.core.identifier="EntityMP"/>
<org.eventb.core.variable name="_Z_4wsE_NEeW7pIdunj-aTw" org.eventb.core.comment="Like function Parent below, but returns the name, under which the file is contained in the container, and the parent container itself." org.eventb.core.identifier="EntityNames"/>
<org.eventb.core.variable name="_mmpOIE_TEeW7pIdunj-aTw" org.eventb.core.comment="Function. Hierarchy of entities in the file system, for each entity except the root directory function returns its parent container." org.eventb.core.identifier="Parent"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUh" org.eventb.core.comment="Function. Current access rights of administrative roles to roles" org.eventb.core.identifier="RoleAdmRights"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUi" org.eventb.core.comment="Function. Stores role names." org.eventb.core.identifier="RoleName"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUj" org.eventb.core.comment="Function. Current access rights of roles to entities" org.eventb.core.identifier="RoleRights"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUk" org.eventb.core.comment="Function. Hierarchy of roles, for each role returns the set of its parent roles." org.eventb.core.identifier="RParents"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUp" org.eventb.core.comment="Function. Sets an additional flag to each entity and role." org.eventb.core.identifier="Shared"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUo" org.eventb.core.comment="Function. Same as Parent, but for subjects" org.eventb.core.identifier="SParent"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUl" org.eventb.core.comment="Function. Current accesses of subjects to entities" org.eventb.core.identifier="SubjectAccesses"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUm" org.eventb.core.comment="Function. Current accesses of subjects to roles" org.eventb.core.identifier="SubjectAdmAccesses"/>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUn" org.eventb.core.comment="Function. Stores an owner (role) of some subjects" org.eventb.core.identifier="SubjectOwner"/>
<org.eventb.core.invariant name="_wSDjgE_TEeW7pIdunj-aTw" org.eventb.core.label="EntityNames3" org.eventb.core.predicate="∀e1, e2 · e1 ∈ dom(EntityNames) ∧ e2 ∈ dom(EntityNames) ∧ e1 ≠ e2 ⇒ EntityNames(e1) ∩ EntityNames(e2) = ∅"/>
<org.eventb.core.invariant name="_mBKlsE_XEeW7pIdunj-aTw" org.eventb.core.label="EntityNames4" org.eventb.core.predicate="∀c1, c2 · c1 ∈ Containers ∧ c1 ≠ Root ∧ c2 ∈ dom(EntityNames(c1)) ⇒ c2 = Parent(c1)"/>
<org.eventb.core.invariant name="_n-bjoE_XEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="EntityNames5" org.eventb.core.predicate="∀c1, c2 · c1 ∈ Containers ∧ c1 ≠ Root ∧ c2 = Parent(c1) ⇒ c2 ∈ dom(EntityNames(c1))"/>
<org.eventb.core.variable name="_oj95oE_XEeW7pIdunj-aTw" org.eventb.core.comment="Function. Stores an user account on which behalf the subject (process) is executed" org.eventb.core.identifier="SubjectUser"/>
<org.eventb.core.invariant name="_n8HaAE_YEeW7pIdunj-aTw" org.eventb.core.label="RParents1" org.eventb.core.predicate="∀r · r ∈ AdmRoles ⇒ RParents(r) ⊆ AdmRoles"/>
<org.eventb.core.invariant name="_7K1RoE_YEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="RParents2" org.eventb.core.predicate="∀r · r ∈ OrdRoles ⇒ RParents(r) ⊆ OrdRoles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUU" org.eventb.core.label="NoCyclesForContainers" org.eventb.core.predicate="∀C · C ⊆ Containers ∧ C ≠ ∅ ∧ Root ∉ C ⇒ C ∖ Parent[C] ≠ ∅"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUV" org.eventb.core.label="NoCyclesForRoles" org.eventb.core.predicate="∀R · R ⊆ Roles ∧ R ≠ ∅ ⇒ (∃r · r ∈ R ∧ (∀p · p ∈ R ⇒ p ∉ RParents(r)))"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUW" org.eventb.core.comment="&#10;" org.eventb.core.label="NoCyclesForSubjects" org.eventb.core.predicate="∀S · S ⊆ dom(SParent) ∧ S ≠ ∅ ⇒ S ∖ SParent[S] ≠ ∅"/>
<org.eventb.core.invariant name="_wi9IcE_iEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="RolesAreShared" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ Shared(r) = TRUE"/>
<org.eventb.core.invariant name="_JizssU_tEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="ExecuteToEverything" org.eventb.core.predicate="∀ar, r · ar ∈ AdmRoles ∧ r ∈ Roles ⇒ r ↦ Execute ∈ RoleAdmRights(ar)"/>
<org.eventb.core.invariant name="_Jizssk_tEeW7pIdunj-aTw" org.eventb.core.label="RolesAR1" org.eventb.core.predicate="∀r · r ∈ OrdRoles ⇒ r ↦ Own ∈ RoleAdmRights(RolesAR)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUZ" org.eventb.core.label="RolesAR2" org.eventb.core.predicate="∀r, ar · r ∈ OrdRoles ∧ ar ∈ AdmRoles ∧ r ↦ Own ∈ RoleAdmRights(ar) ⇒ ar = RolesAR"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aTw" org.eventb.core.label="ARolesAR1" org.eventb.core.predicate="∀r · r ∈ AdmRoles ⇒ r ↦ Own ∈ RoleAdmRights(ARolesAR)"/>
<org.eventb.core.invariant name="_s_FKEFCHEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="ARolesAR2" org.eventb.core.predicate="∀r, ar · r ∈ AdmRoles ∧ ar ∈ AdmRoles ∧ r ↦ Own ∈ RoleAdmRights(ar) ⇒ ar = ARolesAR"/>
<org.eventb.core.invariant name="_qeFiEFCJEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="NoMultipleOwners" org.eventb.core.predicate="∀r1, r2, e · r1 ∈ Roles ∧ r2 ∈ Roles ∧ e ↦ Own ∈ RoleRights(r1) ∧ e ↦ Own ∈ RoleRights(r2) ⇒ r1 = r2"/>
<org.eventb.core.invariant name="_TA7eoFCKEeW7pIdunj-aTw" org.eventb.core.comment="&#10;" org.eventb.core.label="ReadSpreads" org.eventb.core.predicate="∀ar, r, p · ar ∈ AdmRoles ∧ r ∈ Roles ∧ p ∈ Roles&#10;&#9;∧ p ∈ RParents(r) ∧ p ↦ Read ∈ RoleAdmRights(ar)&#10;&#9;&#9;⇒ r ↦ Read ∈ RoleAdmRights(ar)"/>
<org.eventb.core.invariant name="_TA7eo1CKEeW7pIdunj-aTw" org.eventb.core.label="Direct1" org.eventb.core.predicate="∀e · e ∈ Entities ∧ Direct(e) = TRUE ⇒ EntityMP(e) = Root"/>
<org.eventb.core.invariant name="_TA7epFCKEeW7pIdunj-aTw" org.eventb.core.label="Direct2" org.eventb.core.predicate="∀e · e ∈ Entities ∧ Direct(e) = FALSE ⇒ Direct(EntityMP(e)) = TRUE"/>
<org.eventb.core.invariant name="_TA8FsFCKEeW7pIdunj-aTw" org.eventb.core.label="Direct3" org.eventb.core.predicate="∀c · c ∈ Containers ∧ Direct(c) = FALSE ⇒ c ∉ ran(EntityMP)"/>
<org.eventb.core.invariant name="_TA8FsVCKEeW7pIdunj-aTw" org.eventb.core.label="Direct4" org.eventb.core.predicate="∀e, p · e ∈ dom(EntityNames) ∧ p ∈ dom(EntityNames(e)) ∧ Direct(p) = FALSE ⇒ Direct(e) = FALSE"/>
<org.eventb.core.invariant name="_TA8FslCKEeW7pIdunj-aTw" org.eventb.core.label="Direct5" org.eventb.core.predicate="∀e, mp · e ∈ dom(EntityNames) ∧ mp ∈ dom(EntityNames(e)) ∧ Direct(mp) = TRUE ∧ Direct(e) = FALSE&#10;&#9;⇒ (∀child · child ∈ dom(EntityNames) ∧ mp ∈ dom(EntityNames(child)) ⇒ Direct(child) = FALSE)"/>
<org.eventb.core.invariant name="_TA8Fs1CKEeW7pIdunj-aTw" org.eventb.core.label="Direct6" org.eventb.core.predicate="∀e, p · e ∈ dom(EntityNames) ∧ p ∈ dom(EntityNames(e)) ∧ Direct(e) = FALSE&#10;&#9;⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {p} = E ∪ {Root} ∧ EntityMP(e) ∈ E ∪ {Root})"/>
<org.eventb.core.invariant name="_TA8FtFCKEeW7pIdunj-aTw" org.eventb.core.label="Direct7" org.eventb.core.predicate="Direct(Root) = TRUE"/>
<org.eventb.core.invariant name="_TA8FtVCKEeW7pIdunj-aTw" org.eventb.core.label="Direct8" org.eventb.core.predicate="∀e, a, r · e ∈ Entities ∧ Direct(e) = FALSE ∧ r ∈ Roles ∧ a ∈ AccessRights ∧ e ↦ a ∈ RoleRights(r)&#10;&#9;⇒ EntityMP(e) ↦ a ∈ RoleRights(r)"/>
<org.eventb.core.invariant name="_qdZeMFCMEeW7pIdunj-aTw" org.eventb.core.label="Direct9" org.eventb.core.predicate="∀e, a, r · e ∈ Entities ∧ Direct(e) = FALSE ∧ r ∈ Roles ∧ a ∈ AccessRights ∧ EntityMP(e) ↦ a ∈ RoleRights(r)&#10;&#9;⇒ e ↦ a ∈ RoleRights(r)"/>
<org.eventb.core.invariant name="_qdZeMVCMEeW7pIdunj-aTw" org.eventb.core.label="Direct10" org.eventb.core.predicate="∀e, p · e ∈ dom(EntityNames) ∧ p ∈ dom(EntityNames(e)) ∧ Direct(e) = FALSE ∧ Direct(p) = FALSE&#10;&#9;⇒ EntityMP(e) = EntityMP(p)"/>
<org.eventb.core.invariant name="_qdaFQFCMEeW7pIdunj-aTw" org.eventb.core.label="Direct11" org.eventb.core.predicate="∀e, p · e ∈ dom(EntityNames) ∧ p ∈ dom(EntityNames(e)) ∧ Direct(e) = FALSE ∧ Direct(p) = TRUE&#10;&#9;⇒ EntityMP(e) = p"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU=" org.eventb.core.comment="&#10;" org.eventb.core.label="Direct12" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ Direct(r) = TRUE"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU`" org.eventb.core.label="UserAdmRole1" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ RParents(UserAdmRole(u)) = ∅"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUa" org.eventb.core.label="UserAdmRole2" org.eventb.core.predicate="∀u, r · u ∈ UserAccs ∧ r ∈ Roles ⇒ UserAdmRole(u) ∉ RParents(r)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUb" org.eventb.core.label="UserAdmRole3" org.eventb.core.predicate="∀u1, u2 · u1 ∈ UserAccs ∧ u2 ∈ UserAccs ∧ u1 ≠ u2 ⇒ UserAdmRole(u1) ≠ UserAdmRole(u2)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUc" org.eventb.core.label="UserAdmRole4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ UserAdmRole(u) ∉ SpecialAdmRoles"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUd" org.eventb.core.label="UserAdmRole5" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ UserAdmRole(u) ↦ Read ∈ RoleAdmRights(UserAdmRole(u))"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUe" org.eventb.core.comment="&#10;" org.eventb.core.label="UserAdmRole6" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ UserAdmRole(u) ↦ Write ∈ RoleAdmRights(UserAdmRole(u))"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aU@" org.eventb.core.label="UserOrdRole1" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ RParents(UserOrdRole(u)) = ∅"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUA" org.eventb.core.label="UserOrdRole2" org.eventb.core.predicate="∀u, r · u ∈ UserAccs ∧ r ∈ Roles ⇒ UserOrdRole(u) ∉ RParents(r)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUB" org.eventb.core.label="UserOrdRole3" org.eventb.core.predicate="∀u1, u2 · u1 ∈ UserAccs ∧ u2 ∈ UserAccs ∧ u1 ≠ u2 ⇒ UserOrdRole(u1) ≠ UserOrdRole(u2)"/>
<org.eventb.core.event name="_RVPPgFCjEeW7pIdunj-aTw" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_user">
<org.eventb.core.parameter name="_RVPPgVCjEeW7pIdunj-aTw" org.eventb.core.identifier="user"/>
<org.eventb.core.parameter name="_aeGRcFCjEeW7pIdunj-aTw" org.eventb.core.identifier="subject"/>
<org.eventb.core.guard name="_RVPPglCjEeW7pIdunj-aTw" org.eventb.core.label="grd1" org.eventb.core.predicate="user ∈ Union ∖ CurrUnion"/>
<org.eventb.core.guard name="_iEhQQFCjEeW7pIdunj-aTw" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_lmgwUFCjEeW7pIdunj-aTw" org.eventb.core.label="grd3" org.eventb.core.predicate="UsersAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_qvRZ4FCjEeW7pIdunj-aTw" org.eventb.core.label="grd4" org.eventb.core.predicate="RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_qvRZ4VCjEeW7pIdunj-aTw" org.eventb.core.label="grd5" org.eventb.core.predicate="RolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_qvRZ4lCjEeW7pIdunj-aTw" org.eventb.core.label="grd6" org.eventb.core.predicate="ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_qvRZ41CjEeW7pIdunj-aTw" org.eventb.core.label="grd7" org.eventb.core.predicate="ARolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.action name="_7GCXgFCkEeW7pIdunj-aTw" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∪ {user} ∪ roles" org.eventb.core.label="act1"/>
<org.eventb.core.parameter name="_YHGpAFFgEeWYId--u_wVCw" org.eventb.core.identifier="userOrdRole"/>
<org.eventb.core.parameter name="_Z8hSgFFgEeWYId--u_wVCw" org.eventb.core.identifier="userAdmRole"/>
<org.eventb.core.action name="_8tTFsFCjEeW7pIdunj-aTw" org.eventb.core.assignment="UserAccs ≔ UserAccs ∪ {user}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD6" org.eventb.core.assignment="Roles ≔ Roles ∪ roles" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD7" org.eventb.core.assignment="OrdRoles ≔ OrdRoles ∪ {userOrdRole}" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD8" org.eventb.core.assignment="AdmRoles ≔ AdmRoles ∪ {userAdmRole}" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_0o6coFFgEeWYId--u_wVCw" org.eventb.core.assignment="UserOrdRole(user) ≔ userOrdRole" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_2UYf8FFgEeWYId--u_wVCw" org.eventb.core.assignment="UserAdmRole(user) ≔ userAdmRole" org.eventb.core.label="act7"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVCy" org.eventb.core.label="grd8" org.eventb.core.predicate="userOrdRole ∈ (Union ∖ CurrUnion) ∖ {user}"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVCz" org.eventb.core.label="grd9" org.eventb.core.predicate="userAdmRole ∈ (Union ∖ CurrUnion) ∖ {user}"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDF" org.eventb.core.label="grd10" org.eventb.core.predicate="partition(roles, {userOrdRole}, {userAdmRole})"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVD4" org.eventb.core.label="grd11" org.eventb.core.predicate="roleAdmRights ∈ AdmRoles ∪ {userAdmRole} → (Roles ∪ roles ↔ AccessRights)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVD5" org.eventb.core.label="grd12" org.eventb.core.predicate="∀r1, ar, r2 · r1 ∈ Roles ∧ r2 ∈ AdmRoles ∧ ar ∈ AccessRights ∧ r1 ↦ ar ∈ RoleAdmRights(r2)&#10;&#9;⇒ r1 ↦ ar ∈ roleAdmRights(r2)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVD:" org.eventb.core.label="grd13" org.eventb.core.predicate="∀r1, ar, r2 · r1 ∈ Roles ∧ r2 ∈ AdmRoles ∧ ar ∈ AccessRights ∧ r1 ↦ ar ∈ roleAdmRights(r2)&#10;&#9;⇒ r1 ↦ ar ∈ RoleAdmRights(r2)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVD;" org.eventb.core.label="grd14" org.eventb.core.predicate="userAdmRole ↦ Own ∈ roleAdmRights(ARolesAR)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDV" org.eventb.core.label="grd15" org.eventb.core.predicate="userAdmRole ↦ Own ∉ roleAdmRights(RolesAR)"/>
<org.eventb.core.guard name="_I8AF4FFiEeWYId--u_wVCw" org.eventb.core.label="grd16" org.eventb.core.predicate="userOrdRole ↦ Own ∈ roleAdmRights(RolesAR)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDW" org.eventb.core.label="grd17" org.eventb.core.predicate="userOrdRole ↦ Own ∉ roleAdmRights(ARolesAR)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVCx" org.eventb.core.label="grd18" org.eventb.core.predicate="∀ar, r · ar ∈ AdmRoles ∖ {RolesAR, ARolesAR} ∧ r ∈ roles&#10;&#9;⇒ r ↦ Own ∉ roleAdmRights(ar)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDH" org.eventb.core.label="grd19" org.eventb.core.predicate="∀r · r ∈ Roles ∪ roles ⇒ r ↦ Own ∉ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDJ" org.eventb.core.label="grd20" org.eventb.core.predicate="∀r · r ∈ Roles ∪ roles ⇒ r ↦ Execute ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDK" org.eventb.core.label="grd21" org.eventb.core.predicate="∀r, ar · r ∈ roles ∧ ar ∈ AdmRoles ⇒ r ↦ Execute ∈ roleAdmRights(ar)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDL" org.eventb.core.label="grd22" org.eventb.core.predicate="∀r · r ∈ Roles ∧ r ≠ CommonRole ⇒ r ↦ Read ∉ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDM" org.eventb.core.label="grd23" org.eventb.core.predicate="∀r · r ∈ Roles ∧ r ≠ CommonRole ⇒ r ↦ Write ∉ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_bw9GwFFvEeWYId--u_wVCw" org.eventb.core.label="grd24" org.eventb.core.predicate="∀r, ar · r ∈ roles ∧ ar ∈ AdmRoles ⇒ r ↦ Read ∉ roleAdmRights(ar)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDN" org.eventb.core.label="grd25" org.eventb.core.predicate="∀r, ar · r ∈ roles ∧ ar ∈ AdmRoles ⇒ r ↦ Write ∉ roleAdmRights(ar)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDX" org.eventb.core.label="grd26" org.eventb.core.predicate="userOrdRole ↦ Read ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_idSb4FFvEeWYId--u_wVCw" org.eventb.core.label="grd27" org.eventb.core.predicate="userAdmRole ↦ Read ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVD(" org.eventb.core.label="grd28" org.eventb.core.predicate="CommonRole ↦ Read ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVD'" org.eventb.core.label="grd29" org.eventb.core.predicate="userOrdRole ↦ Write ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_idSb4VFvEeWYId--u_wVCw" org.eventb.core.label="grd30" org.eventb.core.predicate="userAdmRole ↦ Write ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.guard name="_o4-F4FFvEeWYId--u_wVCw" org.eventb.core.label="grd31" org.eventb.core.predicate="CommonRole ↦ Write ∈ roleAdmRights(userAdmRole)"/>
<org.eventb.core.parameter name="_x5TJ0FFiEeWYId--u_wVDE" org.eventb.core.identifier="roles"/>
<org.eventb.core.parameter name="_x5TJ0FFiEeWYId--u_wVD9" org.eventb.core.identifier="roleAdmRights"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD=" org.eventb.core.assignment="RoleAdmRights ≔ roleAdmRights" org.eventb.core.label="act8"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD&gt;" org.eventb.core.assignment="RoleRights ≔ RoleRights ∪ roleRights" org.eventb.core.label="act9"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD@" org.eventb.core.assignment="Direct ≔ Direct ∪ {x ↦ y ∣ x ∈ roles ∧ y = TRUE}" org.eventb.core.label="act10"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVD?" org.eventb.core.assignment="Shared ≔ Shared ∪ {x ↦ y ∣ x ∈ roles ∧ y = TRUE}" org.eventb.core.label="act11"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVDA" org.eventb.core.assignment="RoleName ≔ RoleName ∪ roleName" org.eventb.core.label="act12"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDB" org.eventb.core.label="grd32" org.eventb.core.predicate="roleName ∈ roles → Names"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDC" org.eventb.core.label="grd33" org.eventb.core.predicate="roleName(userOrdRole) ≠ roleName(userAdmRole)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDD" org.eventb.core.label="grd34" org.eventb.core.predicate="∀r1, r2 · r1 ∈ roles ∧ r2 ∈ Roles ⇒ roleName(r1) ≠ RoleName(r2)"/>
<org.eventb.core.action name="_x5TJ0FFiEeWYId--u_wVDG" org.eventb.core.assignment="RParents ≔ RParents ∪ rParents" org.eventb.core.label="act13"/>
<org.eventb.core.parameter name="_x5TJ0FFiEeWYId--u_wVDO" org.eventb.core.identifier="roleName"/>
<org.eventb.core.parameter name="_x5TJ0FFiEeWYId--u_wVDP" org.eventb.core.identifier="roleRights"/>
<org.eventb.core.parameter name="_x5TJ0FFiEeWYId--u_wVDQ" org.eventb.core.identifier="rParents"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDR" org.eventb.core.label="grd35" org.eventb.core.predicate="roleRights ∈ roles → (Entities ↔ AccessRights)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDS" org.eventb.core.label="grd36" org.eventb.core.predicate="∀r · r ∈ roles ⇒ roleRights(r) = ∅"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDT" org.eventb.core.label="grd37" org.eventb.core.predicate="rParents ∈ roles → ℙ(roles)"/>
<org.eventb.core.guard name="_x5TJ0FFiEeWYId--u_wVDU" org.eventb.core.label="grd38" org.eventb.core.predicate="∀r · r ∈ roles ⇒ rParents(r) = ∅"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt1" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="get_user_attr">
<org.eventb.core.parameter name="'" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="(" org.eventb.core.identifier="user"/>
<org.eventb.core.parameter name=")" org.eventb.core.identifier="object"/>
<org.eventb.core.guard name="*" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="+" org.eventb.core.label="grd2" org.eventb.core.predicate="user ∈ UserAccs"/>
<org.eventb.core.guard name="," org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="-" org.eventb.core.label="grd4" org.eventb.core.predicate="object ↦ WriteA ∈ SubjectAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.variable name="_zopGAE_tEeW7pIdunj-aUq" org.eventb.core.comment="Function. Stores an individual administrative role of each user account." org.eventb.core.identifier="UserAdmRole"/>
<org.eventb.core.variable name="_oykSUGEaEeWoCLs0HEMUPA" org.eventb.core.comment="Function. Stores an individual ordinary role of each user account." org.eventb.core.identifier="UserOrdRole"/>
<org.eventb.core.invariant name="_EbUXAGEbEeWoCLs0HEMUPA" org.eventb.core.label="UserOrdRole4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ UserOrdRole(u) ↦ Read ∈ RoleAdmRights(UserAdmRole(u))"/>
<org.eventb.core.invariant name="_EbUXAWEbEeWoCLs0HEMUPA" org.eventb.core.comment="&#10;" org.eventb.core.label="UserOrdRole5" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ UserOrdRole(u) ↦ Write ∈ RoleAdmRights(UserAdmRole(u))"/>
<org.eventb.core.invariant name="_EbUXA2EbEeWoCLs0HEMUPA" org.eventb.core.label="CommonRole1" org.eventb.core.predicate="RParents(CommonRole) = ∅"/>
<org.eventb.core.invariant name="_EbU-EGEbEeWoCLs0HEMUPA" org.eventb.core.label="CommonRole2" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ CommonRole ∉ RParents(r)"/>
<org.eventb.core.invariant name="_zopGAE_tEeW7pIdunj-aUD" org.eventb.core.label="CommonRole3" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ CommonRole ≠ UserOrdRole(u)"/>
<org.eventb.core.invariant name="_z13SwGE9EeWoCLs0HEMUPA" org.eventb.core.label="CommonRole4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ CommonRole ↦ Read ∈ RoleAdmRights(UserAdmRole(u))"/>
<org.eventb.core.invariant name="_z13SwWE9EeWoCLs0HEMUPA" org.eventb.core.label="CommonRole5" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ CommonRole ↦ Write ∈ RoleAdmRights(UserAdmRole(u))"/>
<org.eventb.core.event name="_YgsNMGFEEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_user">
<org.eventb.core.parameter name="_Ygs0RmFEEeWoCLs0HEMUPA" org.eventb.core.identifier="user"/>
<org.eventb.core.parameter name="_Ygs0R2FEEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.action name="_YgvQgmFEEeWoCLs0HEMUPA" org.eventb.core.assignment="CurrUnion ≔ (CurrUnion ∖ {user}) ∖ roles" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_YgvQg2FEEeWoCLs0HEMUPA" org.eventb.core.assignment="UserAccs ≔ UserAccs ∖ {user}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPB" org.eventb.core.assignment="Roles ≔ Roles ∖ roles" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPC" org.eventb.core.assignment="AdmRoles ≔ AdmRoles ∖ {UserAdmRole(user)}" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPD" org.eventb.core.assignment="OrdRoles ≔ OrdRoles ∖ {UserOrdRole(user)}" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_YgvQhWFEEeWoCLs0HEMUPA" org.eventb.core.assignment="UserAdmRole ≔ {user} ⩤ UserAdmRole" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPA" org.eventb.core.assignment="UserOrdRole ≔ {user} ⩤ UserOrdRole" org.eventb.core.label="act7"/>
<org.eventb.core.guard name="_2orFtWFKEeWoCLs0HEMUPA" org.eventb.core.label="grd1" org.eventb.core.predicate="user ∈ UserAccs"/>
<org.eventb.core.guard name="_2orFtmFKEeWoCLs0HEMUPA" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_2orFt2FKEeWoCLs0HEMUPA" org.eventb.core.label="grd3" org.eventb.core.predicate="∀s · s ∈ Subjects ⇒ SubjectUser(s) ≠ user"/>
<org.eventb.core.guard name="_2orFuGFKEeWoCLs0HEMUPA" org.eventb.core.label="grd4" org.eventb.core.predicate="UsersAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_2orFuWFKEeWoCLs0HEMUPA" org.eventb.core.label="grd5" org.eventb.core.predicate="RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_2orFu2FKEeWoCLs0HEMUPA" org.eventb.core.label="grd6" org.eventb.core.predicate="ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.parameter name="_YgvQhmFEEeWoCLs0HEMUPE" org.eventb.core.identifier="roles"/>
<org.eventb.core.guard name="_YgvQhmFEEeWoCLs0HEMUPF" org.eventb.core.label="grd7" org.eventb.core.predicate="roles = {UserAdmRole(user), UserOrdRole(user)}"/>
<org.eventb.core.guard name="grd1" org.eventb.core.label="grd8" org.eventb.core.predicate="subjectAdmAccesses ∈ Subjects → (Roles ∖ roles ↔ Accesses)"/>
<org.eventb.core.guard name="grd2" org.eventb.core.label="grd9" org.eventb.core.predicate="∀s · s ∈ Subjects ⇒ subjectAdmAccesses(s) = roles ⩤ SubjectAdmAccesses(s)"/>
<org.eventb.core.guard name="_YgvQhmFEEeWoCLs0HEMUPP" org.eventb.core.label="grd10" org.eventb.core.predicate="rParents ∈ Roles ∖ roles → ℙ(Roles ∖ roles)"/>
<org.eventb.core.guard name="_YgvQhmFEEeWoCLs0HEMUPQ" org.eventb.core.label="grd11" org.eventb.core.predicate="∀r · r ∈ Roles ∧ r ∉ roles ⇒ rParents(r) = RParents(r) ∖ roles"/>
<org.eventb.core.guard name="grd3" org.eventb.core.label="grd12" org.eventb.core.predicate="roleAdmRights ∈ AdmRoles ∖ roles → (Roles ∖ roles ↔ AccessRights)"/>
<org.eventb.core.guard name="grd4" org.eventb.core.label="grd13" org.eventb.core.predicate="∀r · r ∈ AdmRoles ∧ r ∉ roles ⇒ roleAdmRights(r) = roles ⩤ RoleAdmRights(r)"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPG" org.eventb.core.assignment="RoleRights ≔ roles ⩤ RoleRights" org.eventb.core.label="act8"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPH" org.eventb.core.assignment="RoleName ≔ roles ⩤ RoleName" org.eventb.core.label="act9"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPI" org.eventb.core.assignment="SubjectOwner ≔ SubjectOwner ⩥ roles" org.eventb.core.label="act10"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPJ" org.eventb.core.assignment="Shared ≔ roles ⩤ Shared" org.eventb.core.label="act11"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPK" org.eventb.core.assignment="SubjectAdmAccesses ≔ subjectAdmAccesses" org.eventb.core.label="act12"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPL" org.eventb.core.assignment="RParents ≔ rParents" org.eventb.core.label="act13"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPM" org.eventb.core.assignment="RoleAdmRights ≔ roleAdmRights" org.eventb.core.label="act14"/>
<org.eventb.core.parameter name="_YgvQhmFEEeWoCLs0HEMUPN" org.eventb.core.identifier="subjectAdmAccesses"/>
<org.eventb.core.parameter name="_YgvQhmFEEeWoCLs0HEMUPO" org.eventb.core.identifier="rParents"/>
<org.eventb.core.parameter name="_YgvQhmFEEeWoCLs0HEMUPR" org.eventb.core.identifier="roleAdmRights"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPS" org.eventb.core.assignment="Direct ≔ roles ⩤ Direct" org.eventb.core.label="act15"/>
<org.eventb.core.action name="_YgvQhmFEEeWoCLs0HEMUPT" org.eventb.core.assignment="SubjectUser ≔ SubjectUser ⩥ {user}" org.eventb.core.label="act16"/>
</org.eventb.core.event>
<org.eventb.core.event name="_2op3kGFKEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_object">
<org.eventb.core.parameter name="_2oqeo2FKEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_2oqepGFKEeWoCLs0HEMUPA" org.eventb.core.identifier="object"/>
<org.eventb.core.parameter name="_2oqepWFKEeWoCLs0HEMUPA" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_2oqepmFKEeWoCLs0HEMUPA" org.eventb.core.identifier="name"/>
<org.eventb.core.parameter name="_2oqep2FKEeWoCLs0HEMUPA" org.eventb.core.identifier="role"/>
<org.eventb.core.action name="_2os65GFKEeWoCLs0HEMUPA" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∪ {object}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_2os65WFKEeWoCLs0HEMUPA" org.eventb.core.assignment="Entities ≔ Entities ∪ {object}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_2os65mFKEeWoCLs0HEMUPA" org.eventb.core.assignment="Objects ≔ Objects ∪ {object}" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_2os652FKEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityNames(object) ≔ {parent ↦ name}" org.eventb.core.label="act4"/>
<org.eventb.core.parameter name="_McQRUWFMEeWoCLs0HEMUPA" org.eventb.core.identifier="dLabel"/>
<org.eventb.core.guard name="_McQ4aWFMEeWoCLs0HEMUPA" org.eventb.core.label="grd1" org.eventb.core.predicate="object ∈ Union ∖ CurrUnion"/>
<org.eventb.core.parameter name="_McQRUmFMEeWoCLs0HEMUPA" org.eventb.core.identifier="mountPoint"/>
<org.eventb.core.guard name="_McQ4amFMEeWoCLs0HEMUPA" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_McQ4a2FMEeWoCLs0HEMUPA" org.eventb.core.label="grd3" org.eventb.core.predicate="parent ∈ Containers"/>
<org.eventb.core.guard name="_McQ4bGFMEeWoCLs0HEMUPA" org.eventb.core.label="grd4" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="_McQ4bWFMEeWoCLs0HEMUPA" org.eventb.core.label="grd5" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ parent ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_McQ4bmFMEeWoCLs0HEMUPA" org.eventb.core.label="grd6" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.guard name="_McQ4b2FMEeWoCLs0HEMUPA" org.eventb.core.label="grd7" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ⇒ parent ↦ name ∉ EntityNames(e)"/>
<org.eventb.core.guard name="_McQ4cWFMEeWoCLs0HEMUPA" org.eventb.core.label="grd8" org.eventb.core.predicate="role = UserOrdRole(SubjectUser(subject))"/>
<org.eventb.core.parameter name="_McQRU2FMEeWoCLs0HEMUPA" org.eventb.core.identifier="roleRights"/>
<org.eventb.core.parameter name="_McQ4YGFMEeWoCLs0HEMUPA" org.eventb.core.identifier="depth"/>
<org.eventb.core.guard name="_KeIs4mFOEeWoCLs0HEMUPA" org.eventb.core.label="grd9" org.eventb.core.predicate="role ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_KeIs42FOEeWoCLs0HEMUPA" org.eventb.core.label="grd10" org.eventb.core.predicate="mountPoint ∈ Containers"/>
<org.eventb.core.guard name="_KeIs5GFOEeWoCLs0HEMUPA" org.eventb.core.label="grd11" org.eventb.core.predicate="dLabel ∈ BOOL"/>
<org.eventb.core.guard name="_KeIs5WFOEeWoCLs0HEMUPA" org.eventb.core.label="grd12" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ∧ parent ∈ dom(EntityNames(e)) ⇒ Direct(e) = dLabel"/>
<org.eventb.core.guard name="_KeJT-GFOEeWoCLs0HEMUPA" org.eventb.core.label="grd13" org.eventb.core.predicate="dLabel = TRUE ⇒ Direct(parent) = TRUE"/>
<org.eventb.core.guard name="_KeJT-WFOEeWoCLs0HEMUPA" org.eventb.core.label="grd14" org.eventb.core.predicate="dLabel = TRUE ⇒ mountPoint = Root"/>
<org.eventb.core.guard name="_KeJT-mFOEeWoCLs0HEMUPA" org.eventb.core.label="grd15" org.eventb.core.predicate="dLabel = FALSE ∧ Direct(parent) = FALSE ⇒ mountPoint = EntityMP(parent)"/>
<org.eventb.core.guard name="_KeJT-2FOEeWoCLs0HEMUPA" org.eventb.core.label="grd16" org.eventb.core.predicate="dLabel = FALSE ∧ Direct(parent) = TRUE ⇒ mountPoint = parent"/>
<org.eventb.core.guard name="_KeJT_GFOEeWoCLs0HEMUPA" org.eventb.core.label="grd17" org.eventb.core.predicate="roleRights ∈ Roles → (Entities ∪ {object} ↔ AccessRights)"/>
<org.eventb.core.guard name="_KeJT_WFOEeWoCLs0HEMUPA" org.eventb.core.label="grd18" org.eventb.core.predicate="∀e, a, r · e ∈ Entities ∧ a ∈ AccessRights ∧ r ∈ Roles ⇒ (e ↦ a ∈ roleRights(r) ⇔ e ↦ a ∈ RoleRights(r))"/>
<org.eventb.core.guard name="_KeJT_mFOEeWoCLs0HEMUPA" org.eventb.core.label="grd19" org.eventb.core.predicate="dLabel = TRUE ⇒ object ↦ Own ∈ roleRights(role)"/>
<org.eventb.core.action name="_2os66GFKEeWoCLs0HEMUPA" org.eventb.core.assignment="RoleRights ≔ roleRights" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_2oth8GFKEeWoCLs0HEMUPA" org.eventb.core.assignment="Direct(object) ≔ dLabel" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_2oth8WFKEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityMP(object) ≔ mountPoint" org.eventb.core.label="act7"/>
<org.eventb.core.guard name="_KeJT_2FOEeWoCLs0HEMUPA" org.eventb.core.label="grd20" org.eventb.core.predicate="dLabel = TRUE ⇒ (∀a, r · a ∈ AccessRights ∧ r ∈ Roles ∧ object ↦ a ∈ roleRights(r) ⇒ a = Own ∧ r = role)"/>
<org.eventb.core.guard name="_KeJUAGFOEeWoCLs0HEMUPA" org.eventb.core.label="grd21" org.eventb.core.predicate="dLabel = FALSE ⇒ (∀a, r · a ∈ AccessRights ∧ r ∈ Roles ⇒ (mountPoint ↦ a ∈ RoleRights(r) ⇔ object ↦ a ∈ roleRights(r)))"/>
<org.eventb.core.guard name="_KeIs52FOEeWoCLs0HEMUPA" org.eventb.core.label="grd22" org.eventb.core.predicate="depth ∈ ℕ → ℙ(Containers)"/>
<org.eventb.core.guard name="_KeIs6GFOEeWoCLs0HEMUPA" org.eventb.core.label="grd23" org.eventb.core.predicate="∀c · c ∈ Containers ⇒ (∃i · i ∈ ℕ ∧ c ∈ depth(i))"/>
<org.eventb.core.guard name="_KeJT9mFOEeWoCLs0HEMUPA" org.eventb.core.label="grd24" org.eventb.core.predicate="depth(0) = {Root}"/>
<org.eventb.core.guard name="_KeIs5mFOEeWoCLs0HEMUPA" org.eventb.core.label="grd25" org.eventb.core.predicate="∀i · i ∈ ℕ ∧ i ≠ 0 ⇒ (∀c · c ∈ depth(i) ⇒ c ≠ Root)"/>
<org.eventb.core.guard name="_McQ4cGFMEeWoCLs0HEMUPA" org.eventb.core.label="grd26" org.eventb.core.predicate="∀i · i ∈ ℕ ⇒ (∀c · c ∈ depth(i + 1) ⇒ (∃p · p ∈ depth(i) ∧ p = Parent(c)))"/>
<org.eventb.core.guard name="_obg0sGFQEeWoCLs0HEMUPA" org.eventb.core.label="grd27" org.eventb.core.predicate="∀i · i ∈ ℕ ∧ (∀c · c ∈ depth(i) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))&#10;&#9;⇒ (∀c · c ∈ depth(i + 1) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))" org.eventb.core.theorem="true"/>
<org.eventb.core.guard name="_obg0sWFQEeWoCLs0HEMUPA" org.eventb.core.label="grd28" org.eventb.core.predicate="∀i · i ∈ ℕ ⇒ (∀c · c ∈ depth(i) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))" org.eventb.core.theorem="true"/>
</org.eventb.core.event>
<org.eventb.core.event name="_McQRUGFMEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_container">
<org.eventb.core.parameter name="_McQ4YWFMEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_McQ4YmFMEeWoCLs0HEMUPA" org.eventb.core.identifier="container"/>
<org.eventb.core.parameter name="_KeIs4GFOEeWoCLs0HEMUPA" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_KeIs4WFOEeWoCLs0HEMUPA" org.eventb.core.identifier="name"/>
<org.eventb.core.parameter name="_KeJT8GFOEeWoCLs0HEMUPA" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_KeJT8WFOEeWoCLs0HEMUPA" org.eventb.core.identifier="dLabel"/>
<org.eventb.core.parameter name="_KeJT8mFOEeWoCLs0HEMUPA" org.eventb.core.identifier="mountPoint"/>
<org.eventb.core.parameter name="_KeJT82FOEeWoCLs0HEMUPA" org.eventb.core.identifier="roleRights"/>
<org.eventb.core.parameter name="_KeJT9GFOEeWoCLs0HEMUPA" org.eventb.core.identifier="depth"/>
<org.eventb.core.guard name="_obhbwGFQEeWoCLs0HEMUPA" org.eventb.core.label="grd1" org.eventb.core.predicate="container ∈ Union ∖ CurrUnion"/>
<org.eventb.core.guard name="_obhbwWFQEeWoCLs0HEMUPA" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_KeIs6WFOEeWoCLs0HEMUPA" org.eventb.core.label="grd3" org.eventb.core.predicate="parent ∈ Containers"/>
<org.eventb.core.guard name="_KeIs6mFOEeWoCLs0HEMUPA" org.eventb.core.label="grd4" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="_KeIs62FOEeWoCLs0HEMUPA" org.eventb.core.label="grd5" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ parent ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_KeJT92FOEeWoCLs0HEMUPA" org.eventb.core.label="grd6" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.guard name="_obhbzGFQEeWoCLs0HEMUPA" org.eventb.core.label="grd7" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ⇒ parent ↦ name ∉ EntityNames(e)"/>
<org.eventb.core.guard name="_obiC1mFQEeWoCLs0HEMUPB" org.eventb.core.label="grd8" org.eventb.core.predicate="role = UserOrdRole(SubjectUser(subject))"/>
<org.eventb.core.guard name="_obhbz2FQEeWoCLs0HEMUPA" org.eventb.core.label="grd9" org.eventb.core.predicate="role ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_obhb0GFQEeWoCLs0HEMUPA" org.eventb.core.label="grd10" org.eventb.core.predicate="mountPoint ∈ Containers"/>
<org.eventb.core.guard name="_obiC0GFQEeWoCLs0HEMUPA" org.eventb.core.label="grd11" org.eventb.core.predicate="dLabel ∈ BOOL"/>
<org.eventb.core.guard name="_obiC0WFQEeWoCLs0HEMUPA" org.eventb.core.label="grd12" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ∧ parent ∈ dom(EntityNames(e)) ⇒ Direct(e) = dLabel"/>
<org.eventb.core.guard name="_obiC0mFQEeWoCLs0HEMUPA" org.eventb.core.label="grd13" org.eventb.core.predicate="dLabel = TRUE ⇒ Direct(parent) = TRUE"/>
<org.eventb.core.guard name="_obiC02FQEeWoCLs0HEMUPA" org.eventb.core.label="grd14" org.eventb.core.predicate="dLabel = TRUE ⇒ mountPoint = Root"/>
<org.eventb.core.guard name="_obiC1GFQEeWoCLs0HEMUPA" org.eventb.core.label="grd15" org.eventb.core.predicate="dLabel = FALSE ∧ Direct(parent) = FALSE ⇒ mountPoint = EntityMP(parent)"/>
<org.eventb.core.guard name="_obiC1WFQEeWoCLs0HEMUPA" org.eventb.core.label="grd16" org.eventb.core.predicate="dLabel = FALSE ∧ Direct(parent) = TRUE ⇒ mountPoint = parent"/>
<org.eventb.core.guard name="_obiC1mFQEeWoCLs0HEMUPA" org.eventb.core.label="grd17" org.eventb.core.predicate="roleRights ∈ Roles → (Entities ∪ {container} ↔ AccessRights)"/>
<org.eventb.core.guard name="_obhbwmFQEeWoCLs0HEMUPA" org.eventb.core.label="grd18" org.eventb.core.predicate="∀e, a, r · e ∈ Entities ∧ a ∈ AccessRights ∧ r ∈ Roles ⇒ (e ↦ a ∈ roleRights(r) ⇔ e ↦ a ∈ RoleRights(r))"/>
<org.eventb.core.guard name="_obhbw2FQEeWoCLs0HEMUPA" org.eventb.core.label="grd19" org.eventb.core.predicate="dLabel = TRUE ⇒ container ↦ Own ∈ roleRights(role)"/>
<org.eventb.core.action name="_2oth8mFKEeWoCLs0HEMUPA" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∪ {container}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_McRfd2FMEeWoCLs0HEMUPA" org.eventb.core.assignment="Entities ≔ Entities ∪ {container}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_McRfeGFMEeWoCLs0HEMUPA" org.eventb.core.assignment="Containers ≔ Containers ∪ {container}" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_McRfeWFMEeWoCLs0HEMUPA" org.eventb.core.assignment="Shared(container) ≔ FALSE" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_McSGgGFMEeWoCLs0HEMUPA" org.eventb.core.assignment="Parent(container) ≔ parent" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_McSGgWFMEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityNames(container) ≔ {parent ↦ name}" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_McSGgmFMEeWoCLs0HEMUPA" org.eventb.core.assignment="RoleRights ≔ roleRights" org.eventb.core.label="act7"/>
<org.eventb.core.action name="_McSGg2FMEeWoCLs0HEMUPA" org.eventb.core.assignment="Direct(container) ≔ dLabel" org.eventb.core.label="act8"/>
<org.eventb.core.action name="_KeJ7BGFOEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityMP(container) ≔ mountPoint" org.eventb.core.label="act9"/>
<org.eventb.core.guard name="_obhbxGFQEeWoCLs0HEMUPA" org.eventb.core.label="grd20" org.eventb.core.predicate="dLabel = TRUE ⇒ (∀a, r · a ∈ AccessRights ∧ r ∈ Roles ∧ container ↦ a ∈ roleRights(r) ⇒ a = Own ∧ r = role)"/>
<org.eventb.core.guard name="_KeIs7GFOEeWoCLs0HEMUPA" org.eventb.core.label="grd21" org.eventb.core.predicate="dLabel = FALSE ⇒ (∀a, r · a ∈ AccessRights ∧ r ∈ Roles ⇒ (mountPoint ↦ a ∈ RoleRights(r) ⇔ container ↦ a ∈ roleRights(r)))"/>
<org.eventb.core.guard name="_KA7aNGFTEeWoCLs0HEMUPA" org.eventb.core.label="grd22" org.eventb.core.predicate="depth ∈ ℕ → ℙ(Containers)"/>
<org.eventb.core.guard name="_KA7aNWFTEeWoCLs0HEMUPA" org.eventb.core.label="grd23" org.eventb.core.predicate="∀c · c ∈ Containers ⇒ (∃i · i ∈ ℕ ∧ c ∈ depth(i))"/>
<org.eventb.core.guard name="_KA7aNmFTEeWoCLs0HEMUPA" org.eventb.core.label="grd24" org.eventb.core.predicate="depth(0) = {Root}"/>
<org.eventb.core.guard name="_KA7aN2FTEeWoCLs0HEMUPA" org.eventb.core.label="grd25" org.eventb.core.predicate="∀i · i ∈ ℕ ∧ i ≠ 0 ⇒ (∀c · c ∈ depth(i) ⇒ c ≠ Root)"/>
<org.eventb.core.guard name="_KA7aOGFTEeWoCLs0HEMUPA" org.eventb.core.label="grd26" org.eventb.core.predicate="∀i · i ∈ ℕ ⇒ (∀c · c ∈ depth(i + 1) ⇒ (∃p · p ∈ depth(i) ∧ p = Parent(c)))"/>
<org.eventb.core.guard name="_KA7aOWFTEeWoCLs0HEMUPA" org.eventb.core.label="grd27" org.eventb.core.predicate="∀i · i ∈ ℕ ∧ (∀c · c ∈ depth(i) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))&#10;&#9;⇒ (∀c · c ∈ depth(i + 1) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))" org.eventb.core.theorem="true"/>
<org.eventb.core.guard name="_KA7aOmFTEeWoCLs0HEMUPA" org.eventb.core.label="grd28" org.eventb.core.predicate="∀i · i ∈ ℕ ⇒ (∀c · c ∈ depth(i) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))" org.eventb.core.theorem="true"/>
</org.eventb.core.event>
<org.eventb.core.event name="_zopGAE_tEeW7pIdunj-aU;" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="set_entity_labels">
<org.eventb.core.parameter name="'" org.eventb.core.identifier="roleRights"/>
<org.eventb.core.action name="(" org.eventb.core.assignment="RoleRights ≔ roleRights" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="grd1" org.eventb.core.label="grd1" org.eventb.core.predicate="roleRights ∈ Roles → (Entities ↔ AccessRights)"/>
<org.eventb.core.guard name="grd2" org.eventb.core.label="grd2" org.eventb.core.predicate="∀r1, r2, e · r1 ∈ Roles ∧ r2 ∈ Roles ∧ e ↦ Own ∈ roleRights(r1) ∧ e ↦ Own ∈ roleRights(r2) ⇒ r1=r2"/>
<org.eventb.core.guard name="grd3" org.eventb.core.label="grd3" org.eventb.core.predicate="∀e, a, r · e ∈ Entities ∧ Direct(e) = FALSE ∧ r ∈ Roles ∧ a ∈ AccessRights ∧ e ↦ a ∈ roleRights(r)&#10;&#9;⇒ EntityMP(e) ↦ a ∈ roleRights(r)"/>
<org.eventb.core.guard name="grd4" org.eventb.core.label="grd4" org.eventb.core.predicate="∀e, a, r · e ∈ Entities ∧ Direct(e) = FALSE ∧ r ∈ Roles ∧ a ∈ AccessRights ∧ EntityMP(e) ↦ a ∈ roleRights(r)&#10;&#9;⇒ e ↦ a ∈ roleRights(r)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_KeIF0GFOEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="set_entity_owner">
<org.eventb.core.parameter name="_KeJT9WFOEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_obhbx2FQEeWoCLs0HEMUPA" org.eventb.core.identifier="owner"/>
<org.eventb.core.parameter name="_obhbyGFQEeWoCLs0HEMUPA" org.eventb.core.identifier="oldOwner"/>
<org.eventb.core.parameter name="_obhbyWFQEeWoCLs0HEMUPA" org.eventb.core.identifier="entity"/>
<org.eventb.core.parameter name="_obhbymFQEeWoCLs0HEMUPA" org.eventb.core.identifier="roleRights"/>
<org.eventb.core.guard name="_KA7aO2FTEeWoCLs0HEMUPA" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_KA7aPGFTEeWoCLs0HEMUPA" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_KA7aPWFTEeWoCLs0HEMUPA" org.eventb.core.label="grd3" org.eventb.core.predicate="owner ∈ Roles"/>
<org.eventb.core.guard name="_qYCEY2FTEeWoCLs0HEMUPA" org.eventb.core.label="grd4" org.eventb.core.predicate="oldOwner ∈ Roles"/>
<org.eventb.core.guard name="_qYCEZGFTEeWoCLs0HEMUPA" org.eventb.core.label="grd5" org.eventb.core.predicate="owner ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_qYCEZWFTEeWoCLs0HEMUPA" org.eventb.core.label="grd6" org.eventb.core.predicate="EntitiesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_qYCEZmFTEeWoCLs0HEMUPA" org.eventb.core.label="grd7" org.eventb.core.predicate="(oldOwner ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ oldOwner ↦ WriteA ∈ SubjectAdmAccesses(subject)&#10;&#9;∧ entity ↦ Own ∈ RoleRights(oldOwner))&#10;∨ (∀r · r ∈ Roles ⇒ entity ↦ Own ∉ RoleRights(r))"/>
<org.eventb.core.guard name="_qYCEZ2FTEeWoCLs0HEMUPA" org.eventb.core.label="grd8" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((entity ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(entity)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ entity = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {entity} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
<org.eventb.core.guard name="_qYCEaGFTEeWoCLs0HEMUPA" org.eventb.core.label="grd9" org.eventb.core.predicate="roleRights ∈ Roles → (Entities ↔ AccessRights)"/>
<org.eventb.core.guard name="_ciBhZmFUEeWoCLs0HEMUPA" org.eventb.core.label="grd10" org.eventb.core.predicate="∀r · r ∈ Roles ∧ r ≠ oldOwner ∧ r ≠ owner ⇒ RoleRights(r) = roleRights(r)"/>
<org.eventb.core.action name="_KeJ7BWFOEeWoCLs0HEMUPA" org.eventb.core.assignment="RoleRights ≔ roleRights" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_ciBhZ2FUEeWoCLs0HEMUPA" org.eventb.core.label="grd11" org.eventb.core.predicate="RoleRights(owner) ⊆ roleRights(owner)"/>
<org.eventb.core.guard name="_ciBhaGFUEeWoCLs0HEMUPA" org.eventb.core.label="grd12" org.eventb.core.predicate="roleRights(oldOwner) ⊆ RoleRights(oldOwner)"/>
<org.eventb.core.guard name="_ciBhaWFUEeWoCLs0HEMUPA" org.eventb.core.label="grd13" org.eventb.core.predicate="∀r, e, ar · r ∈ Roles ∧ e ∈ Entities ⇒ (e ↦ ar ∈ roleRights(r) ∧ e ↦ ar ∉ RoleRights(r) ⇔ r = owner ∧ ar = Own)"/>
<org.eventb.core.guard name="_ciBhamFUEeWoCLs0HEMUPA" org.eventb.core.label="grd14" org.eventb.core.predicate="∀r, e, ar · r ∈ Roles ∧ e ∈ Entities ⇒ (e ↦ ar ∉ roleRights(r) ∧ e ↦ ar ∈ RoleRights(r) ⇔ r = owner ∧ ar = Own)"/>
<org.eventb.core.guard name="_ciBha2FUEeWoCLs0HEMUPA" org.eventb.core.label="grd15" org.eventb.core.predicate="Direct(entity) = TRUE"/>
<org.eventb.core.guard name="_ciBhbGFUEeWoCLs0HEMUPA" org.eventb.core.label="grd16" org.eventb.core.predicate="∀e · e ∈ Entities ∧ e ↦ Own ∈ roleRights(owner) ∧ e ↦ Own ∉ RoleRights(owner) ⇒ (e = entity ∨ (Direct(e) = FALSE ∧ EntityMP(e) = entity))"/>
<org.eventb.core.guard name="_ciBhbWFUEeWoCLs0HEMUPA" org.eventb.core.label="grd17" org.eventb.core.predicate="∀e · e ∈ Entities ∧ (e = entity ∨ (Direct(e) = FALSE ∧ EntityMP(e) = entity)) ⇒ e ↦ Own ∈ roleRights(owner) ∧ e ↦ Own ∉ RoleRights(owner)"/>
<org.eventb.core.guard name="_ciBhbmFUEeWoCLs0HEMUPA" org.eventb.core.label="grd18" org.eventb.core.predicate="∀e · e ∈ Entities ∧ e ↦ Own ∉ roleRights(oldOwner) ∧ e ↦ Own ∈ RoleRights(oldOwner) ⇒ (e = entity ∨ (Direct(e) = FALSE ∧ EntityMP(e) = entity))"/>
<org.eventb.core.guard name="_ciBhb2FUEeWoCLs0HEMUPA" org.eventb.core.label="grd19" org.eventb.core.predicate="∀e · e ∈ Entities ∧ (e = entity ∨ (Direct(e) = FALSE ∧ EntityMP(e) = entity)) ⇒ e ↦ Own ∉ roleRights(oldOwner) ∧ e ↦ Own ∈ RoleRights(oldOwner)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_KeIs7mFOEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_hard_link">
<org.eventb.core.parameter name="_obhby2FQEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_KA6zIWFTEeWoCLs0HEMUPA" org.eventb.core.identifier="object"/>
<org.eventb.core.parameter name="_KA7aMGFTEeWoCLs0HEMUPA" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_KA7aMWFTEeWoCLs0HEMUPA" org.eventb.core.identifier="name"/>
<org.eventb.core.parameter name="_KA7aMmFTEeWoCLs0HEMUPA" org.eventb.core.identifier="depth"/>
<org.eventb.core.guard name="_ciBhcGFUEeWoCLs0HEMUPA" org.eventb.core.label="grd1" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="_ciBhcWFUEeWoCLs0HEMUPA" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_ciBhcmFUEeWoCLs0HEMUPA" org.eventb.core.label="grd3" org.eventb.core.predicate="parent ∈ Containers"/>
<org.eventb.core.guard name="_ciBhc2FUEeWoCLs0HEMUPA" org.eventb.core.label="grd4" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ c∈dom(EntityNames(object)) ∧ Parent[E] ∪ {c} = E ∪ {Root}&#10;&#9;∧ (∀o · o ∈ E ∪ {object} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
<org.eventb.core.guard name="_ciBhdGFUEeWoCLs0HEMUPA" org.eventb.core.label="grd5" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="_hSdqNmFXEeWoCLs0HEMUPA" org.eventb.core.label="grd6" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ parent ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_hSdqN2FXEeWoCLs0HEMUPA" org.eventb.core.label="grd7" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.guard name="_hSdqOGFXEeWoCLs0HEMUPA" org.eventb.core.label="grd8" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ⇒ parent ↦ name ∉ EntityNames(e)"/>
<org.eventb.core.guard name="_hSdqOWFXEeWoCLs0HEMUPA" org.eventb.core.label="grd9" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ∧ parent ∈ dom(EntityNames(e)) ⇒ Direct(e) = Direct(object)"/>
<org.eventb.core.guard name="_hSdqOmFXEeWoCLs0HEMUPA" org.eventb.core.label="grd10" org.eventb.core.predicate="Direct(object) = TRUE ⇒ Direct(parent) = TRUE"/>
<org.eventb.core.guard name="_hSdqO2FXEeWoCLs0HEMUPA" org.eventb.core.label="grd11" org.eventb.core.predicate="Direct(object) = FALSE ∧ Direct(parent) = TRUE ⇒ EntityMP(object) = parent"/>
<org.eventb.core.action name="_obip4GFQEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityNames(object) ≔ EntityNames(object) ∪ {parent ↦ name}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_hSdqPGFXEeWoCLs0HEMUPA" org.eventb.core.label="grd12" org.eventb.core.predicate="Direct(object) = FALSE ∧ Direct(parent) = TRUE ⇒ (∀e · e ∈ dom(EntityNames) ∧ parent ∈ dom(EntityNames(e)) ⇒ Direct(e) = FALSE)"/>
<org.eventb.core.guard name="_hSdqPWFXEeWoCLs0HEMUPA" org.eventb.core.label="grd13" org.eventb.core.predicate="Direct(object) = FALSE ∧ Direct(parent) = FALSE ⇒ EntityMP(object) = EntityMP(parent)"/>
<org.eventb.core.guard name="_hSdqPmFXEeWoCLs0HEMUPA" org.eventb.core.label="grd14" org.eventb.core.predicate="depth ∈ ℕ → ℙ(Containers)"/>
<org.eventb.core.guard name="_hSdqP2FXEeWoCLs0HEMUPA" org.eventb.core.label="grd15" org.eventb.core.predicate="∀c · c ∈ Containers ⇒ (∃i · i ∈ ℕ ∧ c ∈ depth(i))"/>
<org.eventb.core.guard name="_hSdqQGFXEeWoCLs0HEMUPA" org.eventb.core.label="grd16" org.eventb.core.predicate="depth(0) = {Root}"/>
<org.eventb.core.guard name="_hSdqQWFXEeWoCLs0HEMUPA" org.eventb.core.label="grd17" org.eventb.core.predicate="∀i · i ∈ ℕ ∧ i ≠ 0 ⇒ (∀c · c ∈ depth(i) ⇒ c ≠ Root)"/>
<org.eventb.core.guard name="_hSdqQmFXEeWoCLs0HEMUPA" org.eventb.core.label="grd18" org.eventb.core.predicate="∀i · i ∈ ℕ ⇒ (∀c · c ∈ depth(i + 1) ⇒ (∃p · p ∈ depth(i) ∧ p = Parent(c)))"/>
<org.eventb.core.guard name="_hSeRQGFXEeWoCLs0HEMUPA" org.eventb.core.label="grd19" org.eventb.core.predicate="∀i · i ∈ ℕ ∧ (∀c · c ∈ depth(i) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))&#10;&#9;⇒ (∀c · c ∈ depth(i + 1) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))" org.eventb.core.theorem="true"/>
<org.eventb.core.guard name="_hSeRQWFXEeWoCLs0HEMUPA" org.eventb.core.label="grd20" org.eventb.core.predicate="∀i · i ∈ ℕ ⇒ (∀c · c ∈ depth(i) ⇒ (∃E · E ⊆ Containers ∧ Root ∉ E ∧ Parent[E] ∪ {c} = E ∪ {Root}))" org.eventb.core.theorem="true"/>
</org.eventb.core.event>
<org.eventb.core.event name="_obhbxmFQEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_hard_link">
<org.eventb.core.parameter name="_KA7aM2FTEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_qYCEYGFTEeWoCLs0HEMUPA" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_qYCEYWFTEeWoCLs0HEMUPA" org.eventb.core.identifier="name"/>
<org.eventb.core.parameter name="_qYCEYmFTEeWoCLs0HEMUPA" org.eventb.core.identifier="object"/>
<org.eventb.core.action name="_KA8BQGFTEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityNames(object) ≔ EntityNames(object) ∖ {parent ↦ name}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_hSeRQmFXEeWoCLs0HEMUPA" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_Q53-0GHeEeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="parent ∈ Containers"/>
<org.eventb.core.guard name="_Q53-0WHeEeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="_Q53-0mHeEeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.guard name="_MhijgmFYEeWoCLs0HEMUPA" org.eventb.core.label="grd5" org.eventb.core.predicate="parent ↦ name ∈ EntityNames(object)"/>
<org.eventb.core.guard name="_Mhijg2FYEeWoCLs0HEMUPA" org.eventb.core.label="grd6" org.eventb.core.predicate="∃p, n · p ∈ Containers ∧ p ↦ n ∈ EntityNames(object) ∧ (n ≠ name ∨ p ≠ parent)"/>
<org.eventb.core.guard name="_MhijhGFYEeWoCLs0HEMUPA" org.eventb.core.label="grd7" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="_MhijhWFYEeWoCLs0HEMUPA" org.eventb.core.label="grd8" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ parent ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_U4-fYGHjEeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="Shared(parent) = TRUE ⇒ (∃r · r ∈ Roles ∧ object ↦ Own ∈ RoleRights(r) ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject))"/>
</org.eventb.core.event>
<org.eventb.core.event name="_KA6zIGFTEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="rename_entity">
<org.eventb.core.parameter name="_ciBhYGFUEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_ciBhYWFUEeWoCLs0HEMUPA" org.eventb.core.identifier="oldName"/>
<org.eventb.core.parameter name="_ciBhYmFUEeWoCLs0HEMUPA" org.eventb.core.identifier="name"/>
<org.eventb.core.parameter name="_ciBhY2FUEeWoCLs0HEMUPA" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_ciBhZGFUEeWoCLs0HEMUPA" org.eventb.core.identifier="entity"/>
<org.eventb.core.guard name="_U4-fYWHjEeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.action name="_qYCrcGFTEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityNames(entity) ≔ (EntityNames(entity) ∖ {parent ↦ oldName}) ∪ {parent ↦ name}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_U4-fYmHjEeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="parent ∈ Containers"/>
<org.eventb.core.guard name="_Q54l4WHeEeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="entity ∈ dom(EntityNames)"/>
<org.eventb.core.guard name="_Q54l4mHeEeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="oldName ∈ Names"/>
<org.eventb.core.guard name="_Q54l42HeEeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="parent ↦ oldName ∈ EntityNames(entity)"/>
<org.eventb.core.guard name="_Q54l5GHeEeWbr88oOyLCRQ" org.eventb.core.label="grd6" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.guard name="_0KMtUGHoEeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ⇒ parent ↦ name ∉ EntityNames(e)"/>
<org.eventb.core.guard name="_0KMtUWHoEeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="_0KMtUmHoEeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ parent ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_U4_GcWHjEeWbr88oOyLCRQ" org.eventb.core.label="grd10" org.eventb.core.predicate="Shared(parent) = TRUE ⇒ (∃r · r ∈ Roles ∧ entity ↦ Own ∈ RoleRights(r) ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject))"/>
</org.eventb.core.event>
<org.eventb.core.event name="_qYBdUGFTEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="set_container_attr">
<org.eventb.core.parameter name="_ciBhZWFUEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_hSdqMGFXEeWoCLs0HEMUPA" org.eventb.core.identifier="container"/>
<org.eventb.core.parameter name="_hSdqMWFXEeWoCLs0HEMUPA" org.eventb.core.identifier="shared"/>
<org.eventb.core.action name="_ciCIcGFUEeWoCLs0HEMUPA" org.eventb.core.assignment="Shared(container) ≔ shared" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_U4_GcmHjEeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_U4_Gc2HjEeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="container ∈ Containers"/>
<org.eventb.core.guard name="_U4_GdGHjEeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="shared ∈ BOOL"/>
<org.eventb.core.guard name="_0KNUYWHoEeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="(∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ container ↦ Own ∈ RoleRights(r))&#10;&#9;∨ EntitiesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_0KNUYmHoEeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((container ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(container)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ container = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {container} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
</org.eventb.core.event>
<org.eventb.core.event name="_zopGAE_tEeW7pIdunj-aU5" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="read_container">
<org.eventb.core.parameter name="'" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="(" org.eventb.core.identifier="container"/>
<org.eventb.core.parameter name=")" org.eventb.core.identifier="object"/>
<org.eventb.core.guard name="*" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="+" org.eventb.core.label="grd2" org.eventb.core.predicate="container ∈ Containers"/>
<org.eventb.core.guard name="," org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="-" org.eventb.core.label="grd4" org.eventb.core.predicate="object ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="." org.eventb.core.label="grd5" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ container ↦ Read ∈ RoleRights(r)"/>
<org.eventb.core.guard name="/" org.eventb.core.label="grd6" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ container ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="0" org.eventb.core.label="grd7" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((container ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(container)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ container = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {container} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
</org.eventb.core.event>
<org.eventb.core.event name="_zopGAE_tEeW7pIdunj-aU7" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="get_entity_attr">
<org.eventb.core.parameter name="element1" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="element2" org.eventb.core.identifier="entity"/>
<org.eventb.core.parameter name="element3" org.eventb.core.identifier="object"/>
<org.eventb.core.guard name="grd1" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="grd2" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="grd3" org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="grd4" org.eventb.core.label="grd4" org.eventb.core.predicate="object ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="element4" org.eventb.core.label="grd5" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((entity ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(entity)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ entity = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {entity} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
</org.eventb.core.event>
<org.eventb.core.event name="_ciA6UGFUEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_entity">
<org.eventb.core.action name="_ciCIcWFUEeWoCLs0HEMUPA" org.eventb.core.assignment="Entities ≔ Entities ∖ {entity}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_ciCIcmFUEeWoCLs0HEMUPA" org.eventb.core.assignment="Objects ≔ Objects ∖ {entity}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_ciCIc2FUEeWoCLs0HEMUPA" org.eventb.core.assignment="Containers ≔ Containers ∖ {entity}" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_ciCIdGFUEeWoCLs0HEMUPA" org.eventb.core.assignment="Shared ≔ {entity} ⩤ Shared" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_ciCIdWFUEeWoCLs0HEMUPA" org.eventb.core.assignment="Parent ≔ {entity} ⩤ Parent" org.eventb.core.label="act5"/>
<org.eventb.core.parameter name="_hSdqMmFXEeWoCLs0HEMUPA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_hSdqM2FXEeWoCLs0HEMUPA" org.eventb.core.identifier="entity"/>
<org.eventb.core.parameter name="_hSdqNGFXEeWoCLs0HEMUPA" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_hSdqNWFXEeWoCLs0HEMUPA" org.eventb.core.identifier="name"/>
<org.eventb.core.guard name="_0KNUZGHoEeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_oQL4wGHwEeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ≠ Root"/>
<org.eventb.core.guard name="_oQL4wWHwEeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_oQL4wmHwEeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="parent ∈ Containers"/>
<org.eventb.core.guard name="_oQL4w2HwEeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="parent ↦ name ∈ EntityNames(entity)"/>
<org.eventb.core.guard name="_oQL4x2HwEeWbr88oOyLCRQ" org.eventb.core.label="grd6" org.eventb.core.predicate="∀n · n ≠ name ⇒ parent ↦ n ∉ EntityNames(entity)"/>
<org.eventb.core.guard name="_oQL4yGHwEeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="∀e · e ∈ dom(EntityNames) ⇒ entity ∉ dom(EntityNames(e))"/>
<org.eventb.core.action name="_q9uEAGFWEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityNames ≔ {entity} ⩤ EntityNames" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_hSeRQ2FXEeWoCLs0HEMUPA" org.eventb.core.assignment="RoleRights ≔ roleRights" org.eventb.core.label="act7"/>
<org.eventb.core.action name="_hSeRRGFXEeWoCLs0HEMUPA" org.eventb.core.assignment="SubjectAccesses ≔ subjectAccesses" org.eventb.core.label="act8"/>
<org.eventb.core.action name="_hSeRRWFXEeWoCLs0HEMUPA" org.eventb.core.assignment="Direct ≔ {entity} ⩤ Direct" org.eventb.core.label="act9"/>
<org.eventb.core.action name="_hSeRRmFXEeWoCLs0HEMUPA" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∖ {entity}" org.eventb.core.label="act10"/>
<org.eventb.core.action name="_hSeRR2FXEeWoCLs0HEMUPA" org.eventb.core.assignment="EntityMP ≔ {entity} ⩤ EntityMP" org.eventb.core.label="act11"/>
<org.eventb.core.guard name="_oQL4yWHwEeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="∀c · c ∈ Containers ∧ c ≠ parent ⇒ c ∉ dom(EntityNames(entity))"/>
<org.eventb.core.guard name="_oQL4ymHwEeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="_OpFtUGHxEeWbr88oOyLCRQ" org.eventb.core.label="grd10" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ parent ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_Wb4ex2HyEeWbr88oOyLCRQ" org.eventb.core.label="grd11" org.eventb.core.predicate="Shared(parent) = TRUE ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ entity ↦ Own ∈ RoleRights(r))"/>
<org.eventb.core.guard name="_Wb4ezGHyEeWbr88oOyLCRQ" org.eventb.core.label="grd12" org.eventb.core.predicate="∀e · e ∈ Entities ∧ entity ∈ Containers ⇒ EntityMP(e) ≠ entity" org.eventb.core.theorem="true"/>
<org.eventb.core.parameter name="_q9uEAGFWEeWoCLs0HEMUPG" org.eventb.core.identifier="roleRights"/>
<org.eventb.core.parameter name="_q9uEAGFWEeWoCLs0HEMUPB" org.eventb.core.identifier="subjectAccesses"/>
<org.eventb.core.guard name="_q9uEAGFWEeWoCLs0HEMUPE" org.eventb.core.label="grd13" org.eventb.core.predicate="roleRights ∈ Roles → (Entities ↔ AccessRights)"/>
<org.eventb.core.guard name="_q9uEAGFWEeWoCLs0HEMUPF" org.eventb.core.label="grd14" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ roleRights(r) = {entity} ⩤ RoleRights(r)"/>
<org.eventb.core.guard name="_q9uEAGFWEeWoCLs0HEMUPC" org.eventb.core.label="grd15" org.eventb.core.predicate="subjectAccesses ∈ Subjects → (Entities ↔ Accesses)"/>
<org.eventb.core.guard name="_q9uEAGFWEeWoCLs0HEMUPD" org.eventb.core.label="grd16" org.eventb.core.predicate="∀s · s ∈ Subjects ⇒ subjectAccesses(s) = {entity} ⩤ SubjectAccesses(s)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_hSdDIGFXEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_first_subject">
<org.eventb.core.action name="_hSeRSGFXEeWoCLs0HEMUPA" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∪ {newSubject}" org.eventb.core.label="act1"/>
<org.eventb.core.parameter name="_Q54l4GHeEeWbr88oOyLCRQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_U4_GcGHjEeWbr88oOyLCRQ" org.eventb.core.identifier="newSubject"/>
<org.eventb.core.parameter name="_0KNUYGHoEeWbr88oOyLCRQ" org.eventb.core.identifier="user"/>
<org.eventb.core.parameter name="_oQLRsGHwEeWbr88oOyLCRQ" org.eventb.core.identifier="object"/>
<org.eventb.core.parameter name="_Wb4ewWHyEeWbr88oOyLCRQ" org.eventb.core.identifier="admAccesses"/>
<org.eventb.core.guard name="_Wb4ezWHyEeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="newSubject ∈ Union ∖ CurrUnion"/>
<org.eventb.core.guard name="_Wb4ezmHyEeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_Wb4ez2HyEeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="user ∈ UserAccs"/>
<org.eventb.core.guard name="_Wb4e0GHyEeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="_Wb4e0WHyEeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ object ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_Wb4e0mHyEeWbr88oOyLCRQ" org.eventb.core.label="grd6" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ c ∈ dom(EntityNames(object)) ∧ Parent[E] ∪ {c} = E ∪ {Root}&#10;&#9;∧ (∀o · o ∈ E ∪ {object} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
<org.eventb.core.guard name="_Wb4e02HyEeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="admAccesses ∈ Roles ↔ Accesses"/>
<org.eventb.core.action name="_Mhijh2FYEeWoCLs0HEMUPA" org.eventb.core.assignment="Subjects ≔ Subjects ∪ {newSubject}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_MhijiGFYEeWoCLs0HEMUPA" org.eventb.core.assignment="SubjectUser(newSubject) ≔ user" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_MhijiWFYEeWoCLs0HEMUPA" org.eventb.core.assignment="SubjectAccesses(newSubject) ≔ ∅" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_MhijimFYEeWoCLs0HEMUPA" org.eventb.core.assignment="SubjectAdmAccesses(newSubject) ≔ admAccesses" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_Mhiji2FYEeWoCLs0HEMUPA" org.eventb.core.assignment="SubjectOwner(newSubject) ≔ UserOrdRole(user)" org.eventb.core.label="act6"/>
<org.eventb.core.guard name="_Wb5F1GHyEeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="UserAdmRole(user) ↦ ReadA ∈ admAccesses"/>
<org.eventb.core.guard name="_Wb5F1WHyEeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="UserOrdRole(user) ↦ ReadA ∈ admAccesses"/>
<org.eventb.core.guard name="_oQLRsWHwEeWbr88oOyLCRS" org.eventb.core.label="grd10" org.eventb.core.predicate="UserOrdRole(user) ↦ WriteA ∈ admAccesses"/>
<org.eventb.core.guard name="_Wb5F1mHyEeWbr88oOyLCRQ" org.eventb.core.label="grd11" org.eventb.core.predicate="CommonRole ↦ ReadA ∈ admAccesses"/>
<org.eventb.core.guard name="_Wb5F12HyEeWbr88oOyLCRQ" org.eventb.core.label="grd12" org.eventb.core.predicate="CommonRole ↦ WriteA ∈ admAccesses"/>
<org.eventb.core.action name="_oQLRsWHwEeWbr88oOyLCRR" org.eventb.core.assignment="SParent(newSubject) ≔ SRoot" org.eventb.core.label="act7"/>
</org.eventb.core.event>
<org.eventb.core.event name="_Mhh8cGFYEeWoCLs0HEMUPA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_subject">
<org.eventb.core.parameter name="_Wb4ewmHyEeWbr88oOyLCRQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_Wb4ew2HyEeWbr88oOyLCRQ" org.eventb.core.identifier="newSubject"/>
<org.eventb.core.parameter name="_Wb4exGHyEeWbr88oOyLCRQ" org.eventb.core.identifier="user"/>
<org.eventb.core.parameter name="_Wb4exWHyEeWbr88oOyLCRQ" org.eventb.core.identifier="object"/>
<org.eventb.core.parameter name="_kGOc9GH0EeWbr88oOyLCRQ" org.eventb.core.identifier="admAccesses"/>
<org.eventb.core.guard name="_Wb5F3GHyEeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="newSubject ∈ Union ∖ CurrUnion"/>
<org.eventb.core.guard name="_Wb5F3WHyEeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_Wb5F3mHyEeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="user ∈ UserAccs"/>
<org.eventb.core.guard name="_Wb5s4GHyEeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="user = SubjectUser(subject)"/>
<org.eventb.core.guard name="_CrPJUGHzEeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="_CrPJUWHzEeWbr88oOyLCRQ" org.eventb.core.label="grd6" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ object ↦ Execute ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_bB39AGHzEeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ c ∈ dom(EntityNames(object)) ∧ Parent[E] ∪ {c} = E ∪ {Root}&#10;&#9;∧ (∀o · o ∈ E ∪ {object} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
<org.eventb.core.guard name="_kGOc9mH0EeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="admAccesses ∈ Roles ↔ Accesses"/>
<org.eventb.core.action name="_MhijjGFYEeWoCLs0HEMUPA" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∪ {newSubject}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_eQw-UGFYEeWoCLs0HEMUPA" org.eventb.core.assignment="Subjects ≔ Subjects ∪ {newSubject}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_oQL4y2HwEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectUser(newSubject) ≔ user" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_Wb6T8GHyEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectAccesses(newSubject) ≔ ∅" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_Wb6T8WHyEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectAdmAccesses(newSubject) ≔ admAccesses" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_Wb6T8mHyEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectOwner(newSubject) ≔ UserOrdRole(user)" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_Wb6T82HyEeWbr88oOyLCRQ" org.eventb.core.assignment="SParent(newSubject) ≔ subject" org.eventb.core.label="act7"/>
<org.eventb.core.guard name="_kGOc_GH0EeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="UserAdmRole(user) ↦ ReadA ∈ admAccesses"/>
<org.eventb.core.guard name="_kGOc_WH0EeWbr88oOyLCRQ" org.eventb.core.label="grd10" org.eventb.core.predicate="UserOrdRole(user) ↦ ReadA ∈ admAccesses"/>
<org.eventb.core.guard name="_oQL4y2HwEeWbr88oOyLCRR" org.eventb.core.label="grd11" org.eventb.core.predicate="UserOrdRole(user) ↦ WriteA ∈ admAccesses"/>
<org.eventb.core.guard name="_kGOc_mH0EeWbr88oOyLCRQ" org.eventb.core.label="grd12" org.eventb.core.predicate="CommonRole ↦ ReadA ∈ admAccesses"/>
<org.eventb.core.guard name="_kGOc_2H0EeWbr88oOyLCRQ" org.eventb.core.label="grd13" org.eventb.core.predicate="CommonRole ↦ WriteA ∈ admAccesses"/>
</org.eventb.core.event>
<org.eventb.core.event name="_oQL4xGHwEeWbr88oOyLCRQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="set_subject_owner">
<org.eventb.core.parameter name="_kGOc9WH0EeWbr88oOyLCRQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_f7DAg2H1EeWbr88oOyLCRQ" org.eventb.core.identifier="oldOwner"/>
<org.eventb.core.parameter name="_f7DAgWH1EeWbr88oOyLCRQ" org.eventb.core.identifier="owner"/>
<org.eventb.core.parameter name="_f7DAgmH1EeWbr88oOyLCRQ" org.eventb.core.identifier="chSubject"/>
<org.eventb.core.action name="_Wb6T9GHyEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectOwner(chSubject) ≔ owner" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_kGPEA2H0EeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_kGPEBGH0EeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="chSubject ∈ Subjects"/>
<org.eventb.core.guard name="_kGPEBWH0EeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="oldOwner ∈ Roles"/>
<org.eventb.core.guard name="_f7CZcGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="owner ∈ Roles"/>
<org.eventb.core.guard name="_f7CZcWH1EeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="owner ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7CZcmH1EeWbr88oOyLCRQ" org.eventb.core.label="grd6" org.eventb.core.predicate="SubjectsAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7CZc2H1EeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="chSubject ∈ dom(SubjectOwner) ⇒ SubjectOwner(chSubject) = oldOwner"/>
<org.eventb.core.guard name="_f7CZdGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="chSubject ∈ dom(SubjectOwner) ⇒ oldOwner ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7CZdWH1EeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="chSubject ∈ dom(SubjectOwner) ⇒ oldOwner ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt12" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="get_subject_attr">
<org.eventb.core.parameter name="'" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="(" org.eventb.core.identifier="chSubject"/>
<org.eventb.core.parameter name=")" org.eventb.core.identifier="object"/>
<org.eventb.core.guard name="*" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="+" org.eventb.core.label="grd2" org.eventb.core.predicate="chSubject ∈ Subjects"/>
<org.eventb.core.guard name="," org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="-" org.eventb.core.label="grd4" org.eventb.core.predicate="object ↦ WriteA ∈ SubjectAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt6" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="access_read_entity">
<org.eventb.core.parameter name="_R3DNJGKsEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_R3DNJWKsEeWR3tX1_PqofQ" org.eventb.core.identifier="entity"/>
<org.eventb.core.action name="_Po1vkGbSEeWEJdelIsYeNA" org.eventb.core.assignment="SubjectAccesses(subject) ≔ SubjectAccesses(subject) ∪ {entity ↦ ReadA}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_vl_s0WKtEeWR3tX1_PqofQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_vl_s0mKtEeWR3tX1_PqofQ" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_vl_s02KtEeWR3tX1_PqofQ" org.eventb.core.label="grd3" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ entity ↦ Read ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_vl_s1GKtEeWR3tX1_PqofQ" org.eventb.core.label="grd4" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((entity ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(entity)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ entity = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {entity} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt7" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="access_read_role">
<org.eventb.core.parameter name="_R3DNJmKsEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_diFbcGKtEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.action name="_Po1vkWbSEeWEJdelIsYeNA" org.eventb.core.assignment="SubjectAdmAccesses(subject) ≔ SubjectAdmAccesses(subject) ∪ {role ↦ ReadA}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_vl_s1WKtEeWR3tX1_PqofQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_vl_FxWKtEeWR3tX1_PqofQ" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_w37j6GKvEeWR3tX1_PqofQ" org.eventb.core.label="grd3" org.eventb.core.predicate="∃r · r ∈ AdmRoles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ role ↦ Read ∈ RoleAdmRights(r)"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt8" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="access_write_entity">
<org.eventb.core.parameter name="_diFbcWKtEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_diFbcmKtEeWR3tX1_PqofQ" org.eventb.core.identifier="entity"/>
<org.eventb.core.action name="_Po2WoGbSEeWEJdelIsYeNA" org.eventb.core.assignment="SubjectAccesses(subject) ≔ SubjectAccesses(subject) ∪ {entity ↦ WriteA}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_w37j6WKvEeWR3tX1_PqofQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_w37j6mKvEeWR3tX1_PqofQ" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_9on4B2X4EeWfdb_Dle8qAw" org.eventb.core.label="grd3" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ entity ↦ Write∈RoleRights(r)"/>
<org.eventb.core.guard name="_9on4CGX4EeWfdb_Dle8qAw" org.eventb.core.label="grd4" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((entity ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(entity)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ entity = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {entity} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt9" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="access_write_role">
<org.eventb.core.parameter name="_diFbc2KtEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_diFbdGKtEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.action name="_Po2WoWbSEeWEJdelIsYeNA" org.eventb.core.assignment="SubjectAdmAccesses(subject) ≔ SubjectAdmAccesses(subject) ∪ {role ↦ WriteA}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_9on4CWX4EeWfdb_Dle8qAw" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_9on4CmX4EeWfdb_Dle8qAw" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_9on4C2X4EeWfdb_Dle8qAw" org.eventb.core.label="grd3" org.eventb.core.predicate="∃r · r ∈ AdmRoles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ role ↦ Write ∈ RoleAdmRights(r)"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt10" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_access_entity">
<org.eventb.core.parameter name="_vl-esWKtEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_vl_FwGKtEeWR3tX1_PqofQ" org.eventb.core.identifier="entity"/>
<org.eventb.core.parameter name="_vl_FwWKtEeWR3tX1_PqofQ" org.eventb.core.identifier="access"/>
<org.eventb.core.action name="_Po2WombSEeWEJdelIsYeNA" org.eventb.core.assignment="SubjectAccesses(subject) ≔ SubjectAccesses(subject) ∖ {entity ↦ access}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_9on4DGX4EeWfdb_Dle8qAw" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_9on4DWX4EeWfdb_Dle8qAw" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_9oofEGX4EeWfdb_Dle8qAw" org.eventb.core.label="grd3" org.eventb.core.predicate="entity ↦ access ∈ SubjectAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt11" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_access_role">
<org.eventb.core.parameter name="_vl_FwmKtEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_vl_Fw2KtEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_vl_FxGKtEeWR3tX1_PqofQ" org.eventb.core.identifier="access"/>
<org.eventb.core.action name="_Po29sGbSEeWEJdelIsYeNA" org.eventb.core.assignment="SubjectAdmAccesses(subject) ≔ SubjectAdmAccesses(subject) ∖ {role ↦ access}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_9oofEWX4EeWfdb_Dle8qAw" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_9oofEmX4EeWfdb_Dle8qAw" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_9oofE2X4EeWfdb_Dle8qAw" org.eventb.core.label="grd3" org.eventb.core.predicate="role ↦ access ∈ SubjectAdmAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_Wb33sGHyEeWbr88oOyLCRQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_subject">
<org.eventb.core.action name="_Wb6T9WHyEeWbr88oOyLCRQ" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∖ {delSubject}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_Wb6T9mHyEeWbr88oOyLCRQ" org.eventb.core.assignment="Subjects ≔ Subjects ∖ {delSubject}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_Wb6T92HyEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectUser ≔ {delSubject} ⩤ SubjectUser" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_Wb6T-GHyEeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectAccesses ≔ {delSubject} ⩤ SubjectAccesses" org.eventb.core.label="act4"/>
<org.eventb.core.parameter name="__M6ZkWH4EeWbr88oOyLCRQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_f7DAhGH1EeWbr88oOyLCRQ" org.eventb.core.identifier="delSubject"/>
<org.eventb.core.action name="_kGPECmH0EeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectOwner ≔ {delSubject} ⩤ SubjectOwner" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_kGPEC2H0EeWbr88oOyLCRQ" org.eventb.core.assignment="SubjectAdmAccesses ≔ {delSubject} ⩤ SubjectAdmAccesses" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_kGPEDGH0EeWbr88oOyLCRQ" org.eventb.core.assignment="SParent ≔ {delSubject} ⩤ SParent" org.eventb.core.label="act7"/>
<org.eventb.core.guard name="_f7CZdmH1EeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_f7CZd2H1EeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="delSubject ∈ Subjects"/>
<org.eventb.core.guard name="_kGPEDGH0EeWbr88oOyLCRS" org.eventb.core.label="grd3" org.eventb.core.predicate="delSubject ≠ SRoot"/>
<org.eventb.core.guard name="_f7CZeGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="∀s · s ∈ dom(SParent) ⇒ SParent(s) ≠ delSubject"/>
<org.eventb.core.guard name="_f7CZeWH1EeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="delSubject ∈ dom(SubjectOwner)"/>
<org.eventb.core.guard name="_kGPEDGH0EeWbr88oOyLCRR" org.eventb.core.label="grd6" org.eventb.core.predicate="SubjectOwner(delSubject) ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_kGOc8GH0EeWbr88oOyLCRQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_role">
<org.eventb.core.guard name="_f7CZemH1EeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_f7CZe2H1EeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Union ∖ CurrUnion"/>
<org.eventb.core.guard name="_f7DAh2H1EeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="parent ∈ Roles"/>
<org.eventb.core.guard name="_f7DAiGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ parent ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_kGPrEmH0EeWbr88oOyLCRT" org.eventb.core.label="grd5" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ parent ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_kGPrEmH0EeWbr88oOyLCRU" org.eventb.core.label="grd6" org.eventb.core.predicate="parent ≠ CommonRole"/>
<org.eventb.core.guard name="_f7DAimH1EeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="parent ∉ SpecialAdmRoles"/>
<org.eventb.core.guard name="_f7DAi2H1EeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7DAjGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd9" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7DAjWH1EeWbr88oOyLCRQ" org.eventb.core.label="grd10" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7DAjmH1EeWbr88oOyLCRQ" org.eventb.core.label="grd11" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7DAj2H1EeWbr88oOyLCRQ" org.eventb.core.label="grd12" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_f7DAkGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd13" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.parameter name="_f7DAhWH1EeWbr88oOyLCRQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.guard name="_f7DAkWH1EeWbr88oOyLCRQ" org.eventb.core.label="grd14" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ name ≠ RoleName(r)"/>
<org.eventb.core.parameter name="_X70jUWH5EeWbr88oOyLCRQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_X70jUmH5EeWbr88oOyLCRQ" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_X70jU2H5EeWbr88oOyLCRQ" org.eventb.core.identifier="name"/>
<org.eventb.core.parameter name="__M6ZkmH4EeWbr88oOyLCRQ" org.eventb.core.identifier="admRoles"/>
<org.eventb.core.parameter name="__M6Zk2H4EeWbr88oOyLCRQ" org.eventb.core.identifier="ordRoles"/>
<org.eventb.core.parameter name="_ImxxEWKrEeWR3tX1_PqofQ" org.eventb.core.identifier="roleAdmRights"/>
<org.eventb.core.guard name="_f7DAkmH1EeWbr88oOyLCRQ" org.eventb.core.label="grd15" org.eventb.core.predicate="admRoles ∈ ℙ(Union ∖ CurrUnion)"/>
<org.eventb.core.guard name="_f7DAhmH1EeWbr88oOyLCRQ" org.eventb.core.label="grd16" org.eventb.core.predicate="ordRoles ∈ ℙ(Union ∖ CurrUnion)"/>
<org.eventb.core.guard name="__M7AoGH4EeWbr88oOyLCRQ" org.eventb.core.label="grd17" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ordRoles = ∅"/>
<org.eventb.core.guard name="__M7AoWH4EeWbr88oOyLCRQ" org.eventb.core.label="grd18" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ admRoles = {role}"/>
<org.eventb.core.guard name="__M7AomH4EeWbr88oOyLCRQ" org.eventb.core.label="grd19" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ ordRoles = {role}"/>
<org.eventb.core.guard name="__M7Ao2H4EeWbr88oOyLCRQ" org.eventb.core.label="grd20" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ admRoles = ∅"/>
<org.eventb.core.guard name="__M7ApGH4EeWbr88oOyLCRQ" org.eventb.core.label="grd21" org.eventb.core.predicate="roleAdmRights ∈ AdmRoles ∪ admRoles→(Roles ∪ {role} ↔ AccessRights)"/>
<org.eventb.core.guard name="__M7ApWH4EeWbr88oOyLCRQ" org.eventb.core.label="grd22" org.eventb.core.predicate="∀r1, ar, r2 · r1 ∈ Roles ∧ r2 ∈ AdmRoles ∧ ar ∈ AccessRights ∧ r1 ↦ ar ∈ RoleAdmRights(r2)&#10;&#9;⇒ r1 ↦ ar ∈ roleAdmRights(r2)"/>
<org.eventb.core.guard name="_kGPrEmH0EeWbr88oOyLCRR" org.eventb.core.label="grd23" org.eventb.core.predicate="∀r1, ar, r2 · r1 ∈ Roles ∧ r2 ∈ AdmRoles ∧ ar ∈ AccessRights ∧ r1 ↦ ar ∈ roleAdmRights(r2)&#10;&#9;⇒ r1 ↦ ar ∈ RoleAdmRights(r2)"/>
<org.eventb.core.guard name="_f7DnkGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd24" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ role ∈ dom(roleAdmRights)" org.eventb.core.theorem="true"/>
<org.eventb.core.guard name="_f7DnkWH1EeWbr88oOyLCRQ" org.eventb.core.label="grd25" org.eventb.core.predicate="role ∈ dom(roleAdmRights) ⇒ parent ∈ AdmRoles" org.eventb.core.theorem="true"/>
<org.eventb.core.guard name="_f7DnkmH1EeWbr88oOyLCRQ" org.eventb.core.label="grd26" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ role ↦ Own ∈ roleAdmRights(RolesAR)"/>
<org.eventb.core.action name="_kGPEDWH0EeWbr88oOyLCRQ" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∪ {role}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_kGPEDmH0EeWbr88oOyLCRQ" org.eventb.core.assignment="Roles ≔ Roles ∪ {role}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_kGPED2H0EeWbr88oOyLCRQ" org.eventb.core.assignment="AdmRoles ≔ AdmRoles ∪ admRoles" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_kGPEEGH0EeWbr88oOyLCRQ" org.eventb.core.assignment="OrdRoles ≔ OrdRoles ∪ ordRoles" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_kGPrEGH0EeWbr88oOyLCRQ" org.eventb.core.assignment="RoleAdmRights ≔ roleAdmRights" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_kGPrEWH0EeWbr88oOyLCRQ" org.eventb.core.assignment="RParents(role) ≔ {parent}" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_kGPrEmH0EeWbr88oOyLCRQ" org.eventb.core.assignment="RoleRights(role) ≔ ∅" org.eventb.core.label="act7"/>
<org.eventb.core.action name="_kGPrE2H0EeWbr88oOyLCRQ" org.eventb.core.assignment="RoleName(role) ≔ name" org.eventb.core.label="act8"/>
<org.eventb.core.action name="_f7DnlGH1EeWbr88oOyLCRQ" org.eventb.core.assignment="Shared(role) ≔ TRUE" org.eventb.core.label="act9"/>
<org.eventb.core.guard name="_f7CZfGH1EeWbr88oOyLCRQ" org.eventb.core.label="grd27" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ role ↦ Own ∉ roleAdmRights(ARolesAR)"/>
<org.eventb.core.guard name="_X71KaGH5EeWbr88oOyLCRQ" org.eventb.core.label="grd28" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ role ↦ Own ∈ roleAdmRights(ARolesAR)"/>
<org.eventb.core.guard name="_X71KaWH5EeWbr88oOyLCRQ" org.eventb.core.label="grd29" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ role ↦ Own ∉ roleAdmRights(RolesAR)"/>
<org.eventb.core.guard name="__M7ApmH4EeWbr88oOyLCRQ" org.eventb.core.label="grd30" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ (∀r · r ∈ Roles ∪ {role} ⇒ r ↦ Execute ∈ roleAdmRights(role))"/>
<org.eventb.core.guard name="__M7Ap2H4EeWbr88oOyLCRQ" org.eventb.core.label="grd31" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ (∀ar · ar ∈ AccessRights ∧ ar ≠ Execute ⇒ ar ∉ ran(roleAdmRights(role)))"/>
<org.eventb.core.guard name="__M7AqGH4EeWbr88oOyLCRQ" org.eventb.core.label="grd32" org.eventb.core.predicate="∀r · r ∈ AdmRoles ⇒ role ↦ Execute ∈ roleAdmRights(r)"/>
<org.eventb.core.guard name="__M7AqWH4EeWbr88oOyLCRQ" org.eventb.core.label="grd33" org.eventb.core.predicate="∀r · r ∈ AdmRoles ∧ r ≠ RolesAR ∧ r ≠ ARolesAR ⇒ role ↦ Own ∉ roleAdmRights(r)"/>
<org.eventb.core.guard name="__M7AqmH4EeWbr88oOyLCRQ" org.eventb.core.label="grd34" org.eventb.core.predicate="∀r · r ∈ AdmRoles ⇒ role ↦ Write ∉ roleAdmRights(r)"/>
<org.eventb.core.guard name="__M7Aq2H4EeWbr88oOyLCRQ" org.eventb.core.label="grd35" org.eventb.core.predicate="∀r · r ∈ AdmRoles ⇒ (parent ↦ Read ∈ RoleAdmRights(r) ⇔ role ↦ Read ∈ roleAdmRights(r))"/>
<org.eventb.core.action name="_kGPrEmH0EeWbr88oOyLCRS" org.eventb.core.assignment="Direct(role) ≔ TRUE" org.eventb.core.label="act10"/>
</org.eventb.core.event>
<org.eventb.core.event name="_f7DAgGH1EeWbr88oOyLCRQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="create_hard_link_role">
<org.eventb.core.parameter name="_ImyYIGKrEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_ImyYJ2KrEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_ImyYKGKrEeWR3tX1_PqofQ" org.eventb.core.identifier="parent"/>
<org.eventb.core.parameter name="_dU4X0GKrEeWR3tX1_PqofQ" org.eventb.core.identifier="roleAdmRights"/>
<org.eventb.core.guard name="__M7ArGH4EeWbr88oOyLCRQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_X71KYGH5EeWbr88oOyLCRQ" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_X71KYWH5EeWbr88oOyLCRQ" org.eventb.core.label="grd3" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_f7DnlWH1EeWbr88oOyLCRR" org.eventb.core.label="grd4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_X71KYmH5EeWbr88oOyLCRQ" org.eventb.core.label="grd5" org.eventb.core.predicate="role ≠ CommonRole"/>
<org.eventb.core.guard name="_X71KY2H5EeWbr88oOyLCRQ" org.eventb.core.label="grd6" org.eventb.core.predicate="role ∉ SpecialAdmRoles"/>
<org.eventb.core.guard name="_X71KZGH5EeWbr88oOyLCRQ" org.eventb.core.label="grd7" org.eventb.core.predicate="parent ∈ Roles"/>
<org.eventb.core.guard name="_X71KZWH5EeWbr88oOyLCRQ" org.eventb.core.label="grd8" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ parent ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_f7DnlWH1EeWbr88oOyLCRS" org.eventb.core.label="grd9" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ parent ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_X71KZmH5EeWbr88oOyLCRQ" org.eventb.core.label="grd10" org.eventb.core.predicate="parent ≠ CommonRole"/>
<org.eventb.core.guard name="_X71KZ2H5EeWbr88oOyLCRQ" org.eventb.core.label="grd11" org.eventb.core.predicate="parent ≠ role"/>
<org.eventb.core.guard name="_ImyYIWKrEeWR3tX1_PqofQ" org.eventb.core.label="grd12" org.eventb.core.predicate="∀R · R ⊆ Roles ∧ role ∈ R ∧ (∀r · r ∈ R ∧ role ≠ r ⇒ (∃p · p ∈ R ∧ p ∈ RParents(r))) ⇒ parent ∉ R"/>
<org.eventb.core.guard name="_ImyYImKrEeWR3tX1_PqofQ" org.eventb.core.label="grd13" org.eventb.core.predicate="parent ∈ AdmRoles ⇔ role ∈ AdmRoles"/>
<org.eventb.core.guard name="_ImyYI2KrEeWR3tX1_PqofQ" org.eventb.core.label="grd14" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_ImyYJGKrEeWR3tX1_PqofQ" org.eventb.core.label="grd15" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_ImyYKWKrEeWR3tX1_PqofQ" org.eventb.core.label="grd16" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_ImyYKmKrEeWR3tX1_PqofQ" org.eventb.core.label="grd17" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_ImyYK2KrEeWR3tX1_PqofQ" org.eventb.core.label="grd18" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_dU4X0mKrEeWR3tX1_PqofQ" org.eventb.core.label="grd19" org.eventb.core.predicate="roleAdmRights ∈ AdmRoles → (Roles ↔ AccessRights)"/>
<org.eventb.core.guard name="_dU4X02KrEeWR3tX1_PqofQ" org.eventb.core.label="grd20" org.eventb.core.predicate="∀r · r ∈ AdmRoles ⇒ RoleAdmRights(r) ⊆ roleAdmRights(r)"/>
<org.eventb.core.guard name="_dU4X1GKrEeWR3tX1_PqofQ" org.eventb.core.label="grd21" org.eventb.core.predicate="∀r · r ∈ AdmRoles ∧ parent ↦ Read ∈ RoleAdmRights(r) ⇒ role ↦ Read ∈ roleAdmRights(r)"/>
<org.eventb.core.guard name="_dU4X1WKrEeWR3tX1_PqofQ" org.eventb.core.label="grd22" org.eventb.core.predicate="∀ar, r , p · r ∈ Roles ∧ ar ∈ AdmRoles ∧ p ↦ Read ∈ roleAdmRights(ar)&#10;&#9;∧ p ∈ RParents(r) ∧ p ↦ Read ∉ RoleAdmRights(ar)&#10;&#9;&#9;⇒ r ↦ Read ∈ roleAdmRights(ar)"/>
<org.eventb.core.action name="_f7DnlWH1EeWbr88oOyLCRQ" org.eventb.core.assignment="RParents(role) ≔ RParents(role) ∪ {parent}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="__M7nsGH4EeWbr88oOyLCRQ" org.eventb.core.assignment="RoleAdmRights ≔ roleAdmRights" org.eventb.core.label="act2"/>
<org.eventb.core.guard name="_dU4X2mKrEeWR3tX1_PqofQ" org.eventb.core.label="grd23" org.eventb.core.predicate="∀ar · ar ∈ AdmRoles ∧ parent ↦ Read ∉ RoleAdmRights(ar)&#10;&#9;⇒ roleAdmRights(ar) = RoleAdmRights(ar)"/>
<org.eventb.core.guard name="_dU4X22KrEeWR3tX1_PqofQ" org.eventb.core.label="grd24" org.eventb.core.predicate="∀r, accessRight, ar · ar ∈ AdmRoles ∧ accessRight ∈ AccessRights&#10;&#9;∧ r ↦ accessRight ∈ roleAdmRights(ar) ∧ r ↦ accessRight ∉ RoleAdmRights(ar)&#10;&#9;&#9;⇒ accessRight = Read"/>
</org.eventb.core.event>
<org.eventb.core.event name="__M6ZkGH4EeWbr88oOyLCRQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_hard_link_role">
<org.eventb.core.parameter name="_dU4X2GKrEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_dU4X2WKrEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_dU4X32KrEeWR3tX1_PqofQ" org.eventb.core.identifier="parent"/>
<org.eventb.core.guard name="_R3DNJ2KsEeWR3tX1_PqofQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_R3DNKGKsEeWR3tX1_PqofQ" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_R3DNKWKsEeWR3tX1_PqofQ" org.eventb.core.label="grd3" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_dU4X32KrEeWR3tX1_PqofR" org.eventb.core.label="grd4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_R3DNKmKsEeWR3tX1_PqofQ" org.eventb.core.label="grd5" org.eventb.core.predicate="role ≠ CommonRole"/>
<org.eventb.core.action name="_X71xcGH5EeWbr88oOyLCRQ" org.eventb.core.assignment="RParents(role) ≔ RParents(role) ∖ {parent}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_R3DNK2KsEeWR3tX1_PqofQ" org.eventb.core.label="grd6" org.eventb.core.predicate="role ∉ SpecialAdmRoles"/>
<org.eventb.core.guard name="_R3D0MGKsEeWR3tX1_PqofQ" org.eventb.core.label="grd7" org.eventb.core.predicate="parent ∈ Roles"/>
<org.eventb.core.guard name="_R3D0MWKsEeWR3tX1_PqofQ" org.eventb.core.label="grd8" org.eventb.core.predicate="parent ∈ RParents(role)"/>
<org.eventb.core.guard name="_R3D0MmKsEeWR3tX1_PqofQ" org.eventb.core.label="grd9" org.eventb.core.predicate="∃p · p ∈ Roles ∧ p ≠ parent ∧ p ∈ RParents(role)"/>
<org.eventb.core.guard name="_R3D0M2KsEeWR3tX1_PqofQ" org.eventb.core.label="grd10" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_R3D0NGKsEeWR3tX1_PqofQ" org.eventb.core.label="grd11" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_R3D0NWKsEeWR3tX1_PqofQ" org.eventb.core.label="grd12" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_R3D0NmKsEeWR3tX1_PqofQ" org.eventb.core.label="grd13" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_R3D0N2KsEeWR3tX1_PqofQ" org.eventb.core.label="grd14" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_X70jUGH5EeWbr88oOyLCRQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="rename_role">
<org.eventb.core.parameter name="_dU4X4GKrEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_dU4X4WKrEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_dU4-42KrEeWR3tX1_PqofQ" org.eventb.core.identifier="name"/>
<org.eventb.core.guard name="_R3D0OGKsEeWR3tX1_PqofQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.action name="_ImyYJWKrEeWR3tX1_PqofQ" org.eventb.core.assignment="RoleName(role) ≔ name" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_diFbdWKtEeWR3tX1_PqofQ" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_diFbdmKtEeWR3tX1_PqofQ" org.eventb.core.label="grd3" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_diFbfWKtEeWR3tX1_PqofR" org.eventb.core.label="grd4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_diFbd2KtEeWR3tX1_PqofQ" org.eventb.core.label="grd5" org.eventb.core.predicate="role ≠ CommonRole"/>
<org.eventb.core.guard name="_diFbeGKtEeWR3tX1_PqofQ" org.eventb.core.label="grd6" org.eventb.core.predicate="role ∉ SpecialAdmRoles"/>
<org.eventb.core.guard name="_diFbeWKtEeWR3tX1_PqofQ" org.eventb.core.label="grd7" org.eventb.core.predicate="name ∈ Names"/>
<org.eventb.core.guard name="_diFbemKtEeWR3tX1_PqofQ" org.eventb.core.label="grd8" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ name ≠ RoleName(r)"/>
<org.eventb.core.guard name="_diFbe2KtEeWR3tX1_PqofQ" org.eventb.core.label="grd9" org.eventb.core.predicate="role ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_diFbfGKtEeWR3tX1_PqofQ" org.eventb.core.label="grd10" org.eventb.core.predicate="role ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_diFbfWKtEeWR3tX1_PqofQ" org.eventb.core.label="grd11" org.eventb.core.predicate="∀p · p ∈ Roles ∧ p ∈ RParents(role) ⇒ p ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_zopGAE_tEeW7pIdunj-aU6" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="read_container_role">
<org.eventb.core.parameter name="'" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="(" org.eventb.core.identifier="container"/>
<org.eventb.core.parameter name=")" org.eventb.core.identifier="object"/>
<org.eventb.core.guard name="grd1" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="grd2" org.eventb.core.label="grd2" org.eventb.core.predicate="container ∈ Roles"/>
<org.eventb.core.guard name="grd3" org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="grd4" org.eventb.core.label="grd4" org.eventb.core.predicate="object ↦ WriteA ∈ SubjectAccesses(subject)"/>
<org.eventb.core.guard name="grd5" org.eventb.core.label="grd5" org.eventb.core.predicate="∃r · r ∈ AdmRoles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ container ↦ Read ∈ RoleAdmRights(r)"/>
</org.eventb.core.event>
<org.eventb.core.event name="_zopGAE_tEeW7pIdunj-aU9" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="get_role_attr">
<org.eventb.core.parameter name="'" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="(" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name=")" org.eventb.core.identifier="object"/>
<org.eventb.core.guard name="*" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="+" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="," org.eventb.core.label="grd3" org.eventb.core.predicate="object ∈ Objects"/>
<org.eventb.core.guard name="-" org.eventb.core.label="grd4" org.eventb.core.predicate="object ↦ WriteA ∈ SubjectAccesses(subject)"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt5" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="grant_rights">
<org.eventb.core.parameter name="_w37j4WKvEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_w37j4mKvEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_w37j42KvEeWR3tX1_PqofQ" org.eventb.core.identifier="entity"/>
<org.eventb.core.parameter name="_w37j5GKvEeWR3tX1_PqofQ" org.eventb.core.identifier="accessRights"/>
<org.eventb.core.parameter name="_9on4AWX4EeWfdb_Dle8qAw" org.eventb.core.identifier="changedEntities"/>
<org.eventb.core.guard name="_9oofFGX4EeWfdb_Dle8qAw" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_9oofFWX4EeWfdb_Dle8qAw" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_9oofFmX4EeWfdb_Dle8qAw" org.eventb.core.label="grd3" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_9oofF2X4EeWfdb_Dle8qAw" org.eventb.core.label="grd4" org.eventb.core.predicate="accessRights ⊆ AccessRights"/>
<org.eventb.core.guard name="_9oofGGX4EeWfdb_Dle8qAw" org.eventb.core.label="grd5" org.eventb.core.predicate="Own ∉ accessRights"/>
<org.eventb.core.guard name="_9oofGWX4EeWfdb_Dle8qAw" org.eventb.core.label="grd6" org.eventb.core.predicate="role ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.action name="_Po3kwGbSEeWEJdelIsYeNA" org.eventb.core.assignment="RoleRights(role) ≔ RoleRights(role) ∪ {x ↦ y ∣ x ∈ changedEntities ∧ y ∈ accessRights}" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_Po3kwWbSEeWEJdelIsYeNA" org.eventb.core.label="grd7" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ entity ↦ Own ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_Po3kwmbSEeWEJdelIsYeNA" org.eventb.core.label="grd8" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((entity ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(entity)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ entity = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {entity} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
<org.eventb.core.guard name="_Po3kw2bSEeWEJdelIsYeNA" org.eventb.core.label="grd9" org.eventb.core.predicate="Direct(entity) = TRUE"/>
<org.eventb.core.guard name="_Po4L0GbSEeWEJdelIsYeNA" org.eventb.core.label="grd10" org.eventb.core.predicate="changedEntities ⊆ Entities"/>
<org.eventb.core.guard name="_Po4L0WbSEeWEJdelIsYeNA" org.eventb.core.label="grd11" org.eventb.core.predicate="entity ∈ changedEntities"/>
<org.eventb.core.guard name="_Po4L0mbSEeWEJdelIsYeNA" org.eventb.core.label="grd12" org.eventb.core.predicate="∀e · e ∈ changedEntities ∧ e ≠ entity ⇒ EntityMP(e) = entity ∧ Direct(e) = FALSE"/>
<org.eventb.core.guard name="_Po4L02bSEeWEJdelIsYeNA" org.eventb.core.label="grd13" org.eventb.core.predicate="∀e · e ∈ Entities ∧ e ≠ entity ∧ EntityMP(e) = entity ∧ Direct(e) = FALSE ⇒ e ∈ changedEntities"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt4" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="remove_rights">
<org.eventb.core.parameter name="_9on4AmX4EeWfdb_Dle8qAw" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_9on4A2X4EeWfdb_Dle8qAw" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_9on4BGX4EeWfdb_Dle8qAw" org.eventb.core.identifier="entity"/>
<org.eventb.core.parameter name="_9on4BWX4EeWfdb_Dle8qAw" org.eventb.core.identifier="accessRights"/>
<org.eventb.core.parameter name="_9on4BmX4EeWfdb_Dle8qAw" org.eventb.core.identifier="rights"/>
<org.eventb.core.guard name="_9oofHGX4EeWfdb_Dle8qAw" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_9oofHWX4EeWfdb_Dle8qAw" org.eventb.core.label="grd2" org.eventb.core.predicate="entity ∈ Entities"/>
<org.eventb.core.guard name="_mt5asGaSEeWEJdelIsYeNA" org.eventb.core.label="grd3" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.action name="_Po4L1GbSEeWEJdelIsYeNA" org.eventb.core.assignment="RoleRights(role) ≔ RoleRights(role) ∖ rights" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_Po4L2mbSEeWEJdelIsYeNA" org.eventb.core.label="grd4" org.eventb.core.predicate="accessRights ⊆ AccessRights"/>
<org.eventb.core.guard name="_Po4L22bSEeWEJdelIsYeNA" org.eventb.core.label="grd5" org.eventb.core.predicate="Own ∉ accessRights"/>
<org.eventb.core.guard name="_Po4L3GbSEeWEJdelIsYeNA" org.eventb.core.label="grd6" org.eventb.core.predicate="role ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po4L3WbSEeWEJdelIsYeNA" org.eventb.core.label="grd7" org.eventb.core.predicate="∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ entity ↦ Own ∈ RoleRights(r)"/>
<org.eventb.core.guard name="_Po4y4GbSEeWEJdelIsYeNA" org.eventb.core.label="grd8" org.eventb.core.predicate="∃E, c · E ⊆ Containers ∧ Root ∉ E ∧ ((entity ∈ dom(EntityNames) ∧ c ∈ dom(EntityNames(entity)) ∧ Parent[E] ∪ {c} = E ∪ {Root}) ∨ (E = ∅ ∧ entity = Root))&#10;&#9;∧ (∀o · o ∈ E ∪ {entity} ∪ {Root} ⇒ (∃r · r ∈ Roles ∧ r ↦ ReadA ∈ SubjectAdmAccesses(subject) ∧ o ↦ Execute ∈ RoleRights(r)))"/>
<org.eventb.core.guard name="_Po4y4WbSEeWEJdelIsYeNA" org.eventb.core.label="grd9" org.eventb.core.predicate="Direct(entity) = TRUE"/>
<org.eventb.core.guard name="_Po4y4mbSEeWEJdelIsYeNA" org.eventb.core.label="grd10" org.eventb.core.predicate="rights ⊆ RoleRights(role)"/>
<org.eventb.core.guard name="_Po4y42bSEeWEJdelIsYeNA" org.eventb.core.label="grd11" org.eventb.core.predicate="∀e, ar · e ∈ Entities ∧ ar ∈ accessRights ∧ (e = entity ∨ (Direct(e) = FALSE ∧ EntityMP(e) = entity))&#10;&#9;⇒ e ↦ ar ∈ rights"/>
<org.eventb.core.guard name="_Po4y5GbSEeWEJdelIsYeNA" org.eventb.core.label="grd12" org.eventb.core.predicate="∀e, ar · e ↦ ar ∈ rights ⇒ ar ∈ accessRights ∧ (e = entity ∨ (Direct(e) = FALSE ∧ EntityMP(e) = entity))"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt3" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="grant_admin_rights">
<org.eventb.core.parameter name="_Po4L1WbSEeWEJdelIsYeNA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_Po4L1mbSEeWEJdelIsYeNA" org.eventb.core.identifier="admRole"/>
<org.eventb.core.parameter name="_Po4L12bSEeWEJdelIsYeNA" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_Po4L2GbSEeWEJdelIsYeNA" org.eventb.core.identifier="accessRights"/>
<org.eventb.core.parameter name="_Po4L2WbSEeWEJdelIsYeNA" org.eventb.core.identifier="admRights"/>
<org.eventb.core.guard name="_Po4y5WbSEeWEJdelIsYeNA" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_Po4y5mbSEeWEJdelIsYeNA" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_Po4y52bSEeWEJdelIsYeNA" org.eventb.core.label="grd3" org.eventb.core.predicate="admRole ∈ AdmRoles"/>
<org.eventb.core.action name="_Po4y6GbSEeWEJdelIsYeNA" org.eventb.core.assignment="RoleAdmRights(admRole) ≔ RoleAdmRights(admRole) ∪ admRights" org.eventb.core.label="act1"/>
<org.eventb.core.guard name="_Po4y8GbSEeWEJdelIsYeNA" org.eventb.core.label="grd4" org.eventb.core.predicate="accessRights ⊆ {Read, Write}"/>
<org.eventb.core.guard name="_Po4y8WbSEeWEJdelIsYeNA" org.eventb.core.label="grd5" org.eventb.core.predicate="admRole ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po5Z8GbSEeWEJdelIsYeNA" org.eventb.core.label="grd6" org.eventb.core.predicate="role ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po5Z8WbSEeWEJdelIsYeNA" org.eventb.core.label="grd7" org.eventb.core.predicate="role ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po5Z8mbSEeWEJdelIsYeNA" org.eventb.core.label="grd8" org.eventb.core.predicate="admRights ∈ Roles ↔ accessRights"/>
<org.eventb.core.guard name="_Po5Z82bSEeWEJdelIsYeNA" org.eventb.core.label="grd9" org.eventb.core.predicate="∀ar · ar ∈ accessRights ⇒ role ↦ ar ∈ admRights"/>
<org.eventb.core.guard name="_Po5Z9GbSEeWEJdelIsYeNA" org.eventb.core.label="grd10" org.eventb.core.predicate="Read ∉ accessRights ⇒ dom(admRights) = {role}"/>
<org.eventb.core.guard name="_Po5Z9WbSEeWEJdelIsYeNA" org.eventb.core.label="grd11" org.eventb.core.predicate="∀r, ar · r ∈ Roles ∧ r ≠ role ∧ ar ∈ AccessRights ∧ ar ≠ Read ⇒ r ↦ ar ∉ admRights"/>
<org.eventb.core.guard name="_Po5Z9mbSEeWEJdelIsYeNA" org.eventb.core.label="grd12" org.eventb.core.predicate="∀r, p · r ∈ Roles ∧ p ∈ RParents(r) ∧ p ↦ Read ∈ admRights ⇒ r ↦ Read ∈ admRights"/>
</org.eventb.core.event>
<org.eventb.core.event name="evt2" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="remove_admin_rights">
<org.eventb.core.parameter name="_Po4y6mbSEeWEJdelIsYeNA" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_Po4y62bSEeWEJdelIsYeNA" org.eventb.core.identifier="admRole"/>
<org.eventb.core.parameter name="_Po4y7GbSEeWEJdelIsYeNA" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_Po4y7WbSEeWEJdelIsYeNA" org.eventb.core.identifier="accessRights"/>
<org.eventb.core.parameter name="_Po4y7mbSEeWEJdelIsYeNA" org.eventb.core.identifier="admRights"/>
<org.eventb.core.parameter name="_Po4y72bSEeWEJdelIsYeNA" org.eventb.core.identifier="depth"/>
<org.eventb.core.guard name="_Po5Z92bSEeWEJdelIsYeNA" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_Po5Z-GbSEeWEJdelIsYeNA" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_Po5Z-WbSEeWEJdelIsYeNA" org.eventb.core.label="grd3" org.eventb.core.predicate="admRole ∈ AdmRoles"/>
<org.eventb.core.guard name="_Po5Z-mbSEeWEJdelIsYeNA" org.eventb.core.label="grd4" org.eventb.core.predicate="accessRights ⊆ {Read, Write}"/>
<org.eventb.core.guard name="_Po5Z-2bSEeWEJdelIsYeNA" org.eventb.core.label="grd5" org.eventb.core.predicate="admRole ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po5Z_GbSEeWEJdelIsYeNA" org.eventb.core.label="grd6" org.eventb.core.predicate="role ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po5Z_WbSEeWEJdelIsYeNA" org.eventb.core.label="grd7" org.eventb.core.predicate="role ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_Po5Z_mbSEeWEJdelIsYeNA" org.eventb.core.label="grd8" org.eventb.core.predicate="∀u · u ∈ UserAccs ∧ admRole = UserAdmRole(u) ⇒ role ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_wmmCcmd0EeWEJdelIsYeNG" org.eventb.core.label="grd9" org.eventb.core.predicate="∀u · u ∈ UserAccs ∧ admRole = UserAdmRole(u) ⇒ role ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_wmmCcmd0EeWEJdelIsYeNF" org.eventb.core.label="grd10" org.eventb.core.predicate="∀u · u ∈ UserAccs ∧ admRole = UserAdmRole(u) ⇒ role ≠ CommonRole"/>
<org.eventb.core.guard name="_Po6BAGbSEeWEJdelIsYeNA" org.eventb.core.label="grd11" org.eventb.core.predicate="admRights ⊆ RoleAdmRights(admRole)"/>
<org.eventb.core.guard name="_Po6BAWbSEeWEJdelIsYeNA" org.eventb.core.label="grd12" org.eventb.core.predicate="∀ar · ar ∈ accessRights ⇒ role ↦ ar ∈ admRights"/>
<org.eventb.core.guard name="_Po6BAmbSEeWEJdelIsYeNA" org.eventb.core.label="grd13" org.eventb.core.predicate="∀ar · ar ∉ accessRights ⇒ role ↦ ar ∉ admRights"/>
<org.eventb.core.guard name="_weAo0GdhEeWEJdelIsYeNA" org.eventb.core.label="grd14" org.eventb.core.predicate="Read ∉ accessRights ⇒ (∀r · r ∈ Roles ∧ r ≠ role ⇒ r ∉ dom(admRights))"/>
<org.eventb.core.guard name="_E6lIwGdkEeWEJdelIsYeNA" org.eventb.core.label="grd15" org.eventb.core.predicate="∀r, ar · r ∈ Roles ∧ r ≠ role ∧ ar ∈ AccessRights ∧ ar ≠ Read ⇒ r ↦ ar ∉ admRights"/>
<org.eventb.core.guard name="_E6lIwWdkEeWEJdelIsYeNA" org.eventb.core.label="grd16" org.eventb.core.predicate="∀r, p · r ∈ Roles ∧ p ∈ RParents(r) ∧ r ↦ Read ∈ admRights ⇒ p ↦ Read ∈ admRights"/>
<org.eventb.core.guard name="_wmmCcGd0EeWEJdelIsYeNA" org.eventb.core.label="grd17" org.eventb.core.predicate="depth ∈ ℕ → ℙ(dom(admRights))"/>
<org.eventb.core.guard name="_wmmCcWd0EeWEJdelIsYeNA" org.eventb.core.label="grd18" org.eventb.core.predicate="∀r · r ∈ dom(admRights) ⇒ (∃i · i ∈ ℕ ∧ r ∈ depth(i))"/>
<org.eventb.core.guard name="_wmmCcmd0EeWEJdelIsYeNA" org.eventb.core.label="grd19" org.eventb.core.predicate="depth(0) = {role}"/>
<org.eventb.core.guard name="_wmmCc2d0EeWEJdelIsYeNA" org.eventb.core.label="grd20" org.eventb.core.predicate="∀i·i∈ℕ ⇒ (∀r·r∈depth(i+1) ⇒ (∃p·p∈depth(i) ∧ p∈RParents(r)))"/>
<org.eventb.core.guard name="_KFld8Gd4EeWEJdelIsYeNA" org.eventb.core.label="grd21" org.eventb.core.predicate="∀i·i∈ℕ ∧ (∀r·r∈depth(i) ⇒ (∀u·u∈UserAccs ∧ admRole=UserAdmRole(u) ⇒ r≠UserAdmRole(u) ∧ r≠UserOrdRole(u) ∧ r≠CommonRole))&#10;&#9;⇒ (∀r·r∈depth(i+1) ⇒ (∀u·u∈UserAccs ∧ admRole=UserAdmRole(u) ⇒ r≠UserAdmRole(u) ∧ r≠UserOrdRole(u) ∧ r≠CommonRole))" org.eventb.core.theorem="true"/>
<org.eventb.core.guard name="_KFld8Wd4EeWEJdelIsYeNA" org.eventb.core.label="grd22" org.eventb.core.predicate="∀i·i∈ℕ ⇒ (∀r·r∈depth(i) ⇒ (∀u·u∈UserAccs ∧ admRole=UserAdmRole(u) ⇒ r≠UserAdmRole(u) ∧ r≠UserOrdRole(u) ∧ r≠CommonRole))" org.eventb.core.theorem="true"/>
<org.eventb.core.action name="_Po6BA2bSEeWEJdelIsYeNA" org.eventb.core.assignment="RoleAdmRights(admRole) ≔ RoleAdmRights(admRole) ∖ admRights" org.eventb.core.label="act1"/>
</org.eventb.core.event>
<org.eventb.core.event name="_ImxxEGKrEeWR3tX1_PqofQ" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.label="delete_role">
<org.eventb.core.parameter name="_dU4-5GKrEeWR3tX1_PqofQ" org.eventb.core.identifier="subject"/>
<org.eventb.core.parameter name="_dU4-5WKrEeWR3tX1_PqofQ" org.eventb.core.identifier="role"/>
<org.eventb.core.parameter name="_R3DNIWKsEeWR3tX1_PqofQ" org.eventb.core.identifier="parent"/>
<org.eventb.core.guard name="_diFbfmKtEeWR3tX1_PqofQ" org.eventb.core.label="grd1" org.eventb.core.predicate="subject ∈ Subjects"/>
<org.eventb.core.guard name="_R3D0OWKsEeWR3tX1_PqofQ" org.eventb.core.label="grd2" org.eventb.core.predicate="role ∈ Roles"/>
<org.eventb.core.guard name="_R3D0OmKsEeWR3tX1_PqofQ" org.eventb.core.label="grd3" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserAdmRole(u)"/>
<org.eventb.core.guard name="_vmAT4WKtEeWR3tX1_PqofT" org.eventb.core.label="grd4" org.eventb.core.predicate="∀u · u ∈ UserAccs ⇒ role ≠ UserOrdRole(u)"/>
<org.eventb.core.guard name="_vl_FxmKtEeWR3tX1_PqofQ" org.eventb.core.label="grd5" org.eventb.core.predicate="role ≠ CommonRole"/>
<org.eventb.core.guard name="_vl_Fx2KtEeWR3tX1_PqofQ" org.eventb.core.label="grd6" org.eventb.core.predicate="role ∉ SpecialAdmRoles"/>
<org.eventb.core.guard name="_vl_FyGKtEeWR3tX1_PqofQ" org.eventb.core.label="grd7" org.eventb.core.predicate="parent ∈ Roles"/>
<org.eventb.core.guard name="_vl_FyWKtEeWR3tX1_PqofQ" org.eventb.core.label="grd8" org.eventb.core.predicate="parent ∈ RParents(role)"/>
<org.eventb.core.guard name="_vl_FymKtEeWR3tX1_PqofQ" org.eventb.core.label="grd9" org.eventb.core.predicate="∀r · r ∈ Roles ⇒ role ∉ RParents(r)"/>
<org.eventb.core.action name="_Po1IgGbSEeWEJdelIsYeNA" org.eventb.core.assignment="CurrUnion ≔ CurrUnion ∖ {role}" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_Po1IgWbSEeWEJdelIsYeNA" org.eventb.core.assignment="Roles ≔ Roles ∖ {role}" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_ImyYLGKrEeWR3tX1_PqofQ" org.eventb.core.assignment="OrdRoles ≔ OrdRoles ∖ {role}" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_dU4X1mKrEeWR3tX1_PqofQ" org.eventb.core.assignment="AdmRoles ≔ AdmRoles ∖ {role}" org.eventb.core.label="act4"/>
<org.eventb.core.action name="_dU4X3WKrEeWR3tX1_PqofQ" org.eventb.core.assignment="RoleAdmRights ≔ roleAdmRights" org.eventb.core.label="act5"/>
<org.eventb.core.action name="_dU4-4WKrEeWR3tX1_PqofQ" org.eventb.core.assignment="RParents ≔ {role} ⩤ RParents" org.eventb.core.label="act6"/>
<org.eventb.core.action name="_dU4-6mKrEeWR3tX1_PqofQ" org.eventb.core.assignment="RoleRights ≔ {role} ⩤ RoleRights" org.eventb.core.label="act7"/>
<org.eventb.core.action name="_R3EbRmKsEeWR3tX1_PqofQ" org.eventb.core.assignment="RoleName ≔ {role} ⩤ RoleName" org.eventb.core.label="act8"/>
<org.eventb.core.action name="_diFbgWKtEeWR3tX1_PqofQ" org.eventb.core.assignment="SubjectAdmAccesses ≔ subjectAdmAccesses" org.eventb.core.label="act9"/>
<org.eventb.core.action name="_vmAT4WKtEeWR3tX1_PqofQ" org.eventb.core.assignment="SubjectOwner ≔ SubjectOwner ⩥ {role}" org.eventb.core.label="act10"/>
<org.eventb.core.action name="_9oofHmX4EeWfdb_Dle8qAw" org.eventb.core.assignment="Shared ≔ {role} ⩤ Shared" org.eventb.core.label="act11"/>
<org.eventb.core.guard name="_vmAT4WKtEeWR3tX1_PqofR" org.eventb.core.label="grd10" org.eventb.core.predicate="∀r · r ∈ Roles ∧ r ≠ parent ⇒ r ∉ RParents(role)"/>
<org.eventb.core.guard name="_vl_Fy2KtEeWR3tX1_PqofQ" org.eventb.core.label="grd11" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_vl_FzGKtEeWR3tX1_PqofQ" org.eventb.core.label="grd12" org.eventb.core.predicate="parent ∈ OrdRoles ⇒ RolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_vl_FzWKtEeWR3tX1_PqofQ" org.eventb.core.label="grd13" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ ReadA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_vl_FzmKtEeWR3tX1_PqofQ" org.eventb.core.label="grd14" org.eventb.core.predicate="parent ∈ AdmRoles ⇒ ARolesAR ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.guard name="_vl_Fz2KtEeWR3tX1_PqofQ" org.eventb.core.label="grd15" org.eventb.core.predicate="parent ↦ WriteA ∈ SubjectAdmAccesses(subject)"/>
<org.eventb.core.action name="_vmAT4WKtEeWR3tX1_PqofS" org.eventb.core.assignment="Direct ≔ {role} ⩤ Direct" org.eventb.core.label="act12"/>
<org.eventb.core.parameter name="_vmAT4WKtEeWR3tX1_PqofU" org.eventb.core.identifier="roleAdmRights"/>
<org.eventb.core.parameter name="_vmAT4WKtEeWR3tX1_PqofV" org.eventb.core.identifier="subjectAdmAccesses"/>
<org.eventb.core.guard name="_vmAT4WKtEeWR3tX1_PqofW" org.eventb.core.label="grd16" org.eventb.core.predicate="roleAdmRights ∈ AdmRoles ∖ {role} → (Roles ∖ {role} ↔ AccessRights)"/>
<org.eventb.core.guard name="_vmAT4WKtEeWR3tX1_PqofX" org.eventb.core.label="grd17" org.eventb.core.predicate="∀r · r ∈ AdmRoles ∧ r ≠ role ⇒ roleAdmRights(r) = {role} ⩤ RoleAdmRights(r)"/>
<org.eventb.core.guard name="_vmAT4WKtEeWR3tX1_PqofY" org.eventb.core.label="grd18" org.eventb.core.predicate="subjectAdmAccesses ∈ Subjects → (Roles ∖ {role} ↔ Accesses)"/>
<org.eventb.core.guard name="_vmAT4WKtEeWR3tX1_PqofZ" org.eventb.core.label="grd19" org.eventb.core.predicate="∀s · s ∈ Subjects ⇒ subjectAdmAccesses(s) = {role} ⩤ SubjectAdmAccesses(s)"/>
</org.eventb.core.event>
</org.eventb.core.machineFile>
